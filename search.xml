<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2021ä¸Šæµ·ICPC--H.Life is a Game--Kruskalé‡æ„æ ‘--é“œç‰Œæ‹¦è·¯è™</title>
    <url>/2021/11/30/2021%E4%B8%8A%E6%B5%B7ICPC--H.Life%20is%20a%20Game--Kruskal%E9%87%8D%E6%9E%84%E6%A0%91--%E9%93%9C%E7%89%8C%E6%8B%A6%E8%B7%AF%E8%99%8E/</url>
    <content><![CDATA[<p>å·®ä¸å¤šä¸¤ä¸ªå°æ—¶çš„æ—¶å€™è¿‡äº†4é¢˜ï¼Œåœ¨é“œå°¾ï¼Œçœ‹äº†ä¸€ä¸‹æ¦œå•ï¼Œå»æ‰æ‰“æ˜Ÿè¿˜æœ‰30åå·¦å³å¯ä»¥æ‰ï¼Œèµ·åˆæ‰çš„å¾ˆæ…¢ï¼Œè‡ªä»¥ä¸ºè¿˜æ˜¯å¾ˆæœ‰å¸Œæœ›çš„ï¼Œç„¶åçœ‹ç€Hé¢˜è¿‡å¾—è¶Šæ¥è¶Šå¤šï¼Œä½†æ˜¯ä¸‰ä¸ªæ²¡æœ‰ä¸æ¯«æ€è·¯ï¼Œåœ¨å°æ¦œå‰æ‰å‡ºäº†å¥–ç‰ŒåŒºã€‚æœ€åå¼€äº†Jï¼Œäº¤äº†274å‘éšæœºï¼Œèµ›åçœ‹äº†ä¸‹å¾—åˆ†ï¼Œæœ‰è¿‘10å‘å·²ç»è¿‡äº†80%äº†ï¼Œè¿˜æ˜¯è¢«å¤§æ•°æ®å¡æ‰äº†ã€‚å½’æ ¹ç»“åº•ï¼Œä¸é“œç‰Œå¤±ä¹‹äº¤è‡‚çš„ç½ªé­ç¥¸é¦–å°±æ˜¯Kruskalé‡æ„æ ‘ï¼Œå­¦äº†ä¸€ä¸‹è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œè¦æ˜¯èµ›æ—¶ç¿»ä¸€ç¿»æ‰“å°å‡ºæ¥çš„oiwikiçš„å›¾è®ºè¯´ä¸å®šèƒ½ç¿»åˆ°ã€‚</p>
<p>ä¸Šä¸Šåœºccpcå¨æµ·å› ä¸ºè¢«å¡å¸¸äº†ï¼Œå·®äº†ä¸¤å‘ç½šæ—¶ï¼Œä¹Ÿæ˜¯é“é¦–ã€‚ä»¥ä¸¤ä¸ªé“é¦–ç»“å°¾è¿˜æ˜¯æ„Ÿåˆ°é—æ†¾ï¼Œå¯„å¸Œæœ›äºæ˜å¹´æ˜†æ˜äº†ï¼Œå¯’å‡ä¸€å®šå¥½å¥½è®­ç»ƒã€‚</p>
<h1 id="Kruskalé‡æ„æ ‘"><a href="#Kruskalé‡æ„æ ‘" class="headerlink" title="Kruskalé‡æ„æ ‘"></a>Kruskalé‡æ„æ ‘</h1><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>Kruskal é‡æ„æ ‘æ˜¯å›¾çš„ä¸€ç§ç”Ÿæˆæ ‘ï¼Œä¸»è¦è§£å†³è·¯å¾„è¾¹æƒé™åˆ¶é—®é¢˜ã€‚Kruskal é‡æ„æ ‘æœ‰æŒ‰æ·±åº¦å•è°ƒçš„æ€§è´¨ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å°±å¯ä»¥è§£å†³è¾¹æƒçš„å–å€¼é™åˆ¶ã€‚</p>
<h3 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h3><p>é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªç®—æ³•å’Œæ±‚æœ€å°ç”Ÿæˆæ ‘çš„Kruskaléå¸¸ç±»ä¼¼ã€‚</p>
<ol>
<li>æŠŠæ‰€æœ‰è¾¹æŒ‰ç…§è¾¹æƒä»å°åˆ°å¤§æ’åº</li>
<li>æŒ‰é¡ºåºéå†æ¯ä¸€æ¡è¾¹ï¼ˆa,b,cï¼‰ï¼Œå¦‚æœaï¼Œbå·²ç»åœ¨ä¸€ä¸ªè”é€šå—å†…äº†ï¼Œåˆ™è·³è¿‡ï¼Œå¦åˆ™æˆ‘ä»¬æ„é€ ä¸€ä¸ªæ–°ç‚¹xï¼Œç”±å®ƒæ¥è¿æ¥è¿™ä¸¤ä¸ªç‚¹ï¼Œç„¶åxçš„ç‚¹æƒå°±æ˜¯cã€‚å¹¶ä¸”å°†å¹¶æŸ¥é›†çš„ç¥–å…ˆè®¾ä¸ºxï¼Œå³fa[a] = fa[b] = x;</li>
</ol>
<p><img src="https://i.loli.net/2021/11/30/B6jgQR8LEU7Yhet.png" alt="image.png"></p>
<h3 id="é‡æ„æ ‘çš„æ€§è´¨"><a href="#é‡æ„æ ‘çš„æ€§è´¨" class="headerlink" title="é‡æ„æ ‘çš„æ€§è´¨"></a>é‡æ„æ ‘çš„æ€§è´¨</h3><p>1.é‡æ„æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°æ˜¯2*n-1ï¼Œå› ä¸ºæ ‘çš„æ¯æ¡è¾¹æˆä¸ºä¸€ä¸ªæ–°å¢èŠ‚ç‚¹ã€‚<br>2.åŸæ¥çš„ç‚¹éƒ½æ˜¯å¶å­ç»“ç‚¹<br>3.è¿™æ˜¯ä¸€æ£µäºŒå‰æ ‘ï¼Œæœ€åå¢åŠ çš„ç‚¹æ˜¯æ ¹èŠ‚ç‚¹<br>4.æ–°å¢ç‚¹çš„ç‚¹æƒæŒ‰åŠ å…¥é¡ºåºæ˜¯éä¸¥æ ¼é€’å¢çš„<br>5.ä»ä¸€ä¸ªç‚¹xï¼ˆé€šå¸¸æ˜¯åŸå›¾çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯æ–°å›¾é‡Œçš„å¶å­ç»“ç‚¹ï¼‰å‡ºå‘ç»è¿‡çš„è¾¹è¾¹æƒ&lt;=wèƒ½åˆ°è¾¾çš„ç‚¹å°±æ˜¯ä»xå‡ºå‘æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¥–å…ˆèŠ‚ç‚¹edï¼Œedçš„ç‚¹æƒ&gt;wï¼Œåˆ™è¯¥ç‚¹çš„å­æ ‘çš„å¶å­èŠ‚ç‚¹å°±æ˜¯åŸæ¥å›¾ä¸­èƒ½åˆ°è¾¾çš„æ‰€æœ‰ç‚¹ã€‚</p>
<hr>
<p><a href="https://ac.nowcoder.com/acm/contest/24872/H">Life is a Game</a></p>
<h4 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™ä½ ä¸€å¼ å›¾å’Œæ‰€æœ‰ç‚¹çš„ç‚¹æƒï¼Œæ‰€æœ‰è¾¹çš„è¾¹æƒã€‚ç„¶åæœ‰1e5æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™ä½ ä¸€ä¸ªèµ·ç‚¹stå’Œä¸€ä¸ªé‡‘å¸æ•°valï¼Œæ¯èµ°åˆ°ä¸€ä¸ªç‚¹é‡‘å¸æ•°å¯ä»¥åŠ ä¸Šç‚¹æƒï¼Œä½†æ˜¯åªæœ‰é‡‘å¸æ•°å¤§äºç­‰äºè¾¹æƒæ‰èƒ½èµ°é‚£æ¡è¾¹ï¼Œé€šè¿‡ä¸€æ¡è¾¹ä¸ä¼šæ¶ˆè€—é‡‘å¸ï¼Œé—®æœ€åçš„é‡‘å¸æ•°æ˜¯å¤šå°‘ã€‚</p>
<h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>æœ€åä¸èƒ½èµ°çš„æ¡ä»¶å°±æ˜¯å½“å‰å·²èµ°è¿‡çš„ç‚¹çš„ç‚¹æƒå’ŒåŠ ä¸Šåˆå§‹çš„å€¼å°äºå‘¨å›´å¯èµ°è¾¹çš„æƒå€¼ï¼Œæ˜¯ä¸€ä¸ªè¾¹æƒé™åˆ¶çš„é—®é¢˜ï¼ˆæœ‰ç‚¹å¼ºè¡Œè§£é‡Šï¼‰ï¼Œç†æ‰€åº”å½“çš„æˆ‘ä»¬æƒ³åˆ°Kruskalé‡æ„æ ‘ï¼ˆå±å˜ï¼Œå­¦éƒ½æ²¡å­¦è¿‡ï¼‰ã€‚</p>
<p>æˆ‘ä»¬ç”»å‡ºæ ·ä¾‹çš„é‡æ„æ ‘<br><img src="https://pic.baixiongz.com/uploads/2021/11/30/24a4f27006dcc.jpeg" alt="1"></p>
<p>æ ¹æ®é¢˜æ„æˆ‘ä»¬çŸ¥é“åœæ­¢ç§»åŠ¨çš„æ¡ä»¶æ˜¯æ–°ç‚¹çš„ç‚¹æƒï¼ˆåŸæ¥çš„è¾¹æƒï¼‰å‡å»ç»è¿‡çš„æ‰€æœ‰ç‚¹çš„ç‚¹æƒå’Œï¼ˆä¹Ÿå°±æ˜¯ä»–çš„å­æ ‘æ‰€æœ‰ç‚¹æƒå’Œï¼‰ &gt; valã€‚å› ä¸ºè¾¹æƒåœ¨é€’å¢ï¼Œå­æ ‘ç‚¹æƒå’Œä¹Ÿåœ¨é€’å¢ï¼Œæ‰€ä»¥åœæ­¢çš„ç‚¹å¯èƒ½æœ‰å¾ˆå¤šä¸ªï¼Œä¸”ä¸æ˜¯è¿ç»­çš„ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°æœ€é è¿‘èµ·ç‚¹çš„ï¼Œä¹Ÿå°±æ˜¯æ·±åº¦æœ€æ·±çš„ã€‚</p>
<ul>
<li>æˆ‘ä»¬å¯ä»¥å¯¹æ–°å¢çš„ç‚¹ç»´æŠ¤ä¸€ä¸ªä»–å­æ ‘æ‰€æœ‰ç‚¹æƒå’Œ</li>
<li>ç„¶åç”¨ä¸¤ä¸ªè·³è¡¨ï¼Œä¸€ä¸ªæ˜¯preæ¥ç»´æŠ¤èŠ‚ç‚¹ç¼–å·ï¼Œä¸€ä¸ªvï¼ˆè¡¨ç¤ºè¾¹æƒå‡å»å­æ ‘æ‰€æœ‰ç‚¹æƒå’Œï¼‰æ¥ç»´æŠ¤æœ€å¤§å€¼ï¼Œç”¨æ¥å¿«é€Ÿæ‰¾åˆ°æœ€æ¥è¿‘èµ·ç‚¹çš„ç»ˆæ­¢ä½ç½®ã€‚</li>
</ul>
<h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IOS ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CN puts(<span class="meta-string">&quot;NO&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CY puts(<span class="meta-string">&quot;YES&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> a,b,c;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(Edge a, Edge b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.c &lt; b.c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fa[x] == x ? x : (fa[x]=<span class="built_in">find</span>(fa[x]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v[maxn][<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pre[maxn][<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M &gt;&gt; Q;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,<span class="number">2</span>*N) fa[i] = i;<span class="comment">//æœ€åç‚¹çš„ä¸ªæ•°æ˜¯2*N-1</span></span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; A[i];</span><br><span class="line">	vector&lt;Edge&gt; edge;</span><br><span class="line">	<span class="keyword">while</span>(M--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> u, v, w;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">		edge.<span class="built_in">pb</span>(&#123;u,v,w&#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">sort</span>(<span class="built_in">all</span>(edge),cmp);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> node = N + <span class="number">1</span>;<span class="comment">//æ–°å¢ç‚¹å¼€å§‹ç¼–å·</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> e : edge)&#123;</span><br><span class="line">		<span class="keyword">int</span> a = e.a, b = e.b, c = e.c;</span><br><span class="line">		<span class="keyword">int</span> ra = <span class="built_in">find</span>(a), rb = <span class="built_in">find</span>(b);</span><br><span class="line">		<span class="keyword">if</span>(ra != rb)&#123;</span><br><span class="line">			A[node] = A[ra] + A[rb];<span class="comment">//å­æ ‘çš„ç‚¹æƒå’Œï¼Œä¸åŒ…æ‹¬è‡ªå·±</span></span><br><span class="line">			pre[ra][<span class="number">0</span>] = pre[rb][<span class="number">0</span>] = node;<span class="comment">//ä¸Šé¢ä¸€ä¸ªèŠ‚ç‚¹çš„ç¼–å· </span></span><br><span class="line">			<span class="comment">//å¤„ç†è·³è¡¨</span></span><br><span class="line">			v[ra][<span class="number">0</span>] = c - A[ra];</span><br><span class="line">			v[rb][<span class="number">0</span>] = c - A[rb];</span><br><span class="line">			fa[ra] = fa[rb] = node++;<span class="comment">//åˆå¹¶å¹¶æŸ¥é›†</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//é¢„å¤„ç†</span></span><br><span class="line">	<span class="built_in">per</span>(i,node<span class="number">-1</span>,<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">1</span>,<span class="number">18</span>)&#123;</span><br><span class="line">			pre[i][j] = pre[pre[i][j<span class="number">-1</span>]][j<span class="number">-1</span>];</span><br><span class="line">			v[i][j] = <span class="built_in">max</span>(v[i][j<span class="number">-1</span>],v[pre[i][j<span class="number">-1</span>]][j<span class="number">-1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,Q)&#123;</span><br><span class="line">		<span class="keyword">int</span> st,val;</span><br><span class="line">		cin &gt;&gt; st &gt;&gt; val;</span><br><span class="line">		<span class="built_in">per</span>(j,<span class="number">18</span>,<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(pre[st][j]!=<span class="number">0</span> &amp;&amp; v[st][j]&lt;=val) st = pre[st][j];<span class="comment">//ç­‰äº0è¯´æ˜è·³åˆ°2*N-1ä¹‹å¤–äº†ï¼ˆä¸å­˜åœ¨çš„ç‚¹ï¼‰ï¼›æœ€å¤§å€¼å°äºç­‰äºvalè¯´æ˜ståˆ°pre[st][j]è·¯å¾„ä¸­é—´éƒ½æ˜¯æ»¡è¶³çš„ï¼Œæ‰€ä»¥ç»§ç»­å¾€æ ¹èŠ‚ç‚¹è·³</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//æœ€åstå°±æ˜¯ä¸èƒ½èµ°çš„é‚£ä¸ªç‚¹</span></span><br><span class="line">		cout &lt;&lt; val + A[st] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IOS</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å›¾è®º | icpc/ccpc</category>
      </categories>
  </entry>
  <entry>
    <title>Codeforces Round 753</title>
    <url>/2021/11/03/Codeforces%20Round%20753/</url>
    <content><![CDATA[<blockquote>
<p>ä¸Šåœºdiv2è¢«å¡åˆ°äº†1599ï¼Œæœ¬æ¥è¿™åœºä¸æ‰åˆ†å°±èƒ½ä¸Šè“ï¼Œå´è¢«Då¡äº†ä¸€ä¸ªå°æ—¶ï¼ŒE17åˆ†é’Ÿå°±1Aäº†ã€‚ä¸ºä»€ä¹ˆrank1096ä¹Ÿä¼šæ‰åˆ†ï¼Œdiv3å¤ªéš¾ä¸Šåˆ†äº†ã€‚-_-â€˜â€™</p>
</blockquote>
<h1 id="A-Linear-Keyboard"><a href="#A-Linear-Keyboard" class="headerlink" title="A. Linear Keyboard"></a>A. Linear Keyboard</h1><p>é¢˜æ„ï¼šå…ˆç»™ä½ ä¸€ä¸ªå­—å…¸ï¼Œå†ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚å­—ç¬¦ä¸²ä¸­ç›¸é‚»ä¸¤ä¸ªå­—æ¯åœ¨å­—å…¸ä¸­è·ç¦»çš„å’Œã€‚</p>
<p>æ€è·¯ï¼šç”¨mapç®€å•æ˜ å°„ä¸€ä¸‹å°±å¥½äº†</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Problem: A. Linear Keyboard</span></span><br><span class="line"><span class="comment">// Contest: Codeforces Round #753 (Div. 3)</span></span><br><span class="line"><span class="comment">// URL: https://codeforces.com/contest/1607/problem/A</span></span><br><span class="line"><span class="comment">// Memory Limit: 256 MB</span></span><br><span class="line"><span class="comment">// Time Limit: 1000 ms</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Powered by CP Editor (https://cpeditor.org)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	cin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		string s1,s;</span><br><span class="line">		cin &gt;&gt; s1 &gt;&gt; s;</span><br><span class="line">		N = <span class="built_in">sz</span>(s);</span><br><span class="line">		map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; pos;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="built_in">sz</span>(s1)<span class="number">-1</span>)&#123;</span><br><span class="line">			pos[s1[i]] = i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N<span class="number">-1</span>)&#123;</span><br><span class="line">			ans+=<span class="built_in">abs</span>(pos[s[i]]-pos[s[i<span class="number">-1</span>]]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">wtl</span>(ans);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></h2><h1 id="B-Odd-Grasshopper"><a href="#B-Odd-Grasshopper" class="headerlink" title="B. Odd Grasshopper"></a>B. Odd Grasshopper</h1><p>é¢˜æ„ï¼šç»™å®šä¸€ä¸ªåˆå§‹ä½ç½®xï¼Œéœ€è¦ç§»åŠ¨çš„æ­¥æ•°nï¼Œç¬¬iæ­¥çš„æ­¥é•¿ä¸ºiï¼Œæ±‚æœ€åæ‰€åœ¨çš„ä½ç½®ã€‚</p>
<p>æ€è·¯ï¼šæ‰‹å†™å‡ é¡¹å¯ä»¥å‘ç°ï¼ˆèµ·ç‚¹ä¸ºå¶æ•°ï¼‰å››æ­¥åçš„ä½ç½®çš„å˜åŒ–å€¼æ˜¯-1+2+3-4=0ï¼Œ-5+6+7-8=0â€¦æ‰€ä»¥æ¯å››æ­¥éƒ½ä¼šå›åˆ°èµ·ç‚¹ï¼Œåªéœ€æŠŠnå¯¹4å–æ¨¡å†æ¨¡æ‹Ÿå‰©ä¸‹çš„å‡ æ­¥ï¼ˆå°äº4æ­¥ï¼‰ã€‚</p>
<p>èµ›æ—¶é€†å¤©å†™äº†å¥‡å¶çš„åˆ†ç±»è®¨è®ºï¼Œäººå‚»æ‰äº†ğŸ˜</p>
<h2 id="æ­£è§£"><a href="#æ­£è§£" class="headerlink" title="æ­£è§£"></a>æ­£è§£</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Problem: B. Odd Grasshopper</span></span><br><span class="line"><span class="comment">// Contest: Codeforces Round #753 (Div. 3)</span></span><br><span class="line"><span class="comment">// URL: https://codeforces.com/contest/1607/problem/B</span></span><br><span class="line"><span class="comment">// Memory Limit: 256 MB</span></span><br><span class="line"><span class="comment">// Time Limit: 1000 ms</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Powered by CP Editor (https://cpeditor.org)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	cin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		<span class="keyword">int</span> now,ans;</span><br><span class="line">		cin &gt;&gt; now &gt;&gt; N;</span><br><span class="line">		<span class="built_in">rep</span>(i,N/<span class="number">4</span>*<span class="number">4</span>+<span class="number">1</span>,N)&#123;</span><br><span class="line">			<span class="keyword">if</span>(now&amp;<span class="number">1</span>) now+=i;</span><br><span class="line">			<span class="keyword">else</span> now-=i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">wtl</span>(now);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h2 id="åˆ†ç±»è®¨è®º"><a href="#åˆ†ç±»è®¨è®º" class="headerlink" title="åˆ†ç±»è®¨è®º"></a>åˆ†ç±»è®¨è®º</h2><h2 id="-1"><a href="#-1" class="headerlink" title=""></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Problem: B. Odd Grasshopper</span></span><br><span class="line"><span class="comment">// Contest: Codeforces Round #753 (Div. 3)</span></span><br><span class="line"><span class="comment">// URL: https://codeforces.com/contest/1607/problem/B</span></span><br><span class="line"><span class="comment">// Memory Limit: 256 MB</span></span><br><span class="line"><span class="comment">// Time Limit: 1000 ms</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Powered by CP Editor (https://cpeditor.org)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	cin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		<span class="keyword">int</span> now,ans;</span><br><span class="line">		cin &gt;&gt; now &gt;&gt; N;</span><br><span class="line">		<span class="keyword">if</span>(now&amp;<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">int</span> ci = N/<span class="number">2</span>;</span><br><span class="line">			<span class="keyword">if</span>(ci&amp;<span class="number">1</span>)&#123;</span><br><span class="line">				 <span class="keyword">if</span>((N&amp;<span class="number">1</span>)==<span class="number">0</span>) ans = now<span class="number">-1</span>;</span><br><span class="line">				 <span class="keyword">else</span> ans = now<span class="number">-1</span>-N;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>((N&amp;<span class="number">1</span>)==<span class="number">0</span>) ans = now;</span><br><span class="line">				<span class="keyword">else</span> ans = now+N;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">int</span> ci = N/<span class="number">2</span>;</span><br><span class="line">			<span class="keyword">if</span>(ci&amp;<span class="number">1</span>)&#123;</span><br><span class="line">				 <span class="keyword">if</span>((N&amp;<span class="number">1</span>)==<span class="number">0</span>) ans = now+<span class="number">1</span>;</span><br><span class="line">				 <span class="keyword">else</span> ans = now+<span class="number">1</span>+N;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>((N&amp;<span class="number">1</span>)==<span class="number">0</span>) ans = now;</span><br><span class="line">				<span class="keyword">else</span> ans = now-N;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">wtl</span>(ans);</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></h2><h1 id="C-Minimum-Extraction"><a href="#C-Minimum-Extraction" class="headerlink" title="C. Minimum Extraction"></a>C. Minimum Extraction</h1><p>é¢˜æ„ï¼šç»™ä½ ä¸€ä¸ªæ•°ç»„ï¼Œæ¯æ¬¡é€‰æ‹©å…¶ä¸­æœ€å°çš„ä¸€ä¸ªxï¼Œè®©å‰©ä½™å…ƒç´ å‡å»xï¼Œå†æŠŠxä»æ•°ç»„ä¸­åˆ é™¤ï¼ŒçŸ¥é“æ•°ç»„ä¸ºç©ºã€‚é—®æ¯æ¬¡åˆ é™¤å‰æ•°ç»„ä¸­æœ€å°å€¼çš„æœ€å¤§å€¼æ˜¯å¤šå°‘ã€‚</p>
<p>æ€è·¯ï¼šé¦–å…ˆå‘ç°æ‰€æœ‰æ•°å‡å»ä¸€ä¸ªç›¸åŒçš„æ•°å¹¶ä¸ä¼šæ”¹å˜ä»–ä»¬çš„ç›¸å¯¹å¤§å°ï¼Œæ‰€ä»¥åˆ å»çš„é¡ºåºå°±æ˜¯æŒ‰ç…§åŸæ•°ç»„ä»å°åˆ°å¤§ã€‚å…ˆä»å°åˆ°å¤§æ’åºï¼Œé‚£ä¹ˆç¬¬iæ¬¡åˆ é™¤å‰çš„æœ€å°å€¼å°±æ˜¯a[i]-a[i-1] (a[0]æ˜¯0)ï¼Œç„¶å$O(n)$éå†å–max</p>
<h2 id="-2"><a href="#-2" class="headerlink" title=""></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Problem: C. Minimum Extraction</span></span><br><span class="line"><span class="comment">// Contest: Codeforces Round #753 (Div. 3)</span></span><br><span class="line"><span class="comment">// URL: https://codeforces.com/contest/1607/problem/C</span></span><br><span class="line"><span class="comment">// Memory Limit: 256 MB</span></span><br><span class="line"><span class="comment">// Time Limit: 1000 ms</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Powered by CP Editor (https://cpeditor.org)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	cin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		cin &gt;&gt; N;</span><br><span class="line">		<span class="keyword">int</span> mmax = -INF_L;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			cin &gt;&gt; A[i];		</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(A+<span class="number">1</span>,A+<span class="number">1</span>+N);</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			mmax = <span class="built_in">max</span>(mmax,A[i]-A[i<span class="number">-1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">wtl</span>(mmax);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></h2><h1 id="D-Blue-Red-Permutation"><a href="#D-Blue-Red-Permutation" class="headerlink" title="D. Blue-Red Permutation"></a>D. Blue-Red Permutation</h1><p>é¢˜æ„ï¼šæœ‰nä¸ªç‚¹çš„åæ ‡ï¼Œé¢œè‰²ï¼›çº¢è‰²å¯ä»¥å¾€å³ç§»ï¼Œè“è‰²å¯ä»¥å¾€å·¦ç§»ã€‚é—®èƒ½å¦å°†æ‰€æœ‰ç‚¹ç§»åˆ°1-nï¼Œæ¯ä¸ªä½ç½®ä¸€ä¸ªç‚¹ã€‚</p>
<p>æ€è·¯ï¼šé¦–å…ˆæœ‰ä¸€ç§ä¸æ»¡è¶³çš„æƒ…å†µæ˜¯<1çš„ä½ç½®æœ‰è“è‰²çš„ç‚¹æˆ–è€…>nçš„ä½ç½®æœ‰çº¢è‰²çš„ç‚¹é‚£ä¹ˆè¿™äº›ç‚¹æ— æ³•ç§»åŠ¨åˆ°åŒºé—´[1,n]ï¼Œä¸€å®šæ˜¯NOã€‚<br>è‹¥æœ‰æ»¡è¶³æ¡ä»¶å¾—æƒ…å†µå¦‚RBRBRé‚£ä¹ˆä¸€å®šå¯ä»¥å˜æˆBBRRRï¼Œä¹Ÿå°±æ˜¯è“è‰²éƒ½åœ¨å·¦è¾¹ï¼Œçº¢è‰²éƒ½åœ¨å³è¾¹ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å°†çº¢è“ä½ç½®åˆ†åˆ«æ’åºï¼Œä»å°åˆ°å¤§æšä¸¾è“è‰²ï¼Œå¦‚æœåæ ‡å°äºå·²ç»æšä¸¾å¾—ç‚¹å°±æ˜¯NOï¼Œç›¸å½“äºå·¦è¾¹æ”¾ä¸ä¸‹è¿™ä¹ˆå¤šè“è‰²ï¼›çº¢è‰²åŒç†ã€‚</p>
<h2 id="-3"><a href="#-3" class="headerlink" title=""></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Problem: D. Blue-Red Permutation</span></span><br><span class="line"><span class="comment">// Contest: Codeforces Round #753 (Div. 3)</span></span><br><span class="line"><span class="comment">// URL: https://codeforces.com/contest/1607/problem/D</span></span><br><span class="line"><span class="comment">// Memory Limit: 256 MB</span></span><br><span class="line"><span class="comment">// Time Limit: 1000 ms</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Powered by CP Editor (https://cpeditor.org)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	cin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		cin &gt;&gt; N;</span><br><span class="line">		string s;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; A[i];</span><br><span class="line">		cin &gt;&gt; s;</span><br><span class="line">		s = <span class="string">&#x27; &#x27;</span>+s;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			<span class="keyword">if</span>(A[i]&lt;<span class="number">1</span>&amp;&amp;s[i]==<span class="string">&#x27;B&#x27;</span>) f = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(A[i]&gt;N&amp;&amp;s[i]==<span class="string">&#x27;R&#x27;</span>) f = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(f==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> pos = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			<span class="keyword">if</span>(A[i]&lt;<span class="number">1</span>||A[i]&gt;N) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(s[i]==<span class="string">&#x27;B&#x27;</span>)&#123;</span><br><span class="line">				B.<span class="built_in">pb</span>(A[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				R.<span class="built_in">pb</span>(A[i]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(<span class="built_in">all</span>(B));</span><br><span class="line">		<span class="built_in">sort</span>(<span class="built_in">all</span>(R));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="built_in">sz</span>(B)<span class="number">-1</span>)&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(B[i]&lt;(i+<span class="number">1</span>)) &#123;</span><br><span class="line">				f = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">per</span>(i,<span class="built_in">sz</span>(R)<span class="number">-1</span>,<span class="number">0</span>)&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>((N-R[i]+<span class="number">1</span>)&lt;(<span class="built_in">sz</span>(R)-i)) &#123;</span><br><span class="line">				f = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(f==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></h2><h1 id="E-Robot-on-the-Board-1"><a href="#E-Robot-on-the-Board-1" class="headerlink" title="E. Robot on the Board 1"></a>E. Robot on the Board 1</h1><p>é¢˜æ„ï¼šæœ‰ä¸€ä¸²æŒ‡ä»¤så’Œä¸€ä¸ªn*mçš„çŸ©å½¢ï¼Œé—®å°†æœºå™¨äººæ”¾åœ¨å“ªä¸ªä½ç½®ï¼Œèƒ½å¤Ÿæ‰§è¡Œå°½å¯èƒ½å¤šçš„æ­¥æ•°ã€‚ï¼ˆèµ°å‡ºçŸ©å½¢å³ç»“æŸæˆ–æŒ‡ä»¤å…¨æ‰§è¡Œå®Œï¼‰</p>
<p>æ€è·¯ï¼šä¸ç®¡ä»é‚£ä¸ªç‚¹å¼€å§‹ï¼Œæ‰§è¡ŒæŒ‡ä»¤çš„è·¯å¾„äº‹å›ºå®šçš„ï¼Œåªè¦æ•´ä¸ªè·¯å¾„åœ¨çŸ©å½¢å†…å°±å¯ä»¥ã€‚ä¸€ä¸ªè·¯å¾„èƒ½åœ¨çŸ©å½¢å†…ï¼Œæœ€å³è¾¹-æœ€å·¦è¾¹<m && æœ€ä¸‹è¾¹-æœ€ä¸Šè¾¹<nã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦éå†æŒ‡ä»¤ç›´åˆ°ä¸ç¬¦åˆæ¡ä»¶breakã€‚ç„¶åæŠŠæ­¤æ—¶è·¯å¾„å¤–åˆ‡çŸ©å½¢çš„å·¦ä¸Šç‚¹æ”¾åœ¨ï¼ˆ1ï¼Œ1ï¼‰ï¼Œå¯ä»¥æ±‚å‡ºè·¯å¾„èµ·ç‚¹ï¼ˆ0ï¼Œ0ï¼‰åœ¨åŸåæ ‡ç³»çš„åæ ‡ã€‚
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Problem: E. Robot on the Board 1</span></span><br><span class="line"><span class="comment">// Contest: Codeforces Round #753 (Div. 3)</span></span><br><span class="line"><span class="comment">// URL: https://codeforces.com/contest/1607/problem/E</span></span><br><span class="line"><span class="comment">// Memory Limit: 256 MB</span></span><br><span class="line"><span class="comment">// Time Limit: 2000 ms</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Powered by CP Editor (https://cpeditor.org)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	cin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">		string s;</span><br><span class="line">		cin &gt;&gt; s;</span><br><span class="line">		<span class="keyword">int</span> n = <span class="built_in">sz</span>(s);</span><br><span class="line">		<span class="keyword">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> L = <span class="number">0</span>,R=<span class="number">0</span>,U=<span class="number">0</span>,D=<span class="number">0</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[i]==<span class="string">&#x27;L&#x27;</span>) x--;</span><br><span class="line">			<span class="keyword">if</span>(s[i]==<span class="string">&#x27;R&#x27;</span>) x++;</span><br><span class="line">			<span class="keyword">if</span>(s[i]==<span class="string">&#x27;U&#x27;</span>) y--;</span><br><span class="line">			<span class="keyword">if</span>(s[i]==<span class="string">&#x27;D&#x27;</span>) y++;</span><br><span class="line">			<span class="keyword">int</span> tl = L,tr = R, tu = U, td = D;</span><br><span class="line">			L = <span class="built_in">min</span>(L,x);</span><br><span class="line">			R = <span class="built_in">max</span>(R,x);</span><br><span class="line">			D = <span class="built_in">max</span>(D,y);</span><br><span class="line">			U = <span class="built_in">min</span>(U,y);</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">abs</span>(R-L)&gt;=M||<span class="built_in">abs</span>(U-D)&gt;=N)&#123;</span><br><span class="line">				L = tl;</span><br><span class="line">				R = tr;</span><br><span class="line">				U = tu;</span><br><span class="line">				D = td;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		U--;</span><br><span class="line">		L--;</span><br><span class="line">		<span class="built_in">wtb</span>(-U);</span><br><span class="line">		<span class="built_in">wtl</span>(-L);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>codeforces</category>
      </categories>
  </entry>
  <entry>
    <title>Codeforces Round 754 (Div. 2)</title>
    <url>/2021/11/13/Codeforces%20Round%20754%20(Div.%202)/</url>
    <content><![CDATA[<blockquote>
<p>èµ›æ—¶åªåšå‡ºäº†ABCï¼ŒDæƒ³çš„å¾ˆæ¥è¿‘äº†ï¼Œä½†æ˜¯åé¢æŸ“è‰²çš„éƒ¨åˆ†æ²¡æå‡ºæ¥<br>Anywayï¼Œæˆ‘ä¸Šè“äº†ï¼ï¼ï¼ğŸ˜„æ— æ•°æ¬¡æ¥è¿‘1600ï¼Œç„¶åæ™‹çº§èµ›å°±åƒè¢«é™æ™ºäº†ä¸€æ ·æ‰å¤§åˆ†ã€‚<br><img src="/upload/2021/11/WechatIMG13-5c1549fe9b4e416590f62978dc9f9db4.png" alt="WechatIMG13.png"></p>
</blockquote>
<hr>
<h3 id="A-A-M-Deviation"><a href="#A-A-M-Deviation" class="headerlink" title="A. A.M. Deviation"></a>A. A.M. Deviation</h3><p><strong>é¢˜æ„ï¼š</strong> ç»™ä½ aï¼Œbï¼Œcä¸‰ä¸ªæ•°ï¼Œæ±‚$<code>|a+c-2 Ã— c|</code>$ çš„æœ€å°å€¼ã€‚ç„¶åä½ å¯ä»¥</p>
<ul>
<li>æŠŠaæˆ–cåŠ 1ï¼Œç„¶åbå‡1</li>
<li>æŠŠaæˆ–cå‡1ï¼Œç„¶åbåŠ 1<br>å¯ä»¥æ“ä½œæ— é™æ¬¡</li>
</ul>
<p><strong>é¢˜è§£ï¼š</strong> æ¯æ¬¡æ“ä½œå¯¹ç­”æ¡ˆçš„å½±å“æ˜¯3ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å¯¹($<code>a+c-2 Ã— c</code>$)%3,é‚£ä¹ˆç­”æ¡ˆå¯èƒ½æ˜¯-2ï¼Œ-1ï¼Œ0ï¼Œ1ï¼Œ2ï¼›å½“ç­‰äº-2æ—¶å¯ä»¥åŠ 3å˜æˆ1ï¼Œå½“ç­‰äº2æ—¶å¯ä»¥å‡3ç­‰äº-1.æ‰€ä»¥ç­”æ¡ˆåªæœ‰0æˆ–1ï¼Œä¸”åªæœ‰åŸæ¥ç­‰äº0çš„æ˜¯0ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a, b, c;</span><br><span class="line">	cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">	<span class="keyword">int</span> dif = (a+c<span class="number">-2</span>*b)%<span class="number">3</span>;</span><br><span class="line">	<span class="built_in">wtl</span>(dif?<span class="number">1</span>:<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="B-Reverse-Sort"><a href="#B-Reverse-Sort" class="headerlink" title="B. Reverse Sort"></a>B. Reverse Sort</h3><p><strong>é¢˜æ„ï¼š</strong> ç»™ä½ ä¸€ä¸ª01ä¸²ï¼Œå°†å®ƒå˜æˆéé™åºã€‚</p>
<ul>
<li>æ¯æ¬¡æ“ä½œé€‰æ‹©ä¸€ä¸ªéå¢åºçš„éè¿ç»­å­ä¸²ï¼Œä½¿å…¶å˜æˆéé™åºã€‚<br>é—®æœ€å°‘éœ€è¦å‡ æ¬¡æ“ä½œ</li>
</ul>
<p><strong>é¢˜è§£ï¼š</strong> é¦–å…ˆæˆ‘ä»¬å¯ä»¥è‚¯å®šçš„æ˜¯æœ€åçš„å­—ç¬¦ä¸²ä¸€å®šæ˜¯å‰é¢è¿ç»­0ï¼Œåé¢è¿ç»­1ï¼ˆ0000001111ï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠåé¢åº”è¯¥æ˜¯1çš„0å’Œå‰é¢åº”è¯¥æ˜¯0çš„1æ’åºå³å¯ã€‚ä¸”è¿™æ ·é€‰æ‹©çš„å­ä¸²ä¿è¯æ˜¯éå¢åºçš„ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line"><span class="keyword">int</span> sum1;</span><br><span class="line">string s;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	cin &gt;&gt; s;</span><br><span class="line">	sum1 = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,N<span class="number">-1</span>)&#123;</span><br><span class="line">		sum1+=(s[i]==<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ordered = <span class="number">1</span>,cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,N-sum1<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i]==<span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">			ordered = <span class="number">0</span>;</span><br><span class="line">			cnt++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(ordered)&#123;</span><br><span class="line">		<span class="built_in">wtl</span>(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">wtl</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">wtb</span>(cnt*<span class="number">2</span>);</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,N-sum1<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i]==<span class="string">&#x27;1&#x27;</span>) <span class="built_in">wtb</span>(i+<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">rep</span>(i,N-sum1,N<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i]==<span class="string">&#x27;0&#x27;</span>) <span class="built_in">wtb</span>(i+<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="C-Dominant-Character"><a href="#C-Dominant-Character" class="headerlink" title="C. Dominant Character"></a>C. Dominant Character</h3><p><strong>é¢˜æ„ï¼š</strong> ç»™ä½ ä¸€ä¸ªåªåŒ…å«â€˜aâ€™ï¼Œâ€˜bâ€™ï¼Œâ€˜câ€™çš„å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°é•¿åº¦&gt;1çš„æœ€çŸ­çš„è¿ç»­å­ä¸²æ»¡è¶³ï¼Œaçš„ä¸ªæ•°ä¸¥æ ¼å¤§äºbï¼Œcçš„ä¸ªæ•°ã€‚æ‰¾ä¸åˆ°è¾“å‡º-1.</p>
<p><strong>é¢˜è§£ï¼š</strong> ç­”æ¡ˆå…¶å®åªæœ‰-1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ7è¿™äº”ç§ï¼Œæšä¸¾é•¿åº¦å†æš´åŠ›checkå°±å¥½äº†ã€‚</p>
<ul>
<li>å¦‚æœå­˜åœ¨aaï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯2</li>
<li>å½“aâ€¦aä¸­é—´æœ‰xä¸ªbï¼Œyä¸ªcæ—¶ï¼Œå½“yå’Œxå¤§äº1æ—¶å°±ä¸æˆç«‹äº†ï¼Œæ‰€ä»¥åªèƒ½æ˜¯abaæˆ–acaï¼Œç­”æ¡ˆæ˜¯3ï¼›æˆ–è€…abcaï¼Œacbaï¼Œç­”æ¡ˆæ˜¯4</li>
<li>æˆ–è€…æ˜¯aâ€¦aâ€¦aï¼Œæ­¤æ—¶ä¸­é—´æœ€å¤šæ”¾2ä¸ªbï¼Œ2ä¸ªcï¼Œåªèƒ½æ˜¯abbaccaæˆ–accabbaï¼Œç­”æ¡ˆä¸º7ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	string s;</span><br><span class="line">	cin &gt;&gt; s;</span><br><span class="line">	<span class="built_in">rep</span>(len,<span class="number">2</span>,<span class="number">7</span>)&#123;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,N<span class="number">-1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i+len&gt;N) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>, c = <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">rep</span>(j,i,i+len<span class="number">-1</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(s[j]==<span class="string">&#x27;a&#x27;</span>) a++;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(s[j]==<span class="string">&#x27;b&#x27;</span>) b++;</span><br><span class="line">				<span class="keyword">else</span> c++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(a&gt;b&amp;&amp;a&gt;c)&#123;</span><br><span class="line">				<span class="built_in">wtl</span>(len);</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">wtl</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="D-Treelabeling"><a href="#D-Treelabeling" class="headerlink" title="D. Treelabeling"></a>D. Treelabeling</h3><p><strong>é¢˜æ„ï¼š</strong> ç»™ä½ ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ï¼Œå¦‚æœä¸¤ä¸ªç‚¹æƒå€¼ä¸ºuï¼Œvï¼Œä¸”u^v&lt;=min(u,v)é‚£ä¹ˆè¿™ä¸¤ä¸ªç‚¹ç›¸è¿ã€‚ç„¶åä¸¤ä¸ªäººä¾æ¬¡é€‰æ‹©ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹æ²¡è¢« é€‰è¿‡ä¸”å’Œå‰ä¸€äººé€‰çš„ç›¸è¿çš„ï¼Œé€‰ä¸äº†çš„äººå°±è¾“äº†ï¼›ç¬¬ä¸€ä¸ªäººå¯ä»¥ä»ä»»æ„ä¸€ä¸ªç‚¹å¼€å§‹ã€‚è¯·æ„é€ ä¸€ä¸ª1-Nçš„æ’åˆ—å¯¹åº”1-Nç¼–å·ç‚¹çš„æƒå€¼ï¼Œä½¿å¾—å…ˆæ‰‹å¿…èƒœçš„ç‚¹æœ€å¤šã€‚</p>
<p><strong>é¢˜è§£ï¼š</strong> é¦–å…ˆä¸€ä¸ªç»“è®ºæ˜¯å…ˆæ‰‹èƒœçš„ç‚¹æœ€å¤šæ˜¯Nå°±æ˜¯æ¯ä¸ªç‚¹éƒ½æ˜¯å…ˆæ‰‹å¿…èƒœã€‚</p>
<ol>
<li>é¢˜ç›®è½¬åŒ–æˆä¸€æ£µæ ‘ä»»æ„ä¸¤ä¸ªç›¸é‚»ç‚¹ä¸äº’é€šï¼Œå³ï¼ˆu^vï¼‰&gt; min(u,v)ï¼Œåªéœ€è¦uï¼Œvçš„äºŒè¿›åˆ¶ä½æ•°ä¸ä¸€æ ·å°±è¡Œã€‚ä»¥ä¸ºå¼‚æˆ–åçš„ä½æ•°å’Œmax(u,v)ç›¸åŒï¼Œè‚¯å®šå¤§äºmin(u,v).</li>
<li>ç”±æ­¤æˆ‘ä»¬å¯ä»¥æƒ³åˆ°æŸ“è‰²é—®é¢˜ã€‚å…ˆå°†è¿™æ£µæ ‘è¿›è¡Œ01æŸ“è‰²ã€‚æŠŠèŠ‚ç‚¹ç¼–å·æ”¾åˆ°æ‰€æŸ“é¢œè‰²çš„é›†åˆä¸­ã€‚</li>
<li>å¯¹äº2è¿›åˆ¶ä½æ•°ç›¸åŒçš„æƒå€¼ä¸èƒ½æ”¾åœ¨ç›¸é‚»ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»æ”¾åœ¨åŒä¸€ç§é¢œè‰²çš„èŠ‚ç‚¹ã€‚</li>
<li>å“ªç§é¢œè‰²å‰©ä½™çš„å¤šå°±æŠŠå½“å‰æšä¸¾åˆ°çš„æƒå€¼æ”¾é‚£ç§é¢œè‰²çš„èŠ‚ç‚¹é‡Œã€‚</li>
<li>æšä¸¾æƒå€¼è¦ä»æƒå€¼ä½æ•°ä»å¤§åˆ°å°æšä¸¾ï¼Œå› ä¸ºå¦‚æœä»å°åˆ°å¤§ï¼Œæœ€åä¸€ç§ä½æ•°çš„æƒå€¼ä¸ªæ•°å¾ˆå¤šï¼Œå¤§äºå‰©ä½™é»‘ç™½èŠ‚ç‚¹ä¸­è¾ƒå¤šçš„ä¸ªæ•°ï¼Œé‚£ä¹ˆä»–å°±ä¼šè¢«åˆ†åˆ°é»‘è‰²å’Œç™½è‰²çš„èŠ‚ç‚¹ï¼Œä¸¤è€…å¯èƒ½æ˜¯ç›¸é‚»çš„ã€‚</li>
</ol>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M,K;</span><br><span class="line"><span class="keyword">int</span> h_bit[maxn];</span><br><span class="line"><span class="keyword">int</span> ans[maxn];</span><br><span class="line">vi G[maxn], node[<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;\\é¢„å¤„ç†æ¯ä¸ªæ•°çš„äºŒè¿›åˆ¶ä½æ•°</span><br><span class="line">	<span class="keyword">int</span> bit = <span class="number">1</span>, cnt = <span class="number">1</span>, nxt = <span class="number">2</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,<span class="number">2e5</span>+<span class="number">7</span>)&#123;</span><br><span class="line">		h_bit[i] = bit;</span><br><span class="line">		cnt--;</span><br><span class="line">		<span class="keyword">if</span>(cnt==<span class="number">0</span>)&#123;</span><br><span class="line">			cnt = nxt;</span><br><span class="line">			bit++;</span><br><span class="line">			nxt&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> col)</span></span>&#123;\\<span class="number">01</span>æŸ“è‰²</span><br><span class="line">	node[col].<span class="built_in">pb</span>(u);\\æŠŠèŠ‚ç‚¹ç¼–å·å­˜å…¥æ‰€æŸ“é¢œè‰²çš„æ¡¶é‡Œ</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> x : G[u])&#123;</span><br><span class="line">		<span class="keyword">if</span>(x == fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(x,u,col^<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) G[i].<span class="built_in">clear</span>();</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">2</span>,N)&#123;</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		G[u].<span class="built_in">pb</span>(v);</span><br><span class="line">		G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>);\\æŸ“è‰²</span><br><span class="line"></span><br><span class="line">	<span class="function">vector&lt;vi&gt; <span class="title">v</span><span class="params">(<span class="number">20</span>)</span></span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">		v[h_bit[i]].<span class="built_in">pb</span>(i);\\æŠŠæ‰€æœ‰æƒå€¼åˆ†ç±»</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">per</span>(i,<span class="number">19</span>,<span class="number">0</span>)&#123;\\æšä¸¾äºŒè¿›åˆ¶é•¿åº¦</span><br><span class="line">		<span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">sz</span>(node[<span class="number">1</span>]) &gt; <span class="built_in">sz</span>(node[<span class="number">0</span>])) cur = <span class="number">1</span>;\\é€‰æ‹©å‰©ä½™èŠ‚ç‚¹è¾ƒå¤šçš„é¢œè‰²</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : v[i])&#123;\\æŠŠå½“å‰æƒå€¼èµ‹å€¼ç»™è¿™ä¸ªé¢œè‰²</span><br><span class="line">			<span class="keyword">int</span> t = node[cur].<span class="built_in">back</span>();</span><br><span class="line">			node[cur].<span class="built_in">pop_back</span>();</span><br><span class="line">			ans[t] = x;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) <span class="built_in">wtb</span>(ans[i]);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="built_in">init</span>();</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>codeforces</category>
      </categories>
  </entry>
  <entry>
    <title>Codeforces Round 769 (Div. 2) E2. Distance Tree (hard version)</title>
    <url>/2022/02/03/Codeforces%20Round%20769%20(Div.%202)%20E2.%20Distance%20Tree%20(hard%20version)/</url>
    <content><![CDATA[<p><strong>é¢˜æ„ï¼š</strong><br>-<br>ç»™ä½ ä¸€æ£µæ ‘ï¼Œæ¯æ¡è¾¹çš„æƒå€¼ä¸º1ï¼Œä½ å¯ä»¥éšä¾¿è¿ä¸€æ¡æƒå€¼ä¸ºxçš„è¾¹ï¼Œæ±‚ä»»ä½•ä¸€ç‚¹åˆ°1å·ç‚¹è·ç¦»çš„æœ€å¤§å€¼çš„æœ€å°å€¼ã€‚å¯¹äºx=[1,N]çš„æ¯ä¸€ä¸ªæ•°è¾“å‡ºä¸€ä¸ªå€¼ã€‚</p>
<hr>
<p><strong>æ€è·¯ï¼š</strong><br>-</p>
<ul>
<li>ç”¨d[i]è¡¨ç¤ºæ·±åº¦å¤§äºiçš„ä¸¤ä¸ªç‚¹çš„å¯¹å¤§è·ç¦»ï¼Œè¿™å¯ä»¥ç”¨dfsæ¥å®ç°ï¼Œå°±æ˜¯æ¯ä¸ªèŠ‚ç‚¹å­æ ‘ä¸­çš„å‰äºŒå¤§çš„æ·±åº¦ï¼Œè®¡ä½œxï¼Œyï¼Œé‚£ä¹ˆå¯ä»¥æ›´æ–°d[min(x,y)-1],å½“æˆ‘ä»¬å–ä¸€éåç¼€maxåç›¸å½“äºiå°äºmin(x,y)çš„d[i]éƒ½è¢«æ›´æ–°äº†ï¼Œç¬¦åˆæˆ‘ä»¬å¯¹dæ•°ç»„çš„å®šä¹‰ã€‚</li>
<li>åŸæ¥æ ‘ä¸­çš„æœ€å¤§æ·±åº¦å°±æ˜¯ç­”æ¡ˆçš„æœ€å¤§å€¼ï¼Œä¸ä¼šæ¯”å®ƒæ›´å¤§ï¼Œå› ä¸ºå¯ä»¥å®Œå…¨ä¸èµ°æ–°åŠ çš„é‚£æ¡è¾¹ã€‚</li>
<li>æ–°åŠ çš„è¾¹ä¸€å®šæ˜¯æ ¹ç»“ç‚¹å’ŒæŸä¸ªç‚¹è¿ã€‚</li>
<li>å½“xå¢åŠ çš„æ—¶å€™ï¼Œanså¿…ç„¶ä¸ä¼šå‡å°‘ã€‚å› ä¸ºæˆ‘ä»¬æŠŠè·¯å¾„åˆ†ä¸ºä¸¤ç±»ï¼Œç¬¬ä¸€ç±»æ˜¯ç»è¿‡æ–°åŠ è¾¹çš„ï¼Œç¬¬äºŒç±»æ˜¯åªç»è¿‡åŸæ¥çš„è¾¹çš„ã€‚éšç€xçš„å¢åŠ ä¸€ä¸ªèŠ‚ç‚¹åˆ°1å·ç‚¹çš„è·ç¦»ä¼šä¸æ–­ä»ç¬¬ä¸€ç±»åˆ°ç¬¬äºŒç±»ã€‚è€Œç¬¬ä¸€ç±»æ˜¯éšç€xå¢åŠ çš„ï¼Œç¬¬äºŒç±»æ˜¯å›ºå®šçš„ä»–æ¯”ä¹‹å‰çš„ç¬¬ä¸€ç±»å¤§ï¼Œæ¯”åæ¥çš„ç¬¬ä¸€ç±»å°ã€‚è¿™æ ·å°±å¯ä»¥åŒæŒ‡é’ˆxå’Œansäº†ã€‚</li>
</ul>
<p><strong>ä»£ç </strong><br>-<br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot; = &quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug2(a,b) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot; = &quot;</span>&lt;&lt;a&lt;&lt;<span class="meta-string">&quot;-----&quot;</span>&lt;&lt;#b&lt;&lt;<span class="meta-string">&quot; = &quot;</span>&lt;&lt;b&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="keyword">int</span> a[maxn],f[maxn],b[maxn],d[maxn],u[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; G[<span class="number">4000</span>];</span><br><span class="line">PII v[maxn];</span><br><span class="line"><span class="keyword">int</span> mmax;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> a[])</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x = a[u], y = a[u];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j : G[u]) &#123;</span><br><span class="line">		<span class="keyword">if</span> (j == fa) <span class="keyword">continue</span>;</span><br><span class="line">		a[j] = a[u] + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> t = <span class="built_in">dfs</span>(j,u,a);</span><br><span class="line">		<span class="keyword">if</span> (t &gt; x) &#123;</span><br><span class="line">			y = x;</span><br><span class="line">			x = t;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (t &gt; y) &#123;</span><br><span class="line">			y = t;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i = <span class="built_in">min</span>(x,y) - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (i &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">		d[i] = <span class="built_in">max</span>(d[i], x + y - <span class="number">2</span> * a[u] + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">	<span class="comment">// return 0;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		G[i].<span class="built_in">clear</span>();</span><br><span class="line">		d[i] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> a, b;</span><br><span class="line">		cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">		G[a].<span class="built_in">pb</span>(b);</span><br><span class="line">		G[b].<span class="built_in">pb</span>(a);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> x = <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">-1</span>,a);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = N<span class="number">-2</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">		d[i] = <span class="built_in">max</span>(d[i],d[i+<span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="comment">//ans&lt;xå› ä¸ºç­”æ¡ˆä¸èƒ½è¶…è¿‡åŸæ¥æ ‘çš„æœ€å¤§æ·±åº¦</span></span><br><span class="line">		<span class="comment">//æ·±åº¦å°äºç­‰äºansçš„èŠ‚ç‚¹å¯ä»¥ä¸ç”¨ç»è¿‡æ–°åŠ çš„è¾¹</span></span><br><span class="line">		<span class="comment">//æ·±åº¦å¤§äºansçš„ç‚¹åªè¦é‚£ä¸¤ä¸ªæ·±åº¦å‰äºŒå¤§çš„æ»¡è¶³å…¶ä»–ç‚¹ä¹Ÿæ»¡è¶³ã€‚</span></span><br><span class="line">		<span class="comment">//æˆ‘ä»¬åªéœ€è¦è¿åˆ°é‚£ä¸¤ä¸ªç‚¹çš„ä¸­ç‚¹çœ‹æ˜¯å¦æ»¡è¶³ï¼ˆd[ans]/2+i &lt;= ansï¼‰</span></span><br><span class="line">		<span class="keyword">while</span>(ans &lt; x &amp;&amp; d[ans]/<span class="number">2</span>+i &gt; ans) ans ++;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">  	<span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>codeforces | æ ‘</category>
      </categories>
  </entry>
  <entry>
    <title>Codeforces Round 770 (Div. 2).  F. Fibonacci Additions</title>
    <url>/2022/02/22/Codeforces%20Round%20770%20(Div.%202).%20%20F.%20Fibonacci%20Additions/</url>
    <content><![CDATA[<h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ ä¸¤ä¸ªæ•°ç»„ï¼Œæ¯æ¬¡è¿›è¡Œæ“ä½œååˆ¤æ–­ä¸¤ä¸ªæ•°ç»„åœ¨æ¨¡modæ„ä¹‰ä¸‹æ˜¯å¦ç›¸ç­‰ã€‚</p>
<ul>
<li>æ“ä½œAï¼šç»™aæ•°ç»„låˆ°råŒºé—´åŠ ä¸Šæ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‰r-l+1é¡¹</li>
<li>æ“ä½œBï¼šç»™bæ•°ç»„låˆ°råŒºé—´åŠ ä¸Šæ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‰r-l+1é¡¹</li>
</ul>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ol>
<li>å¾ˆè‡ªç„¶çš„ï¼Œæˆ‘ä»¬æƒ³åˆ°å¦c[i] = a[i] - b[i]ï¼Œè¿™æ ·å°±æŠŠé—®é¢˜è½¬åŒ–ä¸ºäº†c[i]æ˜¯å¦å…¨éƒ¨æ˜¯0ã€‚</li>
<li><p>æ¥ä¸‹æ¥å°±æ˜¯å®˜æ–¹é¢˜è§£å¾ˆå¦™çš„æƒ³æ³•ï¼ˆå¤ªèœäº†ï¼Œæ²¡è§è¿‡ï¼‰ã€‚æ ¹æ®æ–æ³¢é‚£å¥‘æ•°åˆ—çš„è§„å¾‹æ„å»ºä¸€ä¸ªDæ•°ç»„ï¼ŒD[1] = c[1], D[2] = c[2] - c[1],ä¸€èˆ¬çš„D[i] = c[i] - c[i-1] - c[i-2],å½“D[i]å…¨ä¸º0æ—¶æ˜¾ç„¶D[i]å…¨ä¸ºã€‚è¿™æ ·å°±æŠŠé—®é¢˜è½¬åŒ–ä¸ºäº†D[i]æ˜¯å¦å…¨éƒ¨æ˜¯0ã€‚<br>3.</p>
<ul>
<li>å¯¹äºæ“ä½œAï¼Œå¯¹AåŠ ä¸Šäº†ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œç­‰ä»·äºç»™cåŠ ä¸Šäº†æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œè€Œå¯¹äºDçš„å½±å“åˆ™æ˜¯D[l] += 1, D[r+1] -= F[r-l+2], D[r+2] -= F[r-l+1]</li>
<li>å¯¹äºæ“ä½œBï¼Œå¯¹BåŠ ä¸Šäº†ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œç­‰ä»·äºç»™cå‡å°‘äº†æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œè€Œå¯¹äºDçš„å½±å“åˆ™æ˜¯D[l] -= 1, D[r+1] += F[r-l+2], D[r+2] += F[r-l+1]<br>è¿™æ ·æ¯æ¬¡æ“ä½œå°±å˜æˆO(3)ä¿®æ”¹</li>
</ul>
</li>
<li><p>å¯¹äºæ¯æ¬¡æ“ä½œæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸‹Dæ•°ç»„ä¸­0çš„ä¸ªæ•°å°±å¥½ã€‚</p>
</li>
</ol>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">fib</span><span class="params">(maxn)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N &gt;&gt; Q &gt;&gt; mod;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; x;</span><br><span class="line">		a[i] -= x;</span><br><span class="line">		a[i] = (a[i] + mod) % mod;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	fib.<span class="built_in">resize</span>(N);</span><br><span class="line">	fib[<span class="number">0</span>] = fib[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i ++) fib[i] = (fib[i<span class="number">-1</span>] + fib[i - <span class="number">2</span>]) % mod;</span><br><span class="line">		</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">D</span><span class="params">(N)</span></span>;</span><br><span class="line">	D[<span class="number">0</span>] = a[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">if</span> (N &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">		D[<span class="number">1</span>] = a[<span class="number">1</span>] - a[<span class="number">0</span>]; </span><br><span class="line">		D[<span class="number">1</span>] = ((D[<span class="number">1</span>] % mod) + mod) % mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		D[i] = (((a[i] - a[i<span class="number">-1</span>] - a[i<span class="number">-2</span>]) % mod) + mod) % mod;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> cnt_z = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cnt_z += D[i] == <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">// cout &lt;&lt; cnt_z &lt;&lt; &quot;hhh&quot; &lt;&lt; endl;</span></span><br><span class="line">	<span class="keyword">auto</span> add = [&amp;](<span class="keyword">int</span> p, <span class="keyword">int</span> v) &#123;</span><br><span class="line">		<span class="keyword">if</span> (p &lt; <span class="number">0</span> || p &gt;= N) <span class="keyword">return</span>;</span><br><span class="line">		cnt_z -= D[p] == <span class="number">0</span>;</span><br><span class="line">		D[p] = (((D[p] + v) % mod) + mod) % mod;</span><br><span class="line">		cnt_z += D[p] == <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="keyword">char</span> op;</span><br><span class="line">		<span class="keyword">int</span> l, r;</span><br><span class="line">		cin &gt;&gt; op &gt;&gt; l &gt;&gt; r;</span><br><span class="line">		l --, r --;</span><br><span class="line">		<span class="keyword">if</span> (op == <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">			<span class="built_in">add</span>(l, <span class="number">1</span>);</span><br><span class="line">			<span class="built_in">add</span>(r + <span class="number">1</span>, -fib[r-l+<span class="number">1</span>]);</span><br><span class="line">			<span class="built_in">add</span>(r + <span class="number">2</span>, -fib[r-l]);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">add</span>(l, <span class="number">-1</span>);</span><br><span class="line">			<span class="built_in">add</span>(r + <span class="number">1</span>, fib[r-l+<span class="number">1</span>]);</span><br><span class="line">			<span class="built_in">add</span>(r + <span class="number">2</span>, fib[r-l]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (cnt_z == N) &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;YES\n&quot;</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>codeforces</category>
      </categories>
  </entry>
  <entry>
    <title>Codeforces Round 775   E.Tyler and Strings</title>
    <url>/2022/03/08/Codeforces%20Round%20775%20%20%20E.Tyler%20and%20Strings%20/</url>
    <content><![CDATA[<h1 id="Tyler-and-Strings"><a href="#Tyler-and-Strings" class="headerlink" title="Tyler and Strings "></a><a href="https://codeforces.com/contest/1649/problem/E">Tyler and Strings </a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>ç»™ä½ ä¸€ä¸ªaæ•°ç»„å’Œä¸€ä¸ªbæ•°ç»„ï¼Œæ±‚aæ•°ç»„æœ‰å‡ ç§å­—å…¸åºæ¯”bæ•°ç»„å°çš„æ’åˆ—ï¼ˆå»é‡ï¼‰</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><ul>
<li>ç±»ä¼¼æ•°ä½dpçš„æ€è·¯ï¼Œå¦‚æœaæ•°ç»„å½“å‰ä½ç½®æ”¾ç½®çš„æ•°æ¯”bæ•°ç»„å°ï¼Œåˆ™åé¢å¯ä»¥éšä¾¿æ”¾ã€‚</li>
<li>ç„¶ååœ¨å½“å‰ä½ç½®æ”¾å’Œbæ•°ç»„ç›¸åŒçš„æ•°ç»§ç»­åˆ°ä¸‹ä¸€ä½ã€‚å¦‚æœè¿™ä¸ªæ•°æ”¾å®Œäº†ï¼Œè¯´æ˜è¿™ä¸ªä½ç½®åªèƒ½æ”¾æ¯”bæ•°ç»„å¤§çš„æ•°ï¼ˆæ”¾å°äºçš„è´¡çŒ®ç®—è¿‡äº†ï¼‰ï¼Œåˆ™breakã€‚</li>
<li>å½“å‰ä½ç½®æ”¾å°äºçš„æ•°çš„è´¡çŒ®è®¡ç®—<ul>
<li>è¿˜å‰©å‡ ä¸ªå°äºb[i]çš„æ•°preï¼Œè¿™ä¸ªå¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚</li>
<li>cnt[i]æ˜¯æ•°å­—iå‰©ä¸‹çš„ä¸ªæ•°ï¼Œåˆ™åé¢éšä¾¿æ”¾å»é‡åçš„æ’åˆ—æœ‰pre <em> fact[åé¢å‰©ä¸‹çš„ä½æ•°] / (fact[cnt[1]] </em> fact[cnt[2]] <em> â€¦ </em> fact[cnt[k]]).</li>
</ul>
</li>
</ul>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">using</span> i64 = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">norm</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        x += P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= P) &#123;</span><br><span class="line">        x -= P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">power</span><span class="params">(T a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    T res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b /= <span class="number">2</span>, a *= a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span>) &#123;</span><br><span class="line">            res *= a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Z</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">Z</span>(<span class="keyword">int</span> x = <span class="number">0</span>) : <span class="built_in">x</span>(<span class="built_in">norm</span>(x)) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">val</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    Z <span class="keyword">operator</span>-() <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Z</span>(<span class="built_in">norm</span>(P - x));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Z <span class="title">inv</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(x != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">power</span>(*<span class="keyword">this</span>, P - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>*=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">i64</span>(x) * rhs.x % P;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>+=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x + rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>-=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x - rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>/=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> *= rhs.<span class="built_in">inv</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>*(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res *= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>+(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res += rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>-(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res -= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>/(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res /= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fenwick</span> &#123;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> n;</span><br><span class="line">    std::vector&lt;T&gt; a;</span><br><span class="line">    <span class="built_in">Fenwick</span>(<span class="keyword">int</span> n) : <span class="built_in">n</span>(n), <span class="built_in">a</span>(n) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, T v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x + <span class="number">1</span>; i &lt;= n; i += i &amp; -i) &#123;</span><br><span class="line">            a[i - <span class="number">1</span>] += v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">sum</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="comment">//å°äºxçš„å‰ç¼€å’Œ</span></span><br><span class="line">        T ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &gt; <span class="number">0</span>; i -= i &amp; -i) &#123;</span><br><span class="line">            ans += a[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">rangeSum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(r) - <span class="built_in">sum</span>(l);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="function">Fenwick&lt;Z&gt; <span class="title">fen</span><span class="params">(<span class="number">2e5</span>)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N)</span>,<span class="title">b</span><span class="params">(M)</span>,<span class="title">cnt</span><span class="params">(maxn)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">		a[i] --;</span><br><span class="line">		cnt[a[i]] ++;</span><br><span class="line">		fen.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; b[i];</span><br><span class="line">		b[i] --;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;Z&gt; <span class="title">fact</span><span class="params">(N+<span class="number">7</span>)</span>, <span class="title">infact</span><span class="params">(N+<span class="number">7</span>)</span>, <span class="title">inv</span><span class="params">(N + <span class="number">7</span>)</span></span>;</span><br><span class="line">    fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">        fact[i] = fact[i - <span class="number">1</span>] * i;</span><br><span class="line">    &#125;</span><br><span class="line">    infact[N] = fact[N].<span class="built_in">inv</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = N; i; i--) &#123;</span><br><span class="line">        infact[i - <span class="number">1</span>] = infact[i] * i;</span><br><span class="line">        inv[i] = infact[i] * fact[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	Z cur = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2e5</span>; i ++) &#123;</span><br><span class="line">		cur *= infact[cnt[i]];</span><br><span class="line">	&#125;</span><br><span class="line">	Z ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">min</span>(M, N); i ++) &#123;</span><br><span class="line">		ans += cur * fen.<span class="built_in">sum</span>(b[i]) * fact[N - i - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (cnt[b[i]] == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cur *= cnt[b[i]];</span><br><span class="line">		cnt[b[i]] --;</span><br><span class="line">		fen.<span class="built_in">add</span>(b[i], <span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (N &lt; M &amp;&amp; cnt == vector&lt;<span class="keyword">int</span>&gt; (maxn,<span class="number">0</span>)) &#123;</span><br><span class="line">		ans += <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; ans.<span class="built_in">val</span>() &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>codeforces</category>
      </categories>
  </entry>
  <entry>
    <title>Codeforces Round 776 (Div. 3)  EFG</title>
    <url>/2022/03/09/Codeforces%20Round%20776%20(Div.%203)%20%20EFG/</url>
    <content><![CDATA[<h1 id="E-Rescheduling-the-Exam"><a href="#E-Rescheduling-the-Exam" class="headerlink" title="E. Rescheduling the Exam"></a>E. Rescheduling the Exam</h1><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ Nä¸ªç‚¹çš„åæ ‡ï¼Œä½ å¯ä»¥é‡ç½®ä¸€ä¸ªç‚¹çš„ä½ç½®ï¼Œè®©æ¯ä¸ªç‚¹å’Œå‰ä¸€ä¸ªç‚¹çš„è·ç¦»çš„æœ€å°å€¼æœ€å¤§ã€‚ï¼ˆç¬¬ä¸€ä¸ªç‚¹äºå‰ä¸€ç‚¹çš„è·ç¦»æ˜¯å’ŒåŸç‚¹çš„è·ç¦»ï¼‰</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è¦æƒ³æœ€å°è·ç¦»æ›´å¤§ï¼Œé‚£æˆ‘ä»¬è¦ç§»åŠ¨çš„ç‚¹ä¸€å®šæ˜¯æœ€çŸ­è·ç¦»çš„ä¸¤ä¸ªç«¯ç‚¹çš„å…¶ä¸­ä¸€ä¸ªã€‚<br>é‚£ä¹ˆè¿™ä¸ªç‚¹æœ‰ä¸¤ç§å»å‘</p>
<ol>
<li>æ”¾åœ¨æœ€åï¼Œæ–°å¢ä¸€ä¸ªd - a.back()çš„çº¿æ®µ</li>
<li>æ”¾åœ¨æœ€å¤§åŒºé—´çš„ä¸­é—´ï¼Œæ–°å¢ä¸€ä¸ª(max - 1) / 2 çš„çº¿æ®µ<br>å¯¹ä¸¤ä¸ªç‚¹è¿›è¡Œç›¸åŒæ“ä½œå–max</li>
</ol>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N + <span class="number">1</span>)</span>,b</span>;</span><br><span class="line">	<span class="comment">// a.push_back(0);</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">int</span> p, mmin = INF;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[i] - a[i - <span class="number">1</span>] - <span class="number">1</span> &lt; mmin) &#123;</span><br><span class="line">			mmin = a[i] - a[i - <span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">			p = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> las = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i != p) &#123;</span><br><span class="line">			b.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">			las = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	vector&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; b.<span class="built_in">size</span>(); i ++) v.<span class="built_in">push_back</span>(b[i] - b[i<span class="number">-1</span>] - <span class="number">1</span>);</span><br><span class="line">	<span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> ans = <span class="built_in">min</span>(v[<span class="number">0</span>], <span class="built_in">max</span>(M - a[las] - <span class="number">1</span>,(v.<span class="built_in">back</span>() - <span class="number">1</span>) / <span class="number">2</span>));</span><br><span class="line">	v.<span class="built_in">clear</span>();</span><br><span class="line">	<span class="keyword">if</span> (p &gt; <span class="number">1</span>) b[p - <span class="number">1</span>] = a[p];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; b.<span class="built_in">size</span>(); i ++) v.<span class="built_in">push_back</span>(b[i] - b[i<span class="number">-1</span>] - <span class="number">1</span>);</span><br><span class="line">	<span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">if</span> (las == p - <span class="number">1</span>) &#123;</span><br><span class="line">		las = p;</span><br><span class="line">	&#125;</span><br><span class="line">	ans = <span class="built_in">max</span>(ans, <span class="built_in">min</span>(v[<span class="number">0</span>], <span class="built_in">max</span>(M - a[las] - <span class="number">1</span>,(v.<span class="built_in">back</span>() - <span class="number">1</span>) / <span class="number">2</span>)));</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="Vitaly-and-Advanced-Useless-Algorithms"><a href="#Vitaly-and-Advanced-Useless-Algorithms" class="headerlink" title="Vitaly and Advanced Useless Algorithms"></a>Vitaly and Advanced Useless Algorithms</h1><h3 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ä½ æœ‰Nä¸ªä»»åŠ¡ï¼Œç¬¬iä¸ªä»»åŠ¡è¦åœ¨a[i]ä¹‹å‰å®Œæˆï¼Œç„¶åæœ‰Mç§é€‰æ‹©ï¼Œæ¯ç§é€‰æ‹©ä½ å¯ä»¥èŠ±è´¹tæ—¶é—´å®Œæˆç¬¬eä¸ªä»»åŠ¡çš„ç™¾åˆ†ä¹‹pã€‚å¦‚æœä¸èƒ½å®Œæˆæ‰€æœ‰ä»»åŠ¡è¾“å‡º-1ï¼Œå¦åˆ™è¾“å‡ºé€‰æ‹©çš„æ•°é‡ï¼Œå’Œæ¯ç§é€‰æ‹©çš„æ•°é‡ã€‚</p>
<h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>æŠŠæ‰€æœ‰é€‰æ‹©æŒ‰ç…§æ˜¯é’ˆå¯¹å“ªä¸ªä»»åŠ¡çš„åˆ†ç±»ï¼Œå¯¹æ¯ä¸€ä¸ªä»»åŠ¡çš„é€‰æ‹©é›†åˆåšä¸€æ¬¡01èƒŒåŒ…ï¼ŒèƒŒåŒ…å®¹é‡è¦å¼€åˆ°ä¸¤ç™¾ï¼Œé‚£ä¹ˆå®Œæˆè¿™ä¸ªä»»åŠ¡çš„æœ€å°èŠ±è´¹æ˜¯dp[100â€¦200]ã€‚</p>
<p>ç„¶åä»å‰å¾€åæšä¸¾æ¯ä¸ªä»»åŠ¡ï¼Œæ¯æ¬¡åŠ ä¸Šå®Œæˆå½“å‰ä»»åŠ¡çš„æœ€å°èŠ±è´¹ï¼Œå¦‚æœå¤§äºæˆªæ­¢æ—¶é—´åˆ™è¾“å‡º-1ã€‚</p>
<p>ç”±äºæœ€åè¦è¾“å‡ºæ–¹æ¡ˆï¼Œå®šä¹‰dpæ•°ç»„ç¬¬ä¸€ä½æ˜¯èŠ±è´¹çš„æ—¶é—´ï¼Œç¬¬äºŒä½æ˜¯å·²é€‰é€‰æ‹©çš„ç¼–å·ï¼ˆvectorï¼‰</p>
<h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); cout &lt;&lt; endl;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;   &quot;</span>;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> first,second,id;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	vector&lt;node&gt; w[N];</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">tt</span><span class="params">(N)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; tt[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> e, t, p;</span><br><span class="line">		cin &gt;&gt; e &gt;&gt; t &gt;&gt; p;</span><br><span class="line">		e --;</span><br><span class="line">		w[e].<span class="built_in">push_back</span>(&#123;t,p,i + <span class="number">1</span>&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	vector&lt;pair&lt;<span class="keyword">int</span>, vector&lt;<span class="keyword">int</span>&gt;&gt;&gt; <span class="built_in">cost</span>(N);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		vector&lt;pair&lt;<span class="keyword">int</span>, vector&lt;<span class="keyword">int</span>&gt; &gt; &gt; <span class="built_in">dp</span>(<span class="number">201</span>,&#123;INF,vector&lt;<span class="keyword">int</span>&gt; (<span class="number">0</span>)&#125;);</span><br><span class="line">		dp[<span class="number">0</span>] = &#123;<span class="number">0</span>,vector&lt;<span class="keyword">int</span>&gt; (<span class="number">0</span>)&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; w[i].<span class="built_in">size</span>(); k ++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">100</span> + w[i][k].second; j &gt;= w[i][k].second; j --) &#123;</span><br><span class="line">				<span class="keyword">if</span> (dp[j - w[i][k].second].first + w[i][k].first &lt; dp[j].first) &#123;</span><br><span class="line">					dp[j] = dp[j - w[i][k].second];</span><br><span class="line">					dp[j].first += w[i][k].first;</span><br><span class="line">					dp[j].second.<span class="built_in">push_back</span>(w[i][k].id);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		cost[i] = &#123;INF,vector&lt;<span class="keyword">int</span>&gt; (<span class="number">0</span>)&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">100</span>; j &lt;= <span class="number">200</span>; j ++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (cost[i].first &gt; dp[j].first) &#123;</span><br><span class="line">				cost[i] = dp[j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">	vector&lt;vector&lt;<span class="keyword">int</span>&gt; &gt; ans;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		now += cost[i].first;</span><br><span class="line">		ans.<span class="built_in">push_back</span>(cost[i].second);</span><br><span class="line">		res += cost[i].second.<span class="built_in">size</span>();</span><br><span class="line">		<span class="comment">// debug(cost[i].first, i);</span></span><br><span class="line">		<span class="keyword">if</span> (now &gt; tt[i]) &#123;</span><br><span class="line">			cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : ans) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> y : x) &#123;</span><br><span class="line">			cout &lt;&lt; y &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="G-Counting-Shortcuts"><a href="#G-Counting-Shortcuts" class="headerlink" title="G. Counting Shortcuts"></a>G. Counting Shortcuts</h1><h3 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æ¨¡æ¿é¢˜ï¼Œæ¬¡çŸ­è·¯è®¡æ•°  <a href="https://www.acwing.com/problem/content/385/">åŸé¢˜</a></p>
<h3 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å°†æ•°ç»„å¢åŠ ä¸€ç»´ï¼Œä»£è¡¨æœ€çŸ­è·¯å’Œæ¬¡çŸ­è·¯ï¼Œæœ€ååˆ¤æ–­æ¬¡çŸ­è·¯æ˜¯å¦ç­‰äºæœ€çŸ­è·¯+1ï¼Œæ˜¯çš„è¯å°±åŠ ä¸Šæ¬¡çŸ­è·¯çš„è·¯å¾„æ•°ã€‚</p>
<h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span> <span class="keyword">int</span> v, c; &#125;;</span><br><span class="line">vector&lt;edge&gt; G[maxn];</span><br><span class="line"><span class="keyword">int</span> S, F;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Dij</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, c, flog;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt; (<span class="keyword">const</span> Dij&amp; r) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> c&gt;r.c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dist[maxn][<span class="number">2</span>], vis[maxn][<span class="number">2</span>], dp[maxn][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dist, <span class="number">0x3f</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(dist));</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(vis));</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(dp));</span><br><span class="line">    dp[S][<span class="number">0</span>]=<span class="number">1</span>; dist[S][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    priority_queue&lt;Dij&gt; que;</span><br><span class="line">    que.<span class="built_in">push</span>((Dij)&#123;S, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span>(!que.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        Dij tp = que.<span class="built_in">top</span>(); que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">int</span> u = tp.u, flog = tp.flog;    <span class="comment">//ä½¿ç”¨è¿™ä¸ªçŠ¶æ€æ›´æ–°å…¶ä»–çš„</span></span><br><span class="line">        <span class="keyword">if</span>(vis[u][flog]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[u][flog] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;G[u].<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> v = G[u][i].v, c = G[u][i].c;</span><br><span class="line">            <span class="keyword">int</span> w = dist[u][flog] + c;</span><br><span class="line">            <span class="keyword">if</span>(w &lt; dist[v][<span class="number">0</span>])    <span class="comment">//æ›´æ–°æ¬¡çŸ­è·¯ æœ€çŸ­è·¯</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(dist[v][<span class="number">0</span>] != inf)</span><br><span class="line">                &#123;</span><br><span class="line">                    dist[v][<span class="number">1</span>] = dist[v][<span class="number">0</span>];</span><br><span class="line">                    dp[v][<span class="number">1</span>] = dp[v][<span class="number">0</span>];</span><br><span class="line">                    que.<span class="built_in">push</span>((Dij)&#123;v, dist[v][<span class="number">1</span>], <span class="number">1</span>&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                dist[v][<span class="number">0</span>] = w;</span><br><span class="line">                dp[v][<span class="number">0</span>] = dp[u][flog];</span><br><span class="line">                que.<span class="built_in">push</span>((Dij)&#123;v, dist[v][<span class="number">0</span>], <span class="number">0</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(w == dist[v][<span class="number">0</span>])      <span class="comment">//æ›´æ–°æ–¹æ³•æ•°</span></span><br><span class="line">                (dp[v][<span class="number">0</span>] += dp[u][flog])%=mod;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(w &lt; dist[v][<span class="number">1</span>])   <span class="comment">//æ›´æ–°æ¬¡çŸ­è·¯</span></span><br><span class="line">            &#123;</span><br><span class="line">                dist[v][<span class="number">1</span>] = w;</span><br><span class="line">                dp[v][<span class="number">1</span>] = dp[u][flog];</span><br><span class="line">                que.<span class="built_in">push</span>((Dij)&#123;v, dist[v][<span class="number">1</span>], <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(w == dist[v][<span class="number">1</span>])    <span class="comment">//æ›´æ–°æ–¹æ³•æ•°</span></span><br><span class="line">                (dp[v][<span class="number">1</span>] += dp[u][flog]) %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;N, &amp;M);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=N; i++) G[i].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;S, &amp;F);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;M; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> u, v;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">            G[u].<span class="built_in">push_back</span>((edge)&#123;v, <span class="number">1</span>&#125;);</span><br><span class="line">            G[v].<span class="built_in">push_back</span>((edge)&#123;u, <span class="number">1</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dijkstra</span>();</span><br><span class="line">        <span class="keyword">if</span>(dist[F][<span class="number">1</span>]-dist[F][<span class="number">0</span>] == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (dp[F][<span class="number">0</span>]+dp[F][<span class="number">1</span>])%mod);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dp[F][<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>codeforces</category>
      </categories>
  </entry>
  <entry>
    <title>Educational Codeforces Round 118</title>
    <url>/2021/12/03/Educational%20Codeforces%20Round%20118%20/</url>
    <content><![CDATA[<h2 id="A-Long-Comparison"><a href="#A-Long-Comparison" class="headerlink" title="A. Long Comparison"></a>A. Long Comparison</h2><p><strong>é¢˜æ„ï¼š</strong><br>ç»™ä½ x1ï¼Œp1ï¼Œx2ï¼Œp2ï¼Œä»£è¡¨äº†ä¸¤ä¸ªæ•°ï¼Œx1 <em> powï¼ˆ10ï¼Œp1ï¼‰å’Œx2 </em> powï¼ˆ10ï¼Œp2ï¼‰ï¼Œæ¯”è¾ƒä¸¤ä¸ªæ•°çš„å¤§å°ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<ul>
<li>é¦–å…ˆæ¯”è¾ƒä¸¤ä¸ªæ•°å­—çš„é•¿åº¦ï¼Œé•¿åº¦é•¿çš„è‚¯å®šå¤§ï¼ˆè¯´äº†æ²¡æœ‰å‰å¯¼é›¶ï¼‰</li>
<li>é•¿åº¦ç›¸ç­‰çš„æƒ…å†µä¸‹ï¼Œåªè¦æŠŠé•¿åº¦çŸ­çš„æ•°å­—æœ«å°¾è¡¥0è¡¥åˆ°å’Œé•¿åº¦é•¿çš„æ•°å­—ä¸€æ ·ï¼Œç„¶åæ¯”è¾ƒå­—ç¬¦ä¸²å°±å¥½äº†ã€‚</li>
</ul>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IOS ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CN puts(<span class="meta-string">&quot;NO&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CY puts(<span class="meta-string">&quot;YES&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> fact[maxn], infact[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">jie_init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,n) fact[i] = fact[i<span class="number">-1</span>] * i % mod;	</span><br><span class="line">	infact[n] = <span class="built_in">qmi</span>(fact[n],mod<span class="number">-2</span>,mod);</span><br><span class="line">	<span class="built_in">per</span>(i,n<span class="number">-1</span>,<span class="number">0</span>) infact[i] = infact[i+<span class="number">1</span>] * (i+<span class="number">1</span>) % mod;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;<span class="keyword">return</span> fact[n] * infact[m] % mod * infact[n-m] % mod;&#125;</span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> a, b, p1, p2;</span><br><span class="line">	cin &gt;&gt; a &gt;&gt; p1 &gt;&gt; b &gt;&gt; p2;</span><br><span class="line">	string s1 = <span class="built_in">to_string</span>(a), s2 = <span class="built_in">to_string</span>(b);</span><br><span class="line">	N = s1.<span class="built_in">size</span>(), M = s2.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">if</span>(N+p1&gt;M+p2)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;&gt;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(N+p1&lt;M+p2)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;&lt;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(N&lt;M)&#123;</span><br><span class="line">			<span class="built_in">rep</span>(i,<span class="number">1</span>,M-N) s1 = s1 + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">rep</span>(i,<span class="number">1</span>,N-M) s2 = s2 + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="built_in">max</span>(<span class="built_in">sz</span>(s1),<span class="built_in">sz</span>(s2))<span class="number">-1</span>)<span class="comment">//å…¶å®ä¸ç”¨å¾ªç¯ï¼Œå¯ä»¥ç›´æ¥å­—ç¬¦ä¸²æ¯”è¾ƒ</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(s1[i]&gt;s2[i])&#123;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(s1[i] &lt; s2[i])&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;&lt;\n&quot;</span>;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;=\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IOS</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="B-Absent-Remainder"><a href="#B-Absent-Remainder" class="headerlink" title="B. Absent Remainder"></a>B. Absent Remainder</h2><p><strong>é¢˜æ„</strong><br>ç»™ä½ nä¸ªæ•°ï¼Œè¯·ä½ æ‰¾åˆ°n/2å¯¹æ•°ï¼Œå¤§æ•°æ¨¡å°æ•°çš„ç»“æœåœ¨åŸæ¥nä¸ªæ•°ä¸­æ²¡æœ‰å‡ºç°è¿‡ã€‚</p>
<p><strong>æ€è·¯</strong><br>å¯¹äºå°çš„æ•°æˆ‘ä»¬æ€»æ˜¯é€‰æ‹©åŸæ•°åˆ—æœ€å°çš„ï¼Œè¿™æ ·%å®Œçš„ç»“æœä¸€å®šæ¯”æœ€å°çš„æ•°å°ï¼Œé‚£ä¹ˆåœ¨åŸæ•°åˆ—è¿™ä¸ªæ•°è‚¯å®šä¸å­˜æ¥ã€‚</p>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IOS ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CN puts(<span class="meta-string">&quot;NO&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CY puts(<span class="meta-string">&quot;YES&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> fact[maxn], infact[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">jie_init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,n) fact[i] = fact[i<span class="number">-1</span>] * i % mod;	</span><br><span class="line">	infact[n] = <span class="built_in">qmi</span>(fact[n],mod<span class="number">-2</span>,mod);</span><br><span class="line">	<span class="built_in">per</span>(i,n<span class="number">-1</span>,<span class="number">0</span>) infact[i] = infact[i+<span class="number">1</span>] * (i+<span class="number">1</span>) % mod;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;<span class="keyword">return</span> fact[n] * infact[m] % mod * infact[n-m] % mod;&#125;</span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; A[i];</span><br><span class="line">	<span class="built_in">sort</span>(A+<span class="number">1</span>,A+<span class="number">1</span>+N);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">2</span>,(N/<span class="number">2</span>)+<span class="number">1</span>)&#123;</span><br><span class="line">		cout &lt;&lt; A[i] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; A[<span class="number">1</span>] &lt;&lt; endl;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IOS</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="C-Poisoned-Dagger"><a href="#C-Poisoned-Dagger" class="headerlink" title="C. Poisoned Dagger"></a>C. Poisoned Dagger</h2><p><strong>é¢˜æ„</strong><br>ç»™ä½ ä¸€ä¸ªNï¼ŒHï¼Œä»£è¡¨ä½ æ”»å‡»çš„æ¬¡æ•°ï¼Œæ€ªç‰©çš„è¡€é‡ï¼Œå†ç»™ä½ Nä¸ªæ•°ä»£è¡¨Næ¬¡æ”»å‡»çš„æ—¶é—´ç‚¹ã€‚æ”»å‡»åŠ›ä¸ºxï¼ŒæŒ‡ç¬¬tç§’æ”»å‡»åï¼Œtï¼Œt+1â€¦t+x-1ï¼Œæ¯ç§’é€ æˆä¸€ç‚¹ä¼¤å®³ï¼Œå¦‚æœä¸Šä¸€æ¬¡æ”»å‡»æ•ˆæœå¤±æ•ˆä¹‹å‰åˆè¿›è¡Œäº†ä¸€æ¬¡æ”»å‡»ï¼Œé‚£ä¹ˆä¹‹å‰çš„æ•ˆæœæ¶ˆå¤±ï¼Œåªè®¡ç®—å½“å‰æœ€æ–°çš„æ”»å‡»ã€‚æ±‚å¯ä»¥æ€æ­»æ€ªç‰©çš„æœ€å°xã€‚</p>
<p><strong>æ€è·¯</strong><br>å¦‚æœxæ”»å‡»åŠ›èƒ½æ€æ­»æ€ªç‰©ï¼Œé‚£ä¹ˆx+1æ”»å‡»åŠ›ä¸€å®šå¯ä»¥æ€æ­»æ€ªç‰©ï¼Œæ»¡è¶³äºŒåˆ†æ€§ã€‚</p>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IOS ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CN puts(<span class="meta-string">&quot;NO&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CY puts(<span class="meta-string">&quot;YES&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> fact[maxn], infact[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">jie_init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,n) fact[i] = fact[i<span class="number">-1</span>] * i % mod;	</span><br><span class="line">	infact[n] = <span class="built_in">qmi</span>(fact[n],mod<span class="number">-2</span>,mod);</span><br><span class="line">	<span class="built_in">per</span>(i,n<span class="number">-1</span>,<span class="number">0</span>) infact[i] = infact[i+<span class="number">1</span>] * (i+<span class="number">1</span>) % mod;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;<span class="keyword">return</span> fact[n] * infact[m] % mod * infact[n-m] % mod;&#125;</span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ck</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(A[i]+x&gt;=A[i+<span class="number">1</span>])&#123;</span><br><span class="line">			ans+=A[i+<span class="number">1</span>]-A[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			ans+=x;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	ans+=x;</span><br><span class="line">	<span class="keyword">if</span>(ans&gt;=M) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; A[i];</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">1</span>, r = M;</span><br><span class="line">	<span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">		<span class="keyword">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">ck</span>(mid)) r = mid;</span><br><span class="line">		<span class="keyword">else</span> l = mid+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; l &lt;&lt;endl;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IOS</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="D-MEX-Sequences"><a href="#D-MEX-Sequences" class="headerlink" title="D. MEX Sequences"></a>D. MEX Sequences</h2><p><strong>é¢˜æ„</strong><br>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œé—®æœ‰å¤šå°‘ä¸ªå­åºåˆ—ï¼ˆä¸è¿ç»­ï¼‰æ»¡è¶³å¯¹äºå­åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ çš„å€¼å’Œå®ƒçš„å‰ç¼€MEXç›¸å·®ç»å¯¹å€¼å°äºç­‰äº1.</p>
<p><strong>æ€è·¯</strong><br>DP</p>
<ol>
<li><p>çŠ¶æ€è¡¨ç¤º dp[i][0] è¡¨ç¤ºMEX = iï¼Œæœ€å¤§å€¼ä¸ºi-1 ï¼› dp[i][1] è¡¨ç¤ºMEX = iï¼Œæœ€å¤§å€¼ä¸ºi+1ã€‚<br> å¯èƒ½ä¼šæœ‰æœ€å¤§å€¼ä¸ºi+2çš„æƒ…å†µï¼Œä½†è¿™ç§ä¸æ»¡è¶³é¢˜ç›®è¦æ±‚ã€‚</p>
</li>
<li><p>ç­”æ¡ˆç´¯åŠ <br> å½“å‰çš„æ•°æ˜¯A[i]ï¼Œé‚£ä¹ˆåŠ ä¸ŠA[i]ååºåˆ—ç¬¦åˆæ¡ä»¶çš„MEXåº”è¯¥æ˜¯A[i] ( ä¸å¯èƒ½ï¼Œå½“å‰çš„æ•°å°±æ˜¯A[i] ), A[i]-1 , A[i]+1ã€‚</p>
<ul>
<li>åŸæ¥çš„dp[A[i]-1][0] å’Œ dp[A[i]-1][1]åŠ ä¸Šä¸€ä¸ªA[i]åMEXå˜ä¸ºA[i]</li>
<li>åŸæ¥çš„dp[A[i]][0] åŠ ä¸Šä¸€ä¸ªA[i]åMEXå˜ä¸ºA[i]+1</li>
<li><p>åŸæ¥çš„dp[A[i]+1][0] å’Œ  dp[A[i]+1][1] åŠ ä¸Šä¸€ä¸ªA[i]åMEXå˜æˆA[i]+1</p>
<p><strong>æ‰€ä»¥ç­”æ¡ˆç´¯åŠ ä¸Šä¸Šè¿°çš„dpæ•°ç»„å°±å¥½äº†</strong></p>
</li>
</ul>
</li>
<li>dpæ•°ç»„æ›´æ–°<br> å½“å‰çš„æ•°æ˜¯A[i]<ul>
<li>dp[A[i]-1][1] *= 2    </li>
<li>dp[A[i]-1][1] += dp[A[i]-1][0]</li>
<li>dp[A[i]+1][0] *= 2</li>
<li>dp[A[i]+1][0] += dp[A[i]][0]</li>
<li>dp[A[i]+1][1] *= 2</li>
</ul>
</li>
</ol>
<p><strong>ä»£ç </strong></p>
<h2 id=""><a href="#" class="headerlink" title=""></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IOS ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CN puts(<span class="meta-string">&quot;NO&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CY puts(<span class="meta-string">&quot;YES&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> fact[maxn], infact[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">jie_init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,n) fact[i] = fact[i<span class="number">-1</span>] * i % mod;	</span><br><span class="line">	infact[n] = <span class="built_in">qmi</span>(fact[n],mod<span class="number">-2</span>,mod);</span><br><span class="line">	<span class="built_in">per</span>(i,n<span class="number">-1</span>,<span class="number">0</span>) infact[i] = infact[i+<span class="number">1</span>] * (i+<span class="number">1</span>) % mod;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;<span class="keyword">return</span> fact[n] * infact[m] % mod * infact[n-m] % mod;&#125;</span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn][<span class="number">2</span>],f[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; A[i];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N+<span class="number">6</span>) dp[i][<span class="number">0</span>] = dp[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	dp[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">		<span class="keyword">if</span>(A[i]) ans+=dp[A[i]<span class="number">-1</span>][<span class="number">0</span>] + dp[A[i]<span class="number">-1</span>][<span class="number">1</span>];</span><br><span class="line">		ans += dp[A[i]][<span class="number">0</span>] + dp[A[i]+<span class="number">1</span>][<span class="number">0</span>] + dp[A[i]+<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">		ans %= mod;</span><br><span class="line">		<span class="keyword">if</span>(A[i])&#123;</span><br><span class="line">			dp[A[i]<span class="number">-1</span>][<span class="number">1</span>] *= <span class="number">2</span>;</span><br><span class="line">			dp[A[i]<span class="number">-1</span>][<span class="number">1</span>] += dp[A[i]<span class="number">-1</span>][<span class="number">0</span>];</span><br><span class="line">			dp[A[i]<span class="number">-1</span>][<span class="number">1</span>] %= mod;</span><br><span class="line">		&#125;</span><br><span class="line">		dp[A[i]+<span class="number">1</span>][<span class="number">0</span>] *= <span class="number">2</span>;</span><br><span class="line">		dp[A[i]+<span class="number">1</span>][<span class="number">0</span>] += dp[A[i]][<span class="number">0</span>];</span><br><span class="line">		dp[A[i]+<span class="number">1</span>][<span class="number">1</span>] *= <span class="number">2</span>;</span><br><span class="line">		dp[A[i]+<span class="number">1</span>][<span class="number">1</span>] %= mod;</span><br><span class="line">		dp[A[i]+<span class="number">1</span>][<span class="number">0</span>] %= mod;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans%mod &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// IOS</span></span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></h2><h2 id="E-Crazy-Robot"><a href="#E-Crazy-Robot" class="headerlink" title="E. Crazy Robot"></a>E. Crazy Robot</h2><p><strong>é¢˜æ„</strong><br>ç»™ä½ ä¸€ä¸ªN*Mçš„å›¾ï¼ŒåªåŒ…å«â€™.â€™  â€˜#â€™  â€˜Lâ€™  ä»£è¡¨äº†ç©ºåœ°ï¼Œéšœç¢ï¼Œç»ˆç‚¹ã€‚ç©ºåœ°æ”¾ç½®ä¸€ä¸ªåäº†çš„æœºå™¨äººï¼Œä½ ç»™ä»–ä¸€ä¸ªæŒ‡ä»¤ï¼Œä»–ä¼šå‘é™¤äº†ä½ ç»™çš„æ–¹å‘çš„å…¶ä»–æ–¹å‘ç§»åŠ¨ï¼Œå¦‚æœæ— æ³•ç§»åŠ¨ä»–å°†åŸåœ°ä¸åŠ¨ï¼Œé—®ä½ èƒ½å¦é€šè¿‡ä¸€äº›æŒ‡ä»¤ï¼Œä½¿ä»–åˆ°è¾¾ç»ˆç‚¹ã€‚æŠŠæ»¡è¶³çš„èµ·ç‚¹æ ‡ä½â€™+â€˜  ï¼Œå†æŠŠå›¾è¾“å‡º</p>
<p><strong>æ€è·¯</strong><br>é¦–å…ˆæ»¡è¶³çš„ç©ºåœ°æ˜¯ä¸€ä¸ªè”é€šå—ã€‚æˆ‘ä»¬åªéœ€è¦ä»ç»ˆç‚¹å¼€å§‹BFSå³å¯ã€‚å¦‚æœä¸€ä¸ªç‚¹å¯ä»¥èµ°çš„æ–¹å‘å°äºç­‰äº1ä¸ªï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶ä»–çš„èµ°å‘äº†ï¼Œå…·ä½“çœ‹ä»£ç ã€‚</p>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IOS ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CN puts(<span class="meta-string">&quot;NO&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CY puts(<span class="meta-string">&quot;YES&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> fact[maxn], infact[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">jie_init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,n) fact[i] = fact[i<span class="number">-1</span>] * i % mod;	</span><br><span class="line">	infact[n] = <span class="built_in">qmi</span>(fact[n],mod<span class="number">-2</span>,mod);</span><br><span class="line">	<span class="built_in">per</span>(i,n<span class="number">-1</span>,<span class="number">0</span>) infact[i] = infact[i+<span class="number">1</span>] * (i+<span class="number">1</span>) % mod;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;<span class="keyword">return</span> fact[n] * infact[m] % mod * infact[n-m] % mod;&#125;</span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"></span><br><span class="line">string g[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; g[i], g[i] = <span class="string">&#x27; &#x27;</span> + g[i];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> xx,yy;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N)</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">1</span>,M)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(g[i][j]==<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				xx = i;</span><br><span class="line">				yy = j;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	map&lt;PII,<span class="keyword">int</span>&gt; st;</span><br><span class="line">	queue&lt;PII&gt; q;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">mk</span>(xx,yy));</span><br><span class="line">	st[<span class="built_in">mk</span>(xx,yy)] = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">size</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		PII t = q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		xx = t.fi, yy = t.se;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="number">3</span>)<span class="comment">//æšä¸¾å‘¨å›´çš„ç‚¹</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> tx = xx + dx[i];</span><br><span class="line">			<span class="keyword">int</span> ty = yy + dy[i];</span><br><span class="line">			<span class="keyword">if</span>(tx &gt; N || tx &lt; <span class="number">1</span> || ty &lt; <span class="number">1</span> || ty &gt; M) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(g[tx][ty] == <span class="string">&#x27;#&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">int</span> dir = <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,<span class="number">3</span>)<span class="comment">//åˆ¤æ–­è¿™ä¸ªç‚¹ç¬¦ä¸ç¬¦åˆ</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> ttx = tx + dx[j];</span><br><span class="line">				<span class="keyword">int</span> tty = ty + dy[j];</span><br><span class="line">				<span class="comment">//ä¸èƒ½èµ°çš„ç‚¹å’Œå·²ç»ç¡®è®¤æˆåŠŸçš„ç‚¹éƒ½continueæ‰</span></span><br><span class="line">				<span class="keyword">if</span>(ttx &gt; N || ttx &lt; <span class="number">1</span> || tty &lt; <span class="number">1</span> || tty &gt; M) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span>(g[ttx][tty] == <span class="string">&#x27;#&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span>(st[<span class="built_in">mk</span>(ttx,tty)]) <span class="keyword">continue</span>;</span><br><span class="line">				dir ++;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(dir &lt;= <span class="number">1</span> &amp;&amp; !st[<span class="built_in">mk</span>(tx,ty)])&#123;<span class="comment">//ä¸ç¡®è®¤çš„æ–¹å‘åªæœ‰ä¸€ä¸ªï¼Œå¯ä»¥ç”¨æŒ‡ä»¤æ’é™¤æ‰</span></span><br><span class="line">				<span class="comment">// cout &lt;&lt; tx &lt;&lt; &quot;tx---ty&quot; &lt;&lt; ty &lt;&lt;endl;</span></span><br><span class="line">				q.<span class="built_in">push</span>(<span class="built_in">mk</span>(tx,ty));</span><br><span class="line">				st[<span class="built_in">mk</span>(tx,ty)] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">1</span>,M)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(st[<span class="built_in">mk</span>(i,j)] &amp;&amp; g[i][j] == <span class="string">&#x27;.&#x27;</span>) cout &lt;&lt; <span class="string">&#x27;+&#x27;</span>;</span><br><span class="line">			<span class="keyword">else</span> cout &lt;&lt; g[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IOS</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>codeforces</category>
      </categories>
  </entry>
  <entry>
    <title>P1002  [FJOI2007]è½®çŠ¶ç—…æ¯’</title>
    <url>/2022/02/21/P1002%20%20%5BFJOI2007%5D%E8%BD%AE%E7%8A%B6%E7%97%85%E6%AF%92/</url>
    <content><![CDATA[<h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ ä¸€å¼ å›¾ï¼Œæ±‚å®ƒç”Ÿæˆæ ‘çš„ä¸ªæ•°ã€‚</p>
<h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p>åŸºå°”éœå¤«çŸ©é˜µæ ‘å®šç†ï¼Œç”¨äºè§£å†³æ— å‘å›¾ç”Ÿæˆæ ‘ä¸ªæ•°çš„é—®é¢˜</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>é¢˜ç›®åªç»™äº†Nï¼Œä½†æ˜¯é¢˜ç›®çš„å›¾æ˜¯ç‰¹æ®Šçš„ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®Næ„é€ å‡ºæ¥ã€‚ç­‰ä»·äºç»™äº†ä¸€å¼ å®Œæ•´çš„æ— å‘å›¾ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡çŸ©é˜µæ ‘å®šç†æ±‚è§£äº†ã€‚<br>é«˜æ–¯æ¶ˆå…ƒå¤æ‚åº¦è¾ƒé«˜ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°é€’æ¨å¼a[i]=a[i-1]*3-a[i-2]+2ï¼Œå…·ä½“æ¨ç†çœ‹<a href="https://www.cnblogs.com/Parry-PY/p/7731858.html">å¤§ä½¬</a></p>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// #define int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BigInt</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> maxdigit=<span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> len,d[<span class="number">100</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clean</span><span class="params">()</span></span>&#123;<span class="keyword">while</span>(len&gt;<span class="number">1</span> &amp;&amp; !d[len<span class="number">-1</span>]) len--;&#125;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">()</span><span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        string s;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++) s+=d[len<span class="number">-1</span>-i]+<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">BigInt</span>()&#123;<span class="built_in">memset</span>(d,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(d));len=<span class="number">1</span>;&#125;</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="keyword">int</span> num)&#123;*<span class="keyword">this</span>=num;&#125;</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="keyword">char</span>* num)&#123;*<span class="keyword">this</span>=num;&#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(len!=oth.len) <span class="keyword">return</span> len&lt;oth.len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=len<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) <span class="keyword">if</span>(d[i]!=oth.d[i]) <span class="keyword">return</span> d[i]&lt;oth.d[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span>&#123;<span class="keyword">return</span> oth&lt;*<span class="keyword">this</span>;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;=(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span>&#123;<span class="keyword">return</span> !(oth&lt;*<span class="keyword">this</span>);&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;=(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span>&#123;<span class="keyword">return</span> !(*<span class="keyword">this</span>&lt;oth);&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span>&#123;<span class="keyword">return</span> oth&lt;*<span class="keyword">this</span> || *<span class="keyword">this</span>&lt;oth;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span>&#123;<span class="keyword">return</span> !(oth&lt;*<span class="keyword">this</span>) &amp;&amp; !(*<span class="keyword">this</span>&lt;oth);&#125;</span><br><span class="line"> </span><br><span class="line">    BigInt <span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="keyword">char</span>* num)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(d,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(d));</span><br><span class="line">        len=<span class="built_in">strlen</span>(num);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++) d[i]=num[len<span class="number">-1</span>-i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>=(<span class="keyword">int</span> num)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> s[<span class="number">20</span>];</span><br><span class="line">        <span class="built_in">sprintf</span>(s,<span class="string">&quot;%d&quot;</span>,num);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>=s;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>+(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        BigInt c;</span><br><span class="line">        c.len=<span class="built_in">max</span>(len,oth.len);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=c.len;i++) c.d[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;c.len;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            c.d[i]+=(i&lt;len?d[i]:<span class="number">0</span>)+(i&lt;oth.len?oth.d[i]:<span class="number">0</span>);</span><br><span class="line">            c.d[i+<span class="number">1</span>]+=c.d[i]/<span class="number">10</span>;</span><br><span class="line">            c.d[i]%=<span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        c.len+=(c.d[c.len]&gt;<span class="number">0</span>);</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>-(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        BigInt c=*<span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">if</span>(c&lt;oth) <span class="built_in">printf</span>(<span class="string">&quot;Produce negative number!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;oth.len;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            c.d[i]-=oth.d[i];</span><br><span class="line">            <span class="keyword">if</span>(c.d[i]&lt;<span class="number">0</span>) c.d[i]+=<span class="number">10</span>, c.d[i+<span class="number">1</span>]--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(c.d[i]&lt;<span class="number">0</span>) c.d[i++]+=<span class="number">10</span>, c.d[i]--;</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>*(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        BigInt c;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++) <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;oth.len;j++) c.d[i+j]+=d[i]*oth.d[j];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len+oth.len || !c.d[i];c.len=++i) c.d[i+<span class="number">1</span>]+=c.d[i]/<span class="number">10</span>, c.d[i]%=<span class="number">10</span>;</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>/(<span class="keyword">const</span> BigInt&amp; oth)<span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        BigInt c=*<span class="keyword">this</span>, r=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            r=r*<span class="number">10</span>+c.d[len<span class="number">-1</span>-i];</span><br><span class="line">            <span class="keyword">int</span> j;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">10</span>;j++) <span class="keyword">if</span>(r&lt;oth*(j+<span class="number">1</span>)) <span class="keyword">break</span>;</span><br><span class="line">            c.d[len<span class="number">-1</span>-i]=j;</span><br><span class="line">            r=r-oth*j;</span><br><span class="line">        &#125;</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>%(<span class="keyword">const</span> BigInt&amp; oth)</span><br><span class="line">    &#123;</span><br><span class="line">        BigInt r=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            r=r*<span class="number">10</span>+d[len<span class="number">-1</span>-i];</span><br><span class="line">            <span class="keyword">int</span> j;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">10</span>;j++) <span class="keyword">if</span>(r&lt;oth*(j+<span class="number">1</span>)) <span class="keyword">break</span>;</span><br><span class="line">            r=r-oth*j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>+=(<span class="keyword">const</span> BigInt&amp; oth)</span><br><span class="line">    &#123;</span><br><span class="line">        *<span class="keyword">this</span>=*<span class="keyword">this</span>+oth;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>*=(<span class="keyword">const</span> BigInt&amp; oth)</span><br><span class="line">    &#123;</span><br><span class="line">        *<span class="keyword">this</span>=*<span class="keyword">this</span>*oth;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>-=(<span class="keyword">const</span> BigInt&amp; oth)</span><br><span class="line">    &#123;</span><br><span class="line">        *<span class="keyword">this</span>=*<span class="keyword">this</span>-oth;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>/=(<span class="keyword">const</span> BigInt&amp; oth)</span><br><span class="line">    &#123;</span><br><span class="line">        *<span class="keyword">this</span>=*<span class="keyword">this</span>/oth;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">istream&amp; <span class="keyword">operator</span>&gt;&gt;(istream&amp; in, BigInt&amp; x)</span><br><span class="line">&#123;</span><br><span class="line">    string s;</span><br><span class="line">    in&gt;&gt;s;</span><br><span class="line">    x=s.<span class="built_in">c_str</span>();</span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream&amp; out,<span class="keyword">const</span> BigInt&amp; x)</span><br><span class="line">&#123;</span><br><span class="line">    out&lt;&lt;x.<span class="built_in">str</span>();</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line">BigInt f[<span class="number">101</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	</span><br><span class="line">	f[<span class="number">1</span>] = <span class="number">1</span>, f[<span class="number">2</span>] = <span class="number">5</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=N;i++) f[i]=(f[i<span class="number">-1</span>]*<span class="number">3</span>-f[i<span class="number">-2</span>]+<span class="number">2</span>);</span><br><span class="line">    cout&lt;&lt;f[N]&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>bzoj</category>
      </categories>
  </entry>
  <entry>
    <title>codeforces 746</title>
    <url>/2021/10/04/codeforces-746/</url>
    <content><![CDATA[<h3 id="A-Gamer-Hemose"><a href="#A-Gamer-Hemose" class="headerlink" title="A. Gamer Hemose"></a>A. Gamer Hemose</h3><p><strong>é¢˜æ„ï¼š</strong>ä½ æœ‰nä¸ªå£«å…µï¼Œæ”»å‡»åŠ›æ˜¯aiï¼Œæ¯ä¸ªå£«å…µæ”»å‡»æ¬¡æ•°ä¸é™ä½†ä¸èƒ½è¿ç»­æ”»å‡»ï¼Œæœ€å°‘å‡ æ¬¡èƒ½æŠŠè¡€é‡ä¸ºHçš„æ€ªç‰©æ€æ­»ã€‚</p>
<p><strong>æ€è·¯ï¼š</strong>ç”±äºä¸èƒ½è¿ç»­æ”»å‡»ï¼Œæˆ‘ä»¬è®©æ”»å‡»åŠ›æœ€å¤§å’Œç¬¬äºŒå¤§çš„å£«å…µè½®æµæ”»å‡»å°±å¥½äº†ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">		<span class="comment">// int mmax = 0;</span></span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N) &#123;</span><br><span class="line">			cin &gt;&gt; A[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(A+<span class="number">1</span>,A+<span class="number">1</span>+N);</span><br><span class="line">		<span class="keyword">int</span> X = A[N]+A[N<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">int</span> ans = M/X*<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(M%X)&#123;</span><br><span class="line">			<span class="keyword">if</span>((M%X)&gt;A[N]) ans+=<span class="number">2</span>;</span><br><span class="line">			<span class="keyword">else</span> ans++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">wtl</span>(ans);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p></p>
<hr>
<h3 id="B-Hemose-Shopping"><a href="#B-Hemose-Shopping" class="headerlink" title="B. Hemose Shopping"></a>B. Hemose Shopping</h3><p><strong>é¢˜æ„ï¼š</strong>çœ‹èƒ½å¦å°†ç»™å®šæ•°ç»„æ’åºã€‚æ–¹æ³•ä¸ºäº¤æ¢ä¸‹æ ‡å·®å¤§äºç­‰äºXçš„ä¸¤ä¸ªå…ƒç´ ã€‚</p>
<p><strong>æ€è·¯ï¼š</strong>è‹¥è¯¥ä½ç½®å¯ä»¥äº¤æ¢ï¼Œåˆ™è¯¥ä½ç½®ä¸Šçš„å…ƒç´ ä¸€å®šå¯ä»¥æ¢åˆ°å¯¹åº”ä½ç½®ï¼›è‹¥è¯¥ä½ç½®æ— æ³•äº¤æ¢ï¼Œåˆ™æ£€æŸ¥è¯¥ä½ç½®ä¸Šçš„å…ƒç´ æ˜¯å¦åœ¨æ­£ç¡®ä½ç½®ï¼Œè‹¥ä¸åœ¨åˆ™å¦ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn];</span><br><span class="line"><span class="keyword">int</span> B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			cin &gt;&gt; A[i];</span><br><span class="line">      B[i] = A[i];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sort</span>(B+<span class="number">1</span>,B+<span class="number">1</span>+N);</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">      <span class="keyword">if</span>(A[i]==B[i]) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">if</span>(i<span class="number">-1</span>&lt;M&amp;&amp;N-i&lt;M) f = <span class="number">0</span>;<span class="comment">//ä¸èƒ½åŠ¨çš„ä½ç½®</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(f) <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<h3 id="C-Bakry-and-Partitioning"><a href="#C-Bakry-and-Partitioning" class="headerlink" title="C. Bakry and Partitioning"></a>C. Bakry and Partitioning</h3><p><strong>é¢˜æ„ï¼š</strong>ç»™ä½ ä¸€æ£µæ ‘å’Œå„ç‚¹çš„æƒå€¼ï¼Œç»™ä½ ä¸€ä¸ªKï¼Œé€šè¿‡å»è¾¹å°†è¿™æ£µæ ‘åˆ†æˆã€2ï¼ŒK-1ã€‘ä¸ªéƒ¨åˆ†ï¼Œå„éƒ¨åˆ†ç‚¹æƒå¼‚æˆ–å’Œç›¸ç­‰ã€‚</p>
<p><strong>æ€è·¯ï¼š</strong></p>
<ol>
<li><p>ä»kåˆ†ç±»è®¨è®ºï¼ˆK&gt;=2ï¼‰</p>
<ul>
<li>å½“Kç­‰äº2æ—¶åªèƒ½åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œåˆå› ä¸ºä¸¤éƒ¨åˆ†çš„å¼‚æˆ–å’Œç›¸ç­‰ï¼Œæ‰€ä»¥æ€»çš„å¼‚æˆ–å’Œä¸€å®šä¸º0ã€‚</li>
<li>å½“K&gt;=3æ—¶æˆ‘ä»¬æˆ‘ä»¬åˆ†æˆ3éƒ¨åˆ†ï¼Œå› ä¸ºä»»æ„ä¸¤ä¸ªç›¸åŒçš„å¯ä»¥åˆå¹¶æˆ0ï¼Œæˆ‘ä»¬åªè¦dfsæ‰¾åˆ°ä¸¤éƒ¨åˆ†å¼‚æˆ–å’Œåˆ†åˆ«ä¸ºå…¨éƒ¨çš„å¼‚æˆ–å’Œå³å¯ã€‚</li>
</ul>
</li>
<li><p>ä»å…¨éƒ¨å¼‚æˆ–å’Œxosumè®¨è®º</p>
<pre><code> - xosumç­‰äº0ï¼Œä»¥å®šä½YESï¼Œå› ä¸ºä¸€å®šå¯ä»¥åˆ†æˆä¸¤éƒ¨åˆ†ç›¸åŒçš„ã€‚
 - xosumä¸ç­‰äº0åˆ™è¦æ±‚K!=2ï¼Œå› ä¸ºè‡³å°‘åˆ†æˆ3ä»½ï¼›è€Œä¸”dfsåŒæ ·è¦è‡³å°‘ä¸¤éƒ¨åˆ†å¼‚æˆ–å’Œé‚“å¼‚xosumã€‚
</code></pre></li>
</ol>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="keyword">int</span> xosum = <span class="number">0</span>,cnt;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i];</span><br><span class="line">		<span class="keyword">if</span>(to==fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(to,u);</span><br><span class="line">		A[u]^=A[to];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(A[u]==xosum)&#123;</span><br><span class="line">		A[u] = <span class="number">0</span>;</span><br><span class="line">		cnt++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	iocin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		iocin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">		xosum = <span class="number">0</span>;</span><br><span class="line">		cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			iocin &gt;&gt; A[i];</span><br><span class="line">			xosum^=A[i];</span><br><span class="line">			G[i].<span class="built_in">clear</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N<span class="number">-1</span>)&#123;</span><br><span class="line">			<span class="keyword">int</span> u,v;</span><br><span class="line">			iocin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			G[u].<span class="built_in">pb</span>(v);</span><br><span class="line">			G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(xosum==<span class="number">0</span>)&#123; </span><br><span class="line">		    <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">		    <span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">if</span>(M&gt;=<span class="number">3</span>&amp;&amp;cnt&gt;=<span class="number">2</span>) <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
]]></content>
  </entry>
  <entry>
    <title>namomo week1</title>
    <url>/2022/02/28/namomo%20week1/</url>
    <content><![CDATA[<h1 id="é¢˜å•"><a href="#é¢˜å•" class="headerlink" title="é¢˜å•"></a><a href="https://vjudge.net/contest/483210">é¢˜å•</a></h1><h1 id="A-Crystalfly"><a href="#A-Crystalfly" class="headerlink" title="A - Crystalfly"></a>A - Crystalfly</h1><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a><strong>é¢˜æ„</strong></h3><p>ç»™ä½ ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹ä¸Šæœ‰a[i]ä¸ªè´è¶ï¼Œå½“ä½ èµ°åˆ°uç‚¹ï¼Œä¸uç›¸é‚»çš„vçš„è´è¶ä¼šåœ¨t[v]ç§’ä¹‹åè¢«æƒŠåŠ¨é€ƒèµ°ï¼ˆä½†æ˜¯vçš„å„¿å­ä¸ä¼šè¢«æƒŠåŠ¨ï¼‰ï¼Œé—®ä½ æœ€å¤šèƒ½æŠ“åˆ°å‡ åªè´è¶ã€‚</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h3><p>å¯ä»¥æ³¨æ„åˆ°tæ•°ç»„çš„èŒƒå›´æ˜¯1&lt;= t &lt;= 3ï¼Œæˆ‘ä»¬è·Ÿæ®tæŠŠuçš„å„¿å­åˆ†ä¸ºä¸‰ç±»ã€‚ç¬¬ä¸€ç§’å¯ä»¥é€‰ä¸‰ç±»ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œç¬¬äºŒç§’å¯ä»¥é€‰æ‹©ç»§ç»­èµ°ç¬¬ä¸€ç§’é€‰æ‹©çš„å„¿å­ï¼Œæˆ–è€…æ˜¯å›åˆ°uï¼Œä½†æ˜¯æ­¤æ—¶ç¬¬ä¸‰ç§’åªèƒ½èµ°t=3çš„é‚£ä¸ªå„¿å­äº†ï¼ˆä¸€æ¥ä¸€å›è¿‡å»äº†2ç§’ï¼Œtå°äº3çš„è´è¶éƒ½è¢«æƒŠåŠ¨é£èµ°äº†,è€Œå¾€ç¬¬ä¸€ç§’é€‰æ‹©çš„å„¿å­èµ°æ˜¾ç„¶ä¸æ˜¯æœ€ä¼˜ï¼‰ã€‚<br>è¿™ä¸¤ç±»è¡Œèµ°æ–¹æ¡ˆå¦‚ä¸‹<br><img src="/upload/2022/02/image-a2f2948ff89345e8a3e1429c4135acb8.png" alt="image.png"><br><img src="/upload/2022/02/image-5b2d036624f841cc9af43222cd206d8b.png" alt="image.png"></p>
<p>æˆ‘ä»¬å…ˆä¸ç®¡æ ¹ç»“ç‚¹uæŠ“ä¸æŠ“å¾—åˆ°<br>å®šä¹‰</p>
<ul>
<li>dp[i][0]ä»£è¡¨iä¸é€‰å¹¶ä¸”æ‰€æœ‰å„¿å­å·²ç»ä¸èƒ½å†æŠ“äº†çš„æœ€å¤§å€¼ï¼ˆå°±æ˜¯ä¸¤ç§è·¯çº¿å–æœ€å¤§å€¼ï¼‰</li>
<li>dp[i][1]ä»£è¡¨ié€‰å¹¶ä¸”æ‰€æœ‰å„¿å­å·²ç»ä¸èƒ½å†æŠ“äº†çš„æœ€å¤§å€¼</li>
<li>dp[i][2]ä»£è¡¨iä¸é€‰å¹¶ä¸”æ‰€æœ‰å„¿å­éƒ½ä¸é€‰ä¸”å·²ç»ä¸èƒ½å†æŠ“äº†çš„æœ€å¤§å€¼</li>
</ul>
<ol>
<li>ç¬¬ä¸€å¼ å›¾<ul>
<li>æˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€ä¸ªå„¿å­ï¼Œå…¶ä»–å„¿å­éƒ½ä¸é€‰ï¼Œæ‰€ä»¥dp[u][0] = sum{dp[son][0]} åŠ ä¸Šaæœ€å¤§çš„ä¸€ä¸ªå„¿å­</li>
<li>dp[u][2]ç›¸æ¯”äºæ­¤æ—¶çš„dp[u][0]å·®åˆ«åœ¨äºå°‘åŠ ä¸€ä¸ªaæœ€å¤§çš„å„¿å­</li>
</ul>
</li>
<li>ç¬¬äºŒå¼ å›¾<ul>
<li>æˆ‘ä»¬æšä¸¾é‚£äº›å¯ä»¥äºŒæ¬¡æ‹¯æ•‘çš„ç‚¹ï¼ˆå³t=3çš„ç‚¹ï¼‰ï¼Œå‡è®¾æ‰€æœ‰ç‚¹çš„è´¡çŒ®éƒ½æ˜¯dp[i][0],å°±æ˜¯sum{dp[son][0]}ï¼Œå°±æ˜¯dp[u][2]ï¼Œç„¶åæ‹¯æ•‘çš„ç‚¹ï¼ˆç¬¬ä¸‰æ­¥èµ°çš„ç‚¹ï¼‰jçš„a[j]å¯ä»¥åŠ ä¸Šã€‚å¯¹äºæ¯ä¸ªç‚¹vå˜æˆç¬¬ä¸€æ­¥èµ°çš„ç‚¹è´¡çŒ®å˜åŒ–æ˜¯a[v] + dp[v][2] - dp[v][0]ï¼Œæ˜¾ç„¶æˆ‘ä»¬è¦é€‰å˜åŒ–æœ€å¤§çš„ç‚¹èµ°ç¬¬ä¸€æ­¥ï¼Œä½†æ˜¯è¿™ä¸ªç‚¹å¯èƒ½å’Œæˆ‘ä»¬æšä¸¾çš„æ‹¯æ•‘çš„ç‚¹æ˜¯åŒä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®°å½•å˜åŒ–å‰äºŒå¤§çš„ç‚¹(åˆ¤æ–­ç‚¹æ˜¯å¦æ˜¯åŒä¸€ä¸ªç‚¹ï¼Œæ‰€ä»¥è¿˜è¦è®°å½•ç‚¹çš„ç¼–å·)ã€‚</li>
<li>ç”±æ­¤dp[u][0] = max(dp[u][0],dp[u][2] + a[j] + (c[0].second == j ? c[1].first : c[0].first))</li>
</ul>
</li>
</ol>
<p>æœ€ådp[u][1] = dp[u][0] + a[u]</p>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a><strong>ä»£ç </strong></h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="keyword">int</span> e[maxn],w[maxn],ne[maxn],h[maxn],idx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(maxn)</span>,<span class="title">t</span><span class="params">(maxn)</span></span>;</span><br><span class="line">vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(<span class="number">3</span>,vector&lt;<span class="keyword">int</span>&gt;(maxn));</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	dp[<span class="number">0</span>][u] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> max_son = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> son_num = <span class="number">0</span>;</span><br><span class="line">	vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; c = &#123;<span class="built_in">make_pair</span>(<span class="number">-1e18</span>,<span class="number">0ll</span>), <span class="built_in">make_pair</span>(<span class="number">-1e18</span>,<span class="number">0ll</span>),<span class="built_in">make_pair</span>(<span class="number">-1e18</span>,<span class="number">0ll</span>)&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = h[u]; ~i; i = ne[i]) &#123;</span><br><span class="line">		<span class="keyword">int</span> j = e[i];</span><br><span class="line">		<span class="keyword">if</span> (j == fa) <span class="keyword">continue</span>;</span><br><span class="line">		son_num++;</span><br><span class="line">		<span class="built_in">dfs</span>(j, u);</span><br><span class="line">		max_son = <span class="built_in">max</span>(max_son, a[j]);</span><br><span class="line">		dp[<span class="number">0</span>][u] += dp[<span class="number">0</span>][j];</span><br><span class="line">		c[<span class="number">2</span>] = <span class="built_in">make_pair</span>(a[j] + dp[<span class="number">2</span>][j] - dp[<span class="number">0</span>][j],j);</span><br><span class="line">		<span class="built_in">sort</span>(c.<span class="built_in">begin</span>(),c.<span class="built_in">end</span>(),[&amp;](pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; aa, pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; bb) &#123;</span><br><span class="line">			<span class="keyword">if</span> (aa.first != bb.first) &#123;</span><br><span class="line">				<span class="keyword">return</span> aa.first &gt; bb.first;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> aa.second &lt; bb.second;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> temp = dp[<span class="number">0</span>][u];</span><br><span class="line">	dp[<span class="number">2</span>][u] = dp[<span class="number">0</span>][u];</span><br><span class="line">	dp[<span class="number">0</span>][u] = dp[<span class="number">0</span>][u] + max_son;<span class="comment">//æ‰¾ä¸ªæœ€å¤§å„¿å­è¿›ï¼Œå…¶ä»–å¿æ‘†çƒ‚</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// if (son_num &gt; 1) &#123;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = h[u]; ~i; i = ne[i]) &#123;</span><br><span class="line">		<span class="keyword">int</span> j = e[i];</span><br><span class="line">		<span class="keyword">if</span> (j == fa || t[j] != <span class="number">3</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="comment">//å›é¦–å¥—çš„ç‚¹</span></span><br><span class="line">		dp[<span class="number">0</span>][u] = <span class="built_in">max</span>(dp[<span class="number">0</span>][u], temp + a[j] + (c[<span class="number">0</span>].second == j ? c[<span class="number">1</span>].first : c[<span class="number">0</span>].first));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	</span><br><span class="line">	dp[<span class="number">1</span>][u] = dp[<span class="number">0</span>][u] + a[u];</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	idx = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*(N+<span class="number">10</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; t[i];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		<span class="built_in">add</span>(u, v);</span><br><span class="line">		<span class="built_in">add</span>(v, u);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">	cout &lt;&lt; dp[<span class="number">1</span>][<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="B-Towers"><a href="#B-Towers" class="headerlink" title="B - Towers"></a>B - Towers</h1><h3 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a><strong>é¢˜æ„</strong></h3><p>ç»™ä½ ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹çš„æƒå€¼ä¸ºa[i]ï¼Œç°åœ¨è¦æ±‚ä½ ç»™æ¯ä¸ªç‚¹çš„e[i]èµ‹å€¼ï¼Œä½¿å¾—<strong>æ¯ä¸ªç‚¹</strong>éƒ½å­˜åœ¨ä¸¤ä¸ªç‚¹uï¼Œvï¼Œè¿™ä¸ªç‚¹åœ¨uï¼Œvçš„ç®€å•è·¯å¾„ä¸Šï¼Œä¸”e[u]&gt;=a[i]ä¸”e[v]&gt;=a[i]ã€‚æ±‚æ‰€æœ‰e[i]çš„å’Œï¼ˆe[i] &gt;= 0ï¼‰</p>
<h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h3><p>æˆ‘ä»¬é¦–å…ˆæ‰¾åˆ°æƒå€¼æœ€å¤§çš„ç‚¹rootï¼Œä»¥å®ƒä¸ºæ ¹ã€‚å› ä¸ºæ ¹æœ€å¤§ï¼Œè‚¯å®šæœ‰ä¸¤ä¸ªç‚¹çš„eæ˜¯a[root]æ˜¯ä¸“é—¨ç”¨æ¥æ»¡è¶³rootçš„ã€‚è¿™æ ·å¯¹äºé™¤äº†æ ¹ä»¥å¤–çš„æ‰€æœ‰ç‚¹iéƒ½å¯ä»¥ä»ä¸Šè¿°ä¸¤ä¸ªç‚¹å…¶ä¸­ä¸€ä¸ªåˆ°æ ¹å†åˆ°iï¼Œè¿™æ ·æ¥è·å¾—uï¼Œvçš„å…¶ä¸­ä¸€ä¸ªã€‚è€Œå¦ä¸€ä¸ªä¸€å®šæ˜¯åœ¨içš„å­æ ‘å½“ä¸­(åŒ…æ‹¬iæœ¬èº«)ã€‚å¦‚æœå­æ ‘çš„æœ€å¤§å€¼å¤§äºç­‰äºa[i]äº†ï¼Œé‚£ä¹ˆe[i]=0,ä¸éœ€è¦é¢å¤–å¼€é”€ï¼›å¦‚æœå­æ ‘çš„æœ€å¤§å€¼å°äºa[i],æˆ‘ä»¬åˆ™éœ€è¦æŠŠæœ€å¤§å€¼è¡¥æˆa[i]ï¼Œå¼€é”€æ˜¯a[i]-maxã€‚</p>
<p>å› ä¸ºè¦å…ˆçŸ¥é“å­æ ‘ä¸­çš„æœ€å¤§å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆé€’å½’åˆ°å¶å­ç»“ç‚¹ï¼Œåœ¨å›æº¯æ—¶ä»ä¸‹å¾€ä¸Šå¤„ç†ã€‚</p>
<p>å½“å›æº¯åˆ°æ ¹çš„æ—¶å€™ï¼Œå› ä¸ºæˆ‘ä»¬ä¸€å¼€å§‹æ˜¯è®¾äº†ä¸¤ä¸ªç‚¹çš„eç­‰äºa[root]çš„ï¼Œä»–ä»¬åº”è¯¥åœ¨rootä¸åŒçš„å„¿å­é‡Œï¼Œè¦ä¸ç„¶å°±ä¸æ˜¯ç®€å•è·¯å¾„äº†ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠrootçš„æ¯ä¸ªå„¿å­çš„å­æ ‘çš„æœ€å¤§å€¼å­˜èµ·æ¥ï¼Œå–å‰ä¸¤ä¸ªå¤§çš„è¡¥æˆa[root]ã€‚</p>
<p>ä½†æ˜¯rootå¯èƒ½åªæœ‰ä¸€ä¸ªå„¿å­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠe[root]è®¾ä¸ºa[root]</p>
<h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a><strong>ä»£ç </strong></h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> e[maxn],w[maxn],ne[maxn],h[maxn],idx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> root = <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(maxn)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> mx = <span class="number">0</span>;</span><br><span class="line">	vector&lt;<span class="keyword">int</span>&gt; mmax;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = h[u]; ~i; i = ne[i]) &#123;</span><br><span class="line">		<span class="keyword">int</span> j = e[i];</span><br><span class="line">		<span class="keyword">if</span> (j == fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">int</span> t = <span class="built_in">dfs</span>(j, u);</span><br><span class="line">		mx = <span class="built_in">max</span>(mx, t);</span><br><span class="line">		<span class="keyword">if</span> (u == root) &#123;</span><br><span class="line">			mmax.<span class="built_in">push_back</span>(-t);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (u == root) &#123;</span><br><span class="line">		<span class="built_in">sort</span>(mmax.<span class="built_in">begin</span>(),mmax.<span class="built_in">end</span>());</span><br><span class="line">		ans += <span class="built_in">max</span>(<span class="number">0ll</span>,a[root] + mmax[<span class="number">0</span>]);</span><br><span class="line">		<span class="keyword">if</span> (mmax.<span class="built_in">size</span>() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">			ans += a[root];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> ans += <span class="built_in">max</span>(<span class="number">0ll</span>,a[root] + mmax[<span class="number">1</span>]);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (mx &lt; a[u]) &#123;</span><br><span class="line">		ans += a[u] - mx;</span><br><span class="line">		mx = a[u];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*(N+<span class="number">10</span>));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		<span class="built_in">add</span>(u, v);</span><br><span class="line">		<span class="built_in">add</span>(v, u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[i] &gt; a[root]) &#123;</span><br><span class="line">			root = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">dfs</span>(root,<span class="number">-1</span>);	</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="C-Werewolves"><a href="#C-Werewolves" class="headerlink" title="C - Werewolves"></a>C - Werewolves</h1><h3 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a><strong>é¢˜æ„</strong></h3><p>ç»™ä½ ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªé¢œè‰²ï¼Œé—®ä½ æŸç§é¢œè‰²æ•°é‡<strong>ä¸¥æ ¼å¤§äºè”é€šå—å¤§å°ä¸€åŠ</strong>çš„è”é€šå—æ•°é‡ã€‚</p>
<h3 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h3><ul>
<li>æ•°é‡ä¸¥æ ¼å¤§äºå¤§å°çš„ä¸€åŠï¼Œè¯´æ˜æ¯ä¸ªåˆæ³•çš„è”é€šå—éƒ½å¯¹åº”ç€ä¸€ä¸ªé¢œè‰²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æšä¸¾é¢œè‰²ï¼ŒæŠŠæ¯ç§é¢œè‰²çš„åˆæ³•è”é€šå—ç´¯åŠ èµ·æ¥å°±æ˜¯æ€»çš„ç­”æ¡ˆã€‚</li>
<li>å¯¹äºä¸€ä¸ªé¢œè‰²colorï¼Œæˆ‘ä»¬æŠŠé¢œè‰²æ˜¯colorçš„æƒå€¼è®¾ä¸º1ï¼Œä¸åŒçš„è®¾ä¸º-1ï¼Œè¿™æ ·å°±æŠŠé—®é¢˜è½¬åŒ–ä¸ºæ€»çš„æƒå€¼å¤§äº0çš„è”é€šå—ä¸ªæ•°ï¼Œå°±æ˜¯ä¸€ä¸ªæ ‘ä¸ŠèƒŒåŒ…é—®é¢˜ã€‚</li>
<li>æ™®é€šçš„æ ‘ä¸ŠèƒŒåŒ…å¤æ‚åº¦æ˜¯O(N2),å†åŠ ä¸Šé¢œè‰²æ•°æœ€åæ˜¯O(N3)ã€‚ä½†æ˜¯æœ‰äº›çŠ¶æ€æˆ‘ä»¬æ˜¯ä¸éœ€è¦æšä¸¾çš„ï¼Œå°±æ˜¯æƒå€¼å’Œçš„èŒƒå›´æœ€å¤§æ˜¯[-cnt[color],cnt[color]]ï¼Œè¿™æ ·å¤æ‚åº¦åˆ†æ‘Šæ˜¯O(N2)</li>
<li>æƒå€¼æœ‰è´Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸Šä¸€ä¸ªåç§»å€¼base</li>
</ul>
<h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a><strong>ä»£ç </strong></h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; G[<span class="number">3030</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	G[a].<span class="built_in">push_back</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(<span class="number">3010</span>,vector&lt;<span class="keyword">int</span>&gt;(<span class="number">6010</span>));</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">3030</span>)</span>, <span class="title">siz</span><span class="params">(<span class="number">3007</span>)</span>, <span class="title">f</span><span class="params">(<span class="number">6060</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">num</span><span class="params">(<span class="number">3030</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> color;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> base = <span class="number">3005</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">	siz[u] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (color == a[u]) dp[u][base+<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> dp[u][base - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j : G[u]) &#123;</span><br><span class="line">		<span class="keyword">if</span> (j == fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(j, u);</span><br><span class="line">		<span class="keyword">int</span> bro1 = <span class="built_in">min</span>(siz[u], num[color]);<span class="comment">//ä¹‹å‰æšä¸¾è¿‡çš„å­æ ‘</span></span><br><span class="line">		<span class="keyword">int</span> bro2 = <span class="built_in">min</span>(siz[j], num[color]);<span class="comment">//å½“å‰å­æ ‘</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = -bro1; x &lt;= bro1; x ++) &#123;</span><br><span class="line">			f[x + base] = dp[u][x + base];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//å½“å‰å­æ ‘å’Œä¹‹å‰çš„å­æ ‘é…å¯¹ï¼ˆæ–¹æ¡ˆç›¸ä¹˜ï¼‰</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = -bro1; x &lt;= bro1; x ++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> y = -bro2; y &lt;= bro2; y ++) &#123;</span><br><span class="line">				(dp[u][x + y + base] += dp[j][y + base] * f[x + base]) %= mod;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		siz[u] += siz[j];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= num[color]; i ++) &#123;<span class="comment">//ç´¯åŠ é¢œè‰²ä¸ºcolorï¼Œç¥–å…ˆæ˜¯uçš„åˆæ³•è”é€šå—</span></span><br><span class="line">		(ans += dp[u][i + base]) %= mod;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i], num[a[i]] ++;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		<span class="built_in">add</span>(u, v);</span><br><span class="line">		<span class="built_in">add</span>(v, u);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (num[i] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="comment">//æ¸…ç©ºåˆå§‹åŒ–</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> u = <span class="number">1</span>; u &lt;= N; u ++ ) </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = -num[i]; j &lt;= num[i]; j ++)</span><br><span class="line">            	dp[u][j + base] = <span class="number">0</span>;</span><br><span class="line">		color = i;</span><br><span class="line">		<span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">	&#125;	</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="D-Paint"><a href="#D-Paint" class="headerlink" title="D - Paint"></a>D - Paint</h1><h3 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ Nä¸ªæ•°ï¼Œæ¯æ¬¡ä½ èƒ½é€‰æ‹©æ•°å€¼ç›¸åŒçš„ä¸€æ®µæŠŠå®ƒå˜æˆå¦å¤–ä¸€ä¸ªæ•°å€¼ï¼Œé—®æŠŠè¿™Nä¸ªæ•°å…¨éƒ¨å˜æˆä¸€ä¸ªé¢œè‰²éœ€è¦å¤šå°‘æ¬¡æ“ä½œã€‚</p>
<h3 id="æ€è·¯-3"><a href="#æ€è·¯-3" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>é¦–å…ˆæˆ‘ä»¬æŠŠåŸæ•°ç»„ç›¸é‚»çš„ç›¸åŒå…ƒç´ è¿›è¡Œå‹ç¼©ï¼Œå‹ç¼©åæœ‰Mä¸ªå…ƒç´ </p>
<p>é‚£ä¹ˆæˆ‘ä»¬æœ€å¤šåªéœ€è¦M-1æ¬¡æ“ä½œä¹‹åæ‰€æœ‰å…ƒç´ å€¼ç›¸åŒ</p>
<p>å¯¹äºabcå½“a=cï¼ˆä¸¤ç«¯ç›¸ç­‰ï¼‰æ—¶æˆ‘ä»¬å¯ä»¥å‡å°‘ä¸€æ¬¡æ“ä½œ</p>
<p>æˆ‘ä»¬å®šä¹‰dp[i][j]ä»£è¡¨åŒºé—´[i,j]æœ€å¤šå¯ä»¥å‡å°‘å‡ æ¬¡æ“ä½œï¼Œé‚£ä¹ˆæœ€åç­”æ¡ˆå°±æ˜¯M-1-dp[1][M]</p>
<p>è½¬ç§»æ–¹ç¨‹dp[i][j] = dp[i][j-1],dp[i][j] = max(dp[i][j], dp[i][k]+dp[k+1][j-1]+1),kæ»¡è¶³k&gt;=iï¼Œä¸”a[k]==a[j].å¯¹äºkç›´æ¥æšä¸¾åŒºé—´[i,j]ä¼šè¶…æ—¶ï¼Œé¢˜ç›®ä¿è¯æ¯ä¸ªæ•°æœ€å¤šå‡ºç°20æ¬¡ï¼Œæˆ‘ä»¬åªéœ€è¦é¢„å¤„ç†å‡ºä¸Šä¸€ä¸ªç­‰äºa[i]çš„ä½ç½®çš„pre[i]å°±èƒ½ä¿è¯kæœ€å¤šæšä¸¾20æ¬¡ï¼Œå¤æ‚åº¦ä¸º20<em>N</em>Nã€‚</p>
<h3 id="ä»£ç -3"><a href="#ä»£ç -3" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N + <span class="number">1</span>)</span>,<span class="title">nxt</span><span class="params">(N+<span class="number">1</span>)</span>, b</span>;</span><br><span class="line">	b.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">		<span class="keyword">if</span> (i &gt; <span class="number">1</span> &amp;&amp; a[i] != a[i<span class="number">-1</span>]) &#123;</span><br><span class="line">			b.<span class="built_in">push_back</span>(a[i<span class="number">-1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	b.<span class="built_in">push_back</span>(a[N]);</span><br><span class="line">	M = b.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">pre</span><span class="params">(N+<span class="number">10</span>)</span>, <span class="title">st</span><span class="params">(N+<span class="number">10</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!st[b[i]]) &#123;</span><br><span class="line">			pre[i] = <span class="number">0</span>;</span><br><span class="line">			st[b[i]] = i;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			pre[i] = st[b[i]];</span><br><span class="line">			st[b[i]] = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;<span class="built_in">dp</span>(N+<span class="number">1</span>,vector&lt;<span class="keyword">int</span>&gt;(N+<span class="number">1</span>));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">2</span>; len &lt;= M; len ++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + len - <span class="number">1</span> &lt;= M; i ++) &#123;</span><br><span class="line">			<span class="keyword">int</span> j = i + len - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (len == <span class="number">2</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (b[i] == b[j]) dp[i][j] = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">else</span> dp[i][j] = <span class="number">0</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				dp[i][j] = dp[i][j<span class="number">-1</span>];</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">int</span> x = pre[j];</span><br><span class="line">				<span class="keyword">while</span> (x &gt;= i) &#123;</span><br><span class="line">					dp[i][j] = <span class="built_in">max</span>(dp[i][j], dp[i][x] + dp[x + <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">					x = pre[x];</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; M - <span class="number">1</span> - dp[<span class="number">1</span>][M] &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="E-Outer-space-invaders"><a href="#E-Outer-space-invaders" class="headerlink" title="E - Outer space invaders"></a>E - Outer space invaders</h1><h3 id="æ€è·¯-4"><a href="#æ€è·¯-4" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>æœ‰Nä¸ªæ•Œäººï¼Œæ¯ä¸ªäººå‡ºç°çš„æ—¶é—´æ˜¯a[i]åˆ°b[i],å‡ºç°çš„ä½ç½®åœ¨d[i]ï¼Œä½ åªèƒ½åœ¨åŸç‚¹æ”¾ç½®ç‚¸å¼¹ï¼Œå¨åŠ›ä¸ºrçš„ç‚¸å¼¹éœ€è¦rèŠ±è´¹ï¼Œèƒ½ç‚¸åˆ°[-r,r]ï¼Œé—®æ¶ˆç­æ‰€æœ‰æ•Œäººçš„æœ€å°èŠ±è´¹ã€‚</p>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å¯¹äºæ¯ä¸ªæ•Œäººæˆ‘ä»¬å¯ä»¥è¡¨ç¤ºæˆä¸€ä¸ªå¹³è¡Œäºxè½´çš„çº¿æ®µï¼Œé«˜åº¦ä¸ºdï¼Œè¿™æ ·é¢˜ç›®å°±å˜æˆäº†æœ€å°‘éœ€è¦å¤šé•¿çš„ç«–ç›´çº¿æ®µï¼Œèƒ½ç©¿è¿‡æ‰€æœ‰çº¿æ®µã€‚<br><img src="/upload/2022/03/image-1a16ab2bb9ff440b8f87d5a6bcb0df14.png" alt="image.png"></p>
<ul>
<li>é¦–å…ˆï¼Œå¯¹äºæœ€é«˜çš„çº¿æ®µï¼Œå¿…ç„¶æœ‰ä¸€æ¡çº¢çº¿ç­‰äºå®ƒçš„é«˜åº¦æ¥æ¶ˆç­å®ƒï¼Œåœ¨æ¶ˆç­å®ƒçš„åŒæ—¶å¯ä»¥å€Ÿæœºæ¶ˆç­å…¶ä»–è¾ƒçŸ®çš„çº¿æ®µã€‚</li>
<li>dp[i][j]ä»£è¡¨æ¶ˆç­åŒºé—´[i,j]å†…çš„æ‰€æœ‰æ•Œäººæ‰€éœ€è¦æœ€å°èŠ±è´¹ã€‚</li>
<li>æˆ‘ä»¬æ‰¾åˆ°å½“å‰åŒºé—´çš„dæœ€å¤§çš„çº¿æ®µï¼Œç„¶åæšä¸¾çº¿æ®µä¸Šçš„æ¯ä¸€ç‚¹iï¼ŒæŠŠåŒºé—´åˆ†ä¸ºäº†ä¸¤éƒ¨åˆ†[l,i-1]å’Œ[i+1,r]ã€‚</li>
<li>å¦‚æœçº¿æ®µä¸æ˜¯çœŸåŒ…æ¶µäºå½“å‰åŒºé—´ï¼Œè¯´æ˜å®ƒè¢«æŸä¸ªåŒºé—´çš„åˆ†ç•Œçº¿éš”æ–­äº†ï¼Œè€ŒåŒºé—´çš„åˆ†ç•Œçº¿å°±æ˜¯æœ‰ç‚¸å¼¹çš„æ—¶åˆ»ã€‚</li>
<li>dp[l][r] = min(dp[l][i-1] + dp[i+1][r]) + d[i]</li>
</ul>
<h3 id="ä»£ç -4"><a href="#ä»£ç -4" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(maxn)</span>, <span class="title">b</span><span class="params">(maxn)</span>, <span class="title">d</span><span class="params">(maxn)</span></span>;</span><br><span class="line">vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(<span class="number">1010</span>,vector&lt;<span class="keyword">int</span>&gt;(<span class="number">1010</span>));</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (dp[l][r] != <span class="number">-1</span>) <span class="keyword">return</span> dp[l][r];</span><br><span class="line">	<span class="keyword">int</span> &amp;ans = dp[l][r];</span><br><span class="line">	ans = INF;</span><br><span class="line">	pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; mx = &#123;<span class="number">-1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[i] &gt;= l &amp;&amp; b[i] &lt;= r) &#123;</span><br><span class="line">			<span class="keyword">if</span> (d[i] &gt; mx.first) &#123;</span><br><span class="line">				mx = &#123;d[i], i&#125;;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (mx.first == <span class="number">-1</span>) <span class="keyword">return</span> ans = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = a[mx.second]; i &lt;= b[mx.second]; i ++) &#123;</span><br><span class="line">		ans = <span class="built_in">min</span>(ans, <span class="built_in">dfs</span>(l,i<span class="number">-1</span>) + <span class="built_in">dfs</span>(i+<span class="number">1</span>,r));</span><br><span class="line">	&#125;</span><br><span class="line">	ans += mx.first;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	vector&lt;<span class="keyword">int</span>&gt; v;	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i] &gt;&gt; b[i] &gt;&gt; d[i];</span><br><span class="line">		v.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">		v.<span class="built_in">push_back</span>(b[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">	v.<span class="built_in">erase</span>(<span class="built_in">unique</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>()),v.<span class="built_in">end</span>());</span><br><span class="line">	M = v.<span class="built_in">size</span>();</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		a[i] = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),a[i]) - v.<span class="built_in">begin</span>() + <span class="number">1</span>;</span><br><span class="line">		b[i] = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),b[i]) - v.<span class="built_in">begin</span>() + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line">			dp[i][j] = <span class="number">-1</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="built_in">dfs</span>(<span class="number">1</span>,M) &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomo camp</category>
      </categories>
  </entry>
  <entry>
    <title>namomo week2</title>
    <url>/2022/03/06/namomo%20week2/</url>
    <content><![CDATA[<h1 id="é¢˜å•"><a href="#é¢˜å•" class="headerlink" title="é¢˜å•"></a><a href="https://vjudge.net/contest/483210#overview">é¢˜å•</a></h1><h1 id="F-Infinite-Set"><a href="#F-Infinite-Set" class="headerlink" title="F - Infinite Set"></a>F - Infinite Set</h1><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ ä¸€äº›æ•°a[i]ï¼Œä½ å¯ä»¥å¾—åˆ°a[i]<em>2+1å’Œa[i]</em>4ï¼Œé—®èƒ½å¾—åˆ°å¤šå°‘ä¸ªå°äº2çš„pæ¬¡æ–¹çš„æ•°ã€‚</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ul>
<li>å¯¹äºä¸€ä¸ªæ•°å®ƒå¯èƒ½æ˜¯ç”±å¦ä¸€ä¸ªè¾ƒå°æ•°è½¬å˜è¿‡æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿™ä¸¤ä¸ªæ•°æ˜¯å¦èƒ½ç”±å¦ä¸€ä¸ªè½¬åŒ–è€Œæ¥ã€‚</li>
<li>æˆ‘ä»¬æ¥çœ‹ä¸¤ç§æ“ä½œçš„å˜åŒ–<ul>
<li>a[i]*2+1ï¼ŒäºŒè¿›åˆ¶æœ«å°¾åŠ ä¸ª1</li>
<li>a[i]*4ï¼ŒäºŒè¿›åˆ¶æœ«å°¾åŠ 2ä¸ª0</li>
</ul>
</li>
<li><p>æ ¹æ®æ“ä½œçš„å˜åŒ–æˆ‘ä»¬çœ‹å¤§çš„æ•°èƒ½å¦å›é€€åˆ°è¾ƒå°çš„a[i]ï¼Œå¦‚æœèƒ½å½“å‰æ•°ä¸æ’å…¥</p>
</li>
<li><p>2çš„pæ¬¡äºŒè¿›åˆ¶æ˜¯1åé¢pä¸ª0ï¼Œæ‰€ä»¥å°äºå®ƒçš„æ•° é•¿åº¦å°äºç­‰äºp</p>
</li>
</ul>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span> <span class="params">(N)</span></span>;</span><br><span class="line">	set&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">	<span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		<span class="comment">// cin &gt;&gt; a[i];</span></span><br><span class="line">		<span class="keyword">int</span> x = a[i];</span><br><span class="line">		<span class="keyword">int</span> f = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(a[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (s.<span class="built_in">count</span>(a[i])) &#123;</span><br><span class="line">				f = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (a[i] &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				a[i] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a[i] &amp; <span class="number">3</span>) &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				a[i] &gt;&gt;= <span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!f) &#123;</span><br><span class="line">			s.<span class="built_in">insert</span>(x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">cnt</span><span class="params">(<span class="number">30</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(max(M+<span class="number">1</span>,<span class="number">100ll</span>),<span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : s) &#123;</span><br><span class="line">		cnt[__lg(x)] ++;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i &lt; <span class="number">30</span>) dp[i] = cnt[i] % mod;</span><br><span class="line">		<span class="keyword">if</span> (i &gt; <span class="number">0</span>) (dp[i] += dp[i<span class="number">-1</span>])%=mod;</span><br><span class="line">		<span class="keyword">if</span> (i &gt; <span class="number">1</span>) (dp[i] += dp[i<span class="number">-2</span>])%=mod;</span><br><span class="line">		(ans += dp[i]) %= mod;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="G-Namomo-Subsequence"><a href="#G-Namomo-Subsequence" class="headerlink" title="G - Namomo Subsequence"></a>G - Namomo Subsequence</h1><h3 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé—®ä½ æœ‰å‡ ä¸ªå­åºåˆ—æ»¡è¶³namomoçš„å½¢å¼ã€‚<br>Næ˜¯<strong>1e6</strong></p>
<h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ul>
<li>æ˜¾ç„¶momoçš„é™åˆ¶æ›´å¼ºä¸€äº›ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“äº†momoçš„å­åºåˆ—ä¸ªæ•°åªè¦ä¹˜ä¸Šåé¢ä¸åŒäºmå’Œoçš„ä¸¤ä¸ªä¸åŒçš„å­—æ¯çš„ç»„åˆï¼ˆnï¼Œaï¼‰ä¸ªæ•°å³å¯ã€‚</li>
</ul>
<ol>
<li>å¯¹äºä¸¤ä¸ªå­—æ¯çš„ç»„åˆæœ‰å¤šå°‘ç§æœ‰ä¸ªã€Šåˆä¸­æ•°å­¦ã€‹å¯ä»¥Oï¼ˆ1ï¼‰æ±‚å¾—ã€‚<ul>
<li>è®°å‰©ä¸‹æ¯ä¸ªå­—æ¯içš„ä¸ªæ•°æ˜¯cnt[i]ï¼Œåˆ™ä¸åŒå­—æ¯çš„ç»„åˆæ•°æ˜¯ï¼ˆcnt[1] + cnt[2] + â€¦ + cnt[k]ï¼‰^ 2 - (cnt[1] ^ 2 + cnt[2] ^ 2 + .. + cnt[k] ^ 2) / 2ã€‚</li>
<li>nï¼Œaä¸èƒ½å’Œmï¼Œoç›¸åŒï¼Œè®¡ç®—æ—¶åªéœ€è¦æŠŠcnt[m]å’Œcnt[o]æœ‰å…³çš„å»æ‰å°±å¥½äº†ã€‚</li>
<li>ç»´æŠ¤sum1æ˜¯å‰©ä½™å­—æ¯ä¸ªæ•°ï¼Œsum2æ˜¯æ¯ä¸ªå­—æ¯ä¸ªæ•°å¹³æ–¹å’Œã€‚sum1æ¯æ¬¡å‡ä¸€ï¼Œsum2 - ï¼ˆcnt <em> cntï¼‰ + ((cnt - 1) </em> (cnt - 1))ï¼ŒåŒ–ç®€ä¹‹åå°±æ˜¯sum2 -= 2 * cnt - 1ã€‚ç®—å®Œsum2åå†æŠŠå½“å‰å­—æ¯çš„cntâ€”ã€‚</li>
</ul>
</li>
<li>æˆ‘ä»¬å¯ä»¥dpæ±‚å½¢å¦‚momoçš„å­åºåˆ—ä¸ªæ•°ã€‚<ul>
<li>å®šä¹‰dp[i][j][k]ä¸ºåŒ¹é…äº†momoçš„ç¬¬iä¸ªä½ç½®ï¼Œç¬¬iä¸ªä½ç½®æ˜¯kï¼Œå‰ä¸€ä¸ªæ˜¯jã€‚c[a]æ˜¯ç›®å‰ä¸ºæ­¢å­—ç¬¦aå‡ºç°çš„æ¬¡æ•°ã€‚</li>
<li>è½¬ç§»æ–¹ç¨‹<ul>
<li>dp[2][j][a[i]] += c[j]</li>
<li>dp[3][j][a[i]] += dp[2][a[i]][j]</li>
<li>c[a[i]] ++<br>-è®¡ç®—å½“å‰ä½ç½®ä½œä¸ºæœ€åä¸€ä½ï¼ˆç¬¬å››ä½ï¼‰çš„è´¡çŒ®ï¼Œnum_momo = dp[3][a[i]][j], num_na = ((sum1 - c[a[i]] - c[j]) <em> (sum1 - c[a[i]] - c[j]) - (sum2 - c[a[i]] </em> c[a[i]] - c[j] <em> c[j])) / 2 % modã€‚è´¡çŒ®ä¸ºnum_momo </em> num_naã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">char</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; s &lt;= <span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> (s - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (s &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; s &lt;= <span class="string">&#x27;Z&#x27;</span>) <span class="keyword">return</span> (s - <span class="string">&#x27;A&#x27;</span> + <span class="number">11</span>);</span><br><span class="line">    <span class="keyword">if</span> (s &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; s &lt;= <span class="string">&#x27;z&#x27;</span>) <span class="keyword">return</span> (s - <span class="string">&#x27;a&#x27;</span> + <span class="number">37</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">ll dp[<span class="number">10</span>][<span class="number">100</span>][<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> cnt[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string s;</span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    N = s.<span class="built_in">size</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        a[N - i - <span class="number">1</span>] = <span class="built_in">cal</span>(s[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ll sum1 = N, sum2 = <span class="number">0</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">c</span><span class="params">(<span class="number">100</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        c[a[i]] ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">63</span>; i ++) &#123;</span><br><span class="line">        sum2 += c[i] * c[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        sum1 --;</span><br><span class="line">        sum2 -= <span class="number">2</span> * c[a[i]] - <span class="number">1</span>;</span><br><span class="line">        c[a[i]] --;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">63</span>; j ++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j == a[i]) <span class="keyword">continue</span>;</span><br><span class="line">            (dp[<span class="number">2</span>][j][a[i]] += cnt[j]) %= mod;</span><br><span class="line">            (dp[<span class="number">3</span>][j][a[i]] += dp[<span class="number">2</span>][a[i]][j]) %= mod;</span><br><span class="line"></span><br><span class="line">            ll pre = dp[<span class="number">3</span>][a[i]][j];</span><br><span class="line">            ll af = ((sum1 - c[a[i]] - c[j]) * (sum1 - c[a[i]] - c[j]) - (sum2 - c[a[i]] * c[a[i]] - c[j] * c[j])) / <span class="number">2</span> % mod;</span><br><span class="line">            (ans += pre * af) %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt[a[i]] ++;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">   	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="H-Damaged-Bicycle"><a href="#H-Damaged-Bicycle" class="headerlink" title="H - Damaged Bicycle"></a>H - Damaged Bicycle</h1><h3 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ ä¸€å¼ Nä¸ªç‚¹ï¼ŒMæ¡è¾¹çš„å›¾ï¼Œå…¶ä¸­Kä¸ªç‚¹æœ‰å…±äº«å•è½¦ï¼Œæ¯è¾†å•è½¦æœ‰p[i]çš„æ¦‚ç‡æ˜¯åçš„ã€‚èµ°è·¯çš„é€Ÿåº¦æ˜¯tï¼Œéª‘è½¦çš„é€Ÿåº¦æ˜¯rã€‚é—®ä½ ä»1å·ç‚¹èµ°åˆ°Nå·ç‚¹çš„æœ€å°æœŸæœ›æ—¶é—´æ˜¯å¤šå°‘ã€‚</p>
<h3 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ul>
<li>ç”Ÿæ´»å¸¸è¯†ï¼Œéª‘è½¦çš„é€Ÿåº¦æ¯”èµ°è·¯å¿«ï¼Œæ‰€ä»¥ä¸ºäº†æ—¶é—´æœ€å°ï¼Œä¸€æ—¦æˆ‘ä»¬æˆåŠŸéª‘åˆ°è½¦æˆ‘ä»¬å°†æ²¿ç€æœ€çŸ­è·¯èµ°åˆ°ç»ˆç‚¹ã€‚è€Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯èµ°è·¯ã€‚</li>
<li>èµ°çš„è·¯å…¨éƒ¨éƒ½æ˜¯æœ€çŸ­è·¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é¢„å¤„ç†èµ·ç‚¹ï¼Œç»ˆç‚¹ï¼Œæœ‰è½¦ç‚¹åˆ°å…¶ä»–ç‚¹çš„æœ€çŸ­è·¯ã€‚</li>
<li>ç”¨dp[S][i]çŠ¶å‹ä»£è¡¨SäºŒè¿›åˆ¶ä¸­1çš„å•è½¦éƒ½åäº†çš„æƒ…å†µä¸‹å½“å‰åœ¨iåˆ°ç»ˆç‚¹è¿˜éœ€è¦çš„æ—¶é—´çš„æœ€å°æœŸæœ›ã€‚</li>
<li>è½¬ç§»æ–¹ç¨‹<ol>
<li>è½¦æ˜¯å¥½çš„ï¼Œç›´æ¥éª‘åˆ°ç»ˆç‚¹ã€‚t_car</li>
<li>è½¦æ˜¯åçš„<ul>
<li>èµ°åˆ°è¿˜æ²¡ç¡®è®¤å¥½åçš„è½¦é‚£é‡Œ</li>
<li>èµ°è·¯åˆ°ç»ˆç‚¹</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>ç­”æ¡ˆæ˜¯1+minï¼ˆ2ï¼‰</p>
<ul>
<li>dp[s][i] = dp[s | (1 &lt;&lt; j)][j] + d[i][j] / v_walk;</li>
<li>æœ€åæšä¸¾åœ¨å“ªä¸ªç‚¹æ‰«åˆ°è½¦å°±å¥½äº†ï¼Œæ—¶é—´æ˜¯d[k][i] / t_walk + dp[1&lt;&lt;i][i];</li>
</ul>
<h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxm = <span class="number">5e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> e[maxm],w[maxm],ne[maxm],h[maxn],idx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dis[maxn];</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">21</span>][<span class="number">21</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(dis));</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">st</span><span class="params">(maxn+<span class="number">7</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	dis[u] = <span class="number">0</span>;</span><br><span class="line">	priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; , vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt;, greater&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt;&gt; heap;</span><br><span class="line">	heap.<span class="built_in">push</span>(&#123;<span class="number">0</span>, u&#125;);      <span class="comment">// firstå­˜å‚¨è·ç¦»ï¼Œsecondå­˜å‚¨èŠ‚ç‚¹ç¼–å·</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (heap.<span class="built_in">size</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = heap.<span class="built_in">top</span>();</span><br><span class="line">        heap.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ver = t.second, distance = t.first;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (st[ver]) <span class="keyword">continue</span>;</span><br><span class="line">        st[ver] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[ver]; i != <span class="number">-1</span>; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> j = e[i];</span><br><span class="line">            <span class="keyword">if</span> (dis[j] &gt; distance + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[j] = distance + w[i];</span><br><span class="line">                heap.<span class="built_in">push</span>(&#123;dis[j], j&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> dp[<span class="number">1</span>&lt;&lt;<span class="number">20</span>][<span class="number">18</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*(maxn));</span><br><span class="line">	<span class="keyword">int</span> t, r;</span><br><span class="line">	cin &gt;&gt; t &gt;&gt; r;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v, w;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">		<span class="built_in">add</span>(u, v, w);</span><br><span class="line">		<span class="built_in">add</span>(v, u, w);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; K;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(K + <span class="number">2</span>)</span>, <span class="title">p</span><span class="params">(K)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i] &gt;&gt; p[i];</span><br><span class="line">	&#125;</span><br><span class="line">	a[K] = <span class="number">1</span>;</span><br><span class="line">	a[K + <span class="number">1</span>] = N;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K + <span class="number">2</span>; i ++) &#123;</span><br><span class="line">		<span class="built_in">dijkstra</span>(a[i]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K + <span class="number">2</span>; j ++) &#123;</span><br><span class="line">			d[i][j] = dis[a[j]];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (d[K][K + <span class="number">1</span>] == INF) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> S = (<span class="number">1</span> &lt;&lt; K) - <span class="number">1</span>; S &gt;= <span class="number">0</span>; S --) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) &#123;</span><br><span class="line">			<span class="keyword">if</span> ((S &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">double</span> pbad = <span class="number">0.01</span> * p[i];</span><br><span class="line">				<span class="keyword">double</span> t_car = <span class="number">1.</span> * d[i][K + <span class="number">1</span>] / r;<span class="comment">//å¼€è½¦åˆ°ç»ˆç‚¹</span></span><br><span class="line">				<span class="keyword">double</span> t_walk = <span class="number">1.</span> * d[i][K + <span class="number">1</span>] / t;<span class="comment">//èµ°è·¯åˆ°ç»ˆç‚¹</span></span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) &#123;</span><br><span class="line">					<span class="keyword">if</span> ((S &gt;&gt; j) &amp; <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">					t_walk = <span class="built_in">min</span>(t_walk, <span class="number">1.</span> * d[i][j] / t + dp[S | (<span class="number">1</span> &lt;&lt; j)][j]);</span><br><span class="line">				&#125;</span><br><span class="line">				dp[S][i] = pbad * t_walk + (<span class="number">1</span> - pbad) * t_car;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">double</span> ans = <span class="number">1.</span> * d[K][K + <span class="number">1</span>] / t;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) &#123;</span><br><span class="line">		ans = <span class="built_in">min</span>(ans, <span class="number">1.</span> * d[K][i] / t + dp[<span class="number">1</span> &lt;&lt; i][i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// cout &lt;&lt; ans &lt;&lt; endl;</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%.7lf&quot;</span>,ans);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="I-Game-on-Sum-Easy-Version"><a href="#I-Game-on-Sum-Easy-Version" class="headerlink" title="I - Game on Sum (Easy Version)"></a>I - Game on Sum (Easy Version)</h1><h3 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>Aliceå’ŒBobç©æ¸¸æˆï¼Œæ¸¸æˆä¸€å…±ä¼šè¿›è¡Œnè½®ï¼Œæœ‰ä¸€ä¸ªæ•°sè¡¨ç¤ºæ€»å’Œã€‚æ¯ä¸€è½®Aliceä¼šé€‰æ‹©ä¸€ä¸ª0åˆ°kä¹‹é—´çš„å®æ•°ï¼ŒBobé€‰æ‹©æŠŠå®ƒåŠ åˆ°sä¸Šé¢æˆ–è€…ä»sä¸­é€€å‡å»ã€‚Bobè‡³å°‘è¦é€‰æ‹©mæ¬¡åŠ æ³•ã€‚<br>Bobå¸Œæœ›æœ€åçš„æ€»å’Œå°½é‡å°ï¼ŒAliceå¸Œæœ›æœ€åçš„æ€»å’Œå°½é‡å¤§ã€‚é—®ä¸¤ä¸ªäººéƒ½æŒ‰æœ€ä¼˜ç­–ç•¥ï¼Œç­”æ¡ˆæ˜¯å¤šå°‘ã€‚<br>n &lt; 2000</p>
<h3 id="æ€è·¯-3"><a href="#æ€è·¯-3" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å…ˆä¸è¦ç®¡kï¼Œåªéœ€è¦é è™‘k=1ï¼Œæœ€åç­”æ¡ˆä¹˜ä»¥kå°±å¥½</p>
<p>æ­£ç€æƒ³å¾ˆä¹±ï¼Œä¼šæ— é™é€’å½’åˆ°æœ€åï¼Œæ‰€ä»¥æˆ‘ä»¬åç€æƒ³ã€‚</p>
<p>dp[i][j]è¡¨ç¤ºè¿˜æœ‰iå±€ï¼Œbobè¿˜è¦è‡³å°‘åŠ jæ¬¡</p>
<p>æ˜¾ç„¶</p>
<ul>
<li>dp[i][0] = 0ï¼Œå› ä¸ºbobå¸Œæœ›æ€»å’Œæœ€å°æ‰€ä»¥ä»–ä¼šæ— è„‘å‡ï¼Œæ‰€ä»¥Aliceæ¯æ¬¡éƒ½é€‰0</li>
<li>dp[i][i] = iï¼Œå› ä¸ºbobåªèƒ½åŠ äº†ï¼Œæ‰€ä»¥Aliceæ¯æ¬¡éƒ½é€‰1</li>
</ul>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€’æ¨</p>
<ul>
<li><p>Aliceé€‰æ‹©xï¼Œbobé€‰æ‹©å‡ï¼Œdp[i][j] = dp[i - 1][j] - x</p>
</li>
<li><p>Aliceé€‰æ‹©xï¼Œbobé€‰æ‹©åŠ ï¼Œdp[i][j] = dp[i - 1][j - 1] + x</p>
</li>
</ul>
<p>å› ä¸ºAliceå…ˆé€‰æ•°ï¼Œæ‰€ä»¥bobæ€»æ˜¯é€‰æ‹©è¾ƒå°çš„ï¼Œæ‰€ä»¥Aliceé€‰æ‹©çš„xä½¿å¾—bobä¸ç®¡åŠ å‡éƒ½ç›¸ç­‰ï¼Œå³x = (dp[i - 1][j] - dp[i - 1][j - 1]) / 2ã€‚</p>
<p>æ‰€ä»¥ dp[i][j] = (dp[i - 1][j] + dp[i - 1][j - 1]) / 2ã€‚</p>
<h3 id="ä»£ç -3"><a href="#ä»£ç -3" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); cout &lt;&lt; <span class="meta-string">&quot;\n&quot;</span>&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;   &quot;</span>;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">using</span> i64 = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">norm</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        x += P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= P) &#123;</span><br><span class="line">        x -= P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">power</span><span class="params">(T a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    T res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b /= <span class="number">2</span>, a *= a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span>) &#123;</span><br><span class="line">            res *= a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Z</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">Z</span>(<span class="keyword">int</span> x = <span class="number">0</span>) : <span class="built_in">x</span>(<span class="built_in">norm</span>(x)) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">val</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    Z <span class="keyword">operator</span>-() <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Z</span>(<span class="built_in">norm</span>(P - x));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Z <span class="title">inv</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(x != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">power</span>(*<span class="keyword">this</span>, P - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>*=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">i64</span>(x) * rhs.x % P;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>+=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x + rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>-=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x - rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>/=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> *= rhs.<span class="built_in">inv</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>*(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res *= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>+(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res += rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>-(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res -= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>/(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res /= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;vector&lt;Z&gt;&gt; <span class="built_in">dp</span>(<span class="number">2001</span>,vector&lt;Z&gt;(<span class="number">2001</span>,<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M &gt;&gt; K;</span><br><span class="line">	Z ans = dp[N][M] * K;</span><br><span class="line">	cout &lt;&lt; ans.<span class="built_in">val</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2000</span>; i ++) &#123;</span><br><span class="line">		dp[i][i]  = i;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j ++) &#123;</span><br><span class="line">			dp[i][j] = (dp[i<span class="number">-1</span>][j] + dp[i<span class="number">-1</span>][j<span class="number">-1</span>]) / <span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="J-Game-on-Sum-Hard-Version"><a href="#J-Game-on-Sum-Hard-Version" class="headerlink" title="J - Game on Sum (Hard Version)"></a>J - Game on Sum (Hard Version)</h1><h3 id="é¢˜æ„-4"><a href="#é¢˜æ„-4" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>å’Œç®€å•ç‰ˆç›¸æ¯”nçš„èŒƒå›´å˜å¤§äº†   n &lt; 1000000</p>
<h3 id="æ€è·¯-4"><a href="#æ€è·¯-4" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è½¬ç§»æ–¹ç¨‹åƒæ˜¯æ¨è¾‰ä¸‰è§’ï¼Œdp[i][j]çš„è´¡çŒ®ä¼šä¼ åˆ°dp[i+1][j]å’Œdp[i+1][j+1]ï¼Œå³å¾€ä¸‹æˆ–è€…å³ä¸‹èµ°ã€‚</p>
<p>äºŒæ‰€æœ‰æœ‰è´¡çŒ®çš„ç‚¹æ˜¯dp[i][i]ï¼Œ(i,i)èµ°åˆ°(N,M)éœ€è¦å‘ä¸‹èµ°N-iæ­¥ï¼Œå…¶ä¸­æœ‰M-iæ­¥å¾€å³ä¸‹èµ°ã€‚ç”±äºç¬¬ä¸€æ­¥èµ°å³ä¸‹æ˜¯(i+1,i+1)ï¼Œè¿™ä¸€æ­¥çš„ä¸æ˜¯è½¬ç§»è¿‡æ¥çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥åªèƒ½å¾€ä¸‹èµ°ï¼Œæ‰€ä»¥(i,i)èµ°åˆ°(N,M)çš„è·¯å¾„æœ‰C(N - i - 1, M - i)ç§ã€‚</p>
<p>æ ¹æ®é€’æ¨å¼ï¼Œæ²¡å¾€ä¸‹èµ°ä¸€æ­¥éƒ½è¦é™¤ä»¥2ï¼Œæ‰€ä»¥è¿˜è¦é™¤ä»¥2^(N - i)</p>
<p>æœ€åç­”æ¡ˆæ˜¯K <em> C(N - i - 1, M - i) </em> i / pow(2, N - i)ï¼ˆ1 &lt;= i &lt;= Mï¼‰;</p>
<h3 id="ä»£ç -4"><a href="#ä»£ç -4" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); cout &lt;&lt; endl;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;   &quot;</span>;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">using</span> i64 = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">norm</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        x += P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= P) &#123;</span><br><span class="line">        x -= P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">power</span><span class="params">(T a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    T res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b /= <span class="number">2</span>, a *= a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span>) &#123;</span><br><span class="line">            res *= a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Z</span> &#123;</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">Z</span>(<span class="keyword">int</span> x = <span class="number">0</span>) : <span class="built_in">x</span>(<span class="built_in">norm</span>(x)) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">val</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    Z <span class="keyword">operator</span>-() <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Z</span>(<span class="built_in">norm</span>(P - x));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Z <span class="title">inv</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(x != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">power</span>(*<span class="keyword">this</span>, P - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>*=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">i64</span>(x) * rhs.x % P;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>+=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x + rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>-=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x - rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>/=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> *= rhs.<span class="built_in">inv</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>*(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res *= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>+(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res += rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>-(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res -= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>/(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res /= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;Z&gt; <span class="title">fac</span><span class="params">(maxn + <span class="number">1</span>)</span>, <span class="title">invfac</span><span class="params">(maxn + <span class="number">1</span>)</span>, <span class="title">inv</span><span class="params">(maxn + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M &gt;&gt; K;</span><br><span class="line">	<span class="keyword">if</span> (N == M) &#123;</span><br><span class="line">		Z ans = (N * K) % mod;</span><br><span class="line">		cout &lt;&lt; ans.<span class="built_in">val</span>() &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//dp[i][i] = i, dp[i][0] = 0</span></span><br><span class="line">	<span class="comment">//è€ƒè™‘æ¯ä¸ªdp[i][i]å¯¹dp[n][m]çš„è´¡çŒ®</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> combine = [&amp;](<span class="keyword">int</span> n, <span class="keyword">int</span> m) &#123;</span><br><span class="line">		<span class="keyword">if</span> (m &gt; n || m &lt; <span class="number">0</span> || n &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">Z</span>(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> fac[n] * invfac[m] * invfac[n - m];</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	Z ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"></span><br><span class="line">		Z temp = <span class="built_in">qmi</span>(<span class="number">2</span>,N-i,mod);<span class="comment">//æ¯åˆ°ä¸‹ä¸€å±‚éƒ½è¦é™¤ä»¥äºŒ</span></span><br><span class="line">		Z x = i;</span><br><span class="line">		ans = ans + <span class="built_in">combine</span>(N - i - <span class="number">1</span>,(M - i)) / temp * x;<span class="comment">//ç¬¬ä¸€æ¬¡åªèƒ½å¾€ä¸‹ã€‚</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// cout &lt;&lt; ans.val() &lt;&lt; endl;</span></span><br><span class="line">	Z k = K;</span><br><span class="line">	ans = ans * k;</span><br><span class="line">	cout &lt;&lt; ans.<span class="built_in">val</span>() &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxn; i++) &#123;</span><br><span class="line">	    fac[i] = fac[i - <span class="number">1</span>] * i;</span><br><span class="line">	&#125;</span><br><span class="line">	invfac[maxn] = fac[maxn].<span class="built_in">inv</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = maxn; i; i--) &#123;</span><br><span class="line">	    invfac[i - <span class="number">1</span>] = invfac[i] * i;</span><br><span class="line">	    inv[i] = invfac[i] * fac[i - <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomo camp</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week1-day2 - daimayuanoj437. no crossing</title>
    <url>/2022/02/27/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week1-day2%20-%20daimayuanoj437.%20no%20crossing/</url>
    <content><![CDATA[<h1 id="no-crossingä¼ é€é—¨"><a href="#no-crossingä¼ é€é—¨" class="headerlink" title="no crossingä¼ é€é—¨"></a>no crossing<a href="http://oj.daimayuan.top/problem/437">ä¼ é€é—¨</a></h1><p><strong>é¢˜æ„ï¼š</strong> ç»™ä½ ä¸€ä¸ªæœ‰å‘å›¾ï¼Œä½†æ˜¯ä¸ç”¨æŠŠå®ƒçœ‹æˆä¸€ä¸ªå›¾ï¼Œå°±çœ‹æˆæ•°è½´ä¸Šçš„ç‚¹ï¼ŒæŸäº›ç‚¹ä¹‹é—´æœ‰è¿è¾¹ï¼Œæ³¨æ„æ˜¯æœ‰å‘è¾¹ã€‚è¿™æ ·å­é™åˆ¶æ¡ä»¶å°±å˜æˆäº†å¦‚æœè¿™æ¡è¾¹çš„ä¸­é—´æŸä¸ªç‚¹å·²ç»èµ°è¿‡åˆ™æ— æ³•é€‰æ‹©è¿™æ¡è¾¹åŒ…æ‹¬å·¦å³ç«¯ç‚¹ã€‚åœ¨é™åˆ¶ä¸‹æ±‚åˆšå¥½ç»è¿‡Kä¸ªç‚¹çš„æ‰€æœ‰è·¯å¾„ä¸­çš„æœ€çŸ­è·¯ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„æœ€çŸ­è·¯åˆ™è¾“å‡º-1.</p>
<h1 id="æ€è·¯1-åŒºé—´DP"><a href="#æ€è·¯1-åŒºé—´DP" class="headerlink" title="æ€è·¯1 - åŒºé—´DP"></a><strong>æ€è·¯1 - åŒºé—´DP</strong></h1><p>é¦–å…ˆï¼Œåç»­æ¯ä¸€æ­¥çš„åŒºé—´æ˜¯é€æ¸å‡å°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åç€æ€è€ƒå€’ç€èµ°ï¼Œé‚£ä¹ˆå·²èµ°çš„åŒºé—´æ˜¯ä¸æ–­æ‰©å¤§çš„ã€‚å‡å¦‚æœ€åä¸€æ­¥æ˜¯2 -&gt; 3,é‚£ä¹ˆå€’æ•°ç¬¬äºŒæ­¥ä¸€å®šæ˜¯a -&gt; 2ï¼Œaå±äº[1,2)å’Œ(3,N]ï¼Œåªæœ‰è¿™æ ·æ‰ç¬¦åˆé™åˆ¶ã€‚å¦‚æœaå±äº[2,3]ï¼Œé‚£ä¹ˆæœ€åä¸€æ­¥2 -&gt; 3ç»è¿‡aä¸ç¬¦åˆé™åˆ¶ã€‚</p>
<ul>
<li>æˆ‘ä»¬å®šä¹‰dp[l][r][step][type]ä»£è¡¨å½“å‰èµ°è¿‡çš„ç‚¹çš„å·¦å³è¾¹ç•Œï¼ˆæœ€å°å€¼ï¼Œæœ€å¤§å€¼ï¼‰ï¼Œå·²ç»èµ°äº†å‡ æ­¥ï¼Œå½“å‰åœç•™åœ¨lè¿˜æ˜¯rï¼Œ0åœ¨lï¼Œ1åœ¨rã€‚</li>
<li>å½“æˆ‘ä»¬å€’ç€èµ°æ—¶ï¼Œæ–°åŠ å…¥çš„ç‚¹ä¸€å®šæ˜¯ä¼šæ›´æ–°å·¦å³è¾¹ç•Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ€»æ˜¯åœåœ¨å·¦å³è¾¹ç•Œå…¶ä¸­ä¸€ä¸ªä¸Šã€‚</li>
</ul>
<p><strong>å…·ä½“çœ‹ä»£ç </strong></p>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">1e9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">102</span>][<span class="number">102</span>][<span class="number">102</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> mp[<span class="number">102</span>][<span class="number">102</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(dp));</span><br><span class="line">	<span class="built_in">memset</span>(mp,<span class="number">0x3f</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(mp));</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; K &gt;&gt; M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> a, b, c;</span><br><span class="line">		cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">		mp[a][b] = <span class="built_in">min</span>(mp[a][b], c);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) </span><br><span class="line">		dp[i][i][<span class="number">1</span>][<span class="number">0</span>] = dp[i][i][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;<span class="comment">//åªæœ‰ä¸€ä¸ªç‚¹æ²¡æœ‰è¾¹ç­”æ¡ˆæ˜¯0</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> step = <span class="number">2</span>; step &lt;= K; step ++) &#123; <span class="comment">//æ­¥æ•°æ˜¯ä¸€æ­¥æ­¥å¢åŠ çš„æ”¾æœ€å¤–é¢</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">1</span>; len &lt;= N; len ++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + len - <span class="number">1</span> &lt;= N; i ++) &#123;</span><br><span class="line">				<span class="keyword">int</span> j = i + len - <span class="number">1</span>;<span class="comment">//[i,j]æšä¸¾åŒºé—´</span></span><br><span class="line">		 		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; i; k ++) &#123;<span class="comment">//kåœ¨iå·¦è¾¹</span></span><br><span class="line">		 			<span class="comment">//k -&gt; i -&gt; j</span></span><br><span class="line">		 			<span class="keyword">if</span> (mp[k][i] != INF) dp[k][j][step][<span class="number">0</span>] = <span class="built_in">min</span>(dp[k][j][step][<span class="number">0</span>], dp[i][j][step<span class="number">-1</span>][<span class="number">0</span>] + mp[k][i]);</span><br><span class="line">		 			<span class="comment">//k -&gt; j -&gt; i</span></span><br><span class="line">		 			<span class="keyword">if</span> (mp[k][j] != INF) dp[k][j][step][<span class="number">0</span>] = <span class="built_in">min</span>(dp[k][j][step][<span class="number">0</span>], dp[i][j][step<span class="number">-1</span>][<span class="number">1</span>] + mp[k][j]);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> k = j + <span class="number">1</span>; k &lt;= N; k ++) &#123;<span class="comment">//kåœ¨å³è¾¹</span></span><br><span class="line">					<span class="comment">//k -&gt; i -&gt; j</span></span><br><span class="line">					<span class="keyword">if</span> (mp[k][i] != INF) dp[i][k][step][<span class="number">1</span>] = <span class="built_in">min</span>(dp[i][k][step][<span class="number">1</span>], dp[i][j][step<span class="number">-1</span>][<span class="number">0</span>] + mp[k][i]);</span><br><span class="line">					<span class="comment">//k -&gt; j -&gt; i</span></span><br><span class="line">					<span class="keyword">if</span> (mp[k][j] != INF) dp[i][k][step][<span class="number">1</span>] = <span class="built_in">min</span>(dp[i][k][step][<span class="number">1</span>], dp[i][j][step<span class="number">-1</span>][<span class="number">1</span>] + mp[k][j]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123;<span class="comment">//æšä¸¾æ‰€æœ‰åŒºé—´</span></span><br><span class="line">			<span class="keyword">int</span> t = <span class="built_in">min</span>(dp[i][j][K][<span class="number">0</span>],dp[i][j][K][<span class="number">1</span>]);<span class="comment">//åˆšå¥½èµ°äº†Kæ­¥</span></span><br><span class="line">			ans = <span class="built_in">min</span>(ans, t);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; (ans == <span class="number">1e9</span> ? <span class="number">-1</span> : ans) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
<h1 id="æ€è·¯2-è®°å¿†åŒ–æœç´¢"><a href="#æ€è·¯2-è®°å¿†åŒ–æœç´¢" class="headerlink" title="æ€è·¯2 - è®°å¿†åŒ–æœç´¢"></a><strong>æ€è·¯2 - è®°å¿†åŒ–æœç´¢</strong></h1><p>è®°å¿†åŒ–æœç´¢çš„è¯æˆ‘ä»¬å°±å¯ä»¥æ­£ç€æ€è€ƒäº†ï¼ˆæ¯”è¾ƒå®¹æ˜“ç†æ¸…ï¼‰ï¼Œå…ˆæšä¸¾æ‰€æœ‰ç‚¹ä½œä¸ºèµ·ç‚¹èµ·ç‚¹ã€‚è‹¥å½“å‰èµ°äº†nowè¿™ä¸ªç‚¹ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªç‚¹å¯ä»¥æ˜¯[l+1,now-1]å’Œ[now+1,r-1]ã€‚læ˜¯èµ°è¿‡çš„ç‚¹ä¸­å°äºnowçš„æœ€å¤§çš„ç‚¹ï¼Œræ˜¯èµ°è¿‡çš„ç‚¹ä¸­å¤§äºnowçš„æœ€å°çš„ç‚¹ã€‚ç„¶åç»§ç»­æœç´¢ï¼ŒåŒæ—¶æ›´æ–°æ­¥æ•°å’Œlï¼Œrï¼Œå½“å·²ç»Kæ­¥åè¿”å›ä¸€ä¸ª0ã€‚</p>
<p>å°±åƒä¸Šé¢æ‰€è¯´çš„ï¼Œæˆ‘ä»¬çš„æ¯èµ°å®Œä¸€æ­¥éƒ½ä¼šæ›´æ–°è¾¹ç•Œï¼Œä¹Ÿå°±æ˜¯nowå°±æ˜¯å…¶ä¸­ä¸€ä¸ªè¾¹ç•Œï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¼˜åŒ–æ‰å…¶ä¸­ä¸€ä¸ªè¾¹ç•Œã€‚</p>
<ul>
<li>dp[now][go][step]è¡¨ç¤ºå½“å‰é€‰äº†nowï¼Œä¸‹ä¸€æ­¥å¦ä¸€ä¸ªè¾¹ç•Œä¸ºgoï¼Œè¿˜éœ€è¦èµ°stepä¸ªç‚¹</li>
</ul>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">1e9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">102</span>][<span class="number">102</span>][<span class="number">102</span>];</span><br><span class="line"><span class="keyword">int</span> mp[<span class="number">102</span>][<span class="number">102</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> go, <span class="keyword">int</span> cnt)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (~dp[now][go][cnt]) <span class="keyword">return</span>  dp[now][go][cnt];<span class="comment">//è®°å¿†åŒ–</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (!cnt) &#123;</span><br><span class="line">		<span class="keyword">return</span> dp[now][go][cnt] = <span class="number">0</span>;<span class="comment">//å·²ç»Kä¸ªç‚¹äº†</span></span><br><span class="line">	&#125;</span><br><span class="line">	dp[now][go][cnt] = <span class="number">1e9</span>;<span class="comment">//åˆå§‹åŒ–ä¸ºæœ€å¤§å€¼</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="built_in">min</span>(now,go) + <span class="number">1</span>; i &lt; <span class="built_in">max</span>(now,go); i ++) &#123;<span class="comment">//æšä¸¾å¯ä»¥èµ°çš„ç‚¹</span></span><br><span class="line">		<span class="keyword">int</span> w = mp[now][i];</span><br><span class="line">		dp[now][go][cnt] = <span class="built_in">min</span>(&#123;dp[now][go][cnt],<span class="built_in">min</span>(<span class="built_in">dfs</span>(i,now,cnt<span class="number">-1</span>),<span class="built_in">dfs</span>(i,go,cnt<span class="number">-1</span>)) + w&#125;);<span class="comment">//ç»§ç»­æœç´¢</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dp[now][go][cnt];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">memset</span>(dp,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(dp));</span><br><span class="line">	<span class="built_in">memset</span>(mp,<span class="number">0x3f</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(mp));</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; K &gt;&gt; M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> a, b, c;</span><br><span class="line">		cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">		mp[a][b] = <span class="built_in">min</span>(mp[a][b], c);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;<span class="comment">//æšä¸¾èµ·ç‚¹</span></span><br><span class="line">		ans = <span class="built_in">min</span>(&#123;ans,<span class="built_in">dfs</span>(i,<span class="number">0</span>,K<span class="number">-1</span>),<span class="built_in">dfs</span>(i,N+<span class="number">1</span>,K<span class="number">-1</span>)&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (ans == <span class="number">1e9</span>) cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">else</span> cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week1-day3 - daimayuanoj451. Dis</title>
    <url>/2022/02/28/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week1-day3%20-%20daimayuanoj451.%20Dis/</url>
    <content><![CDATA[<p><a href="http://oj.daimayuan.top/submissions">#451. Dis</a></p>
<h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a><strong>é¢˜æ„</strong></h1><p>ç»™ä½ ä¸€æ£µæ ‘å’Œæ¯ä¸ªç‚¹æƒå€¼ï¼Œæ¯æ¬¡è¯¢é—®ä½ uï¼Œvè·¯å¾„ä¸Šæ‰€æœ‰ç‚¹çš„å¼‚æˆ–å’Œã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h1><p>æ¨¡æ¿é¢˜<br>æ ‘ä¸Šå‰ç¼€å¼‚æˆ–å’Œ+lcaã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a><strong>ä»£ç </strong></h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(maxn)</span></span>;</span><br><span class="line"><span class="keyword">int</span> e[maxn],w[maxn],ne[maxn],h[maxn],idx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> dep[maxn], fa[maxn][<span class="number">20</span>], q[maxn],sum[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	dep[<span class="number">0</span>] = <span class="number">0</span>, dep[root] = <span class="number">1</span>; <span class="keyword">int</span> hh = <span class="number">0</span>, tt = <span class="number">-1</span>;</span><br><span class="line">	sum[<span class="number">0</span>] = a[root];</span><br><span class="line">	q[ ++ tt] = root;</span><br><span class="line">    <span class="keyword">while</span>(hh &lt;= tt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u = q[hh ++];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = h[u]; ~i ; i = ne[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = e[i];</span><br><span class="line">            <span class="keyword">if</span>(!dep[j])</span><br><span class="line">            &#123;</span><br><span class="line">            	dep[j] = dep[u] + <span class="number">1</span>;</span><br><span class="line">				q[ ++ tt] = j;</span><br><span class="line">				sum[j] = sum[u] ^ a[j];</span><br><span class="line">				fa[j][<span class="number">0</span>] = u;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">19</span>; k ++)</span><br><span class="line">				fa[j][k] = fa[fa[j][k - <span class="number">1</span>]][k - <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(dep[a] &lt; dep[b]) <span class="built_in">swap</span>(a, b); </span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i --)</span><br><span class="line">	        <span class="keyword">if</span>(dep[fa[a][i]] &gt;= dep[b])  a = fa[a][i];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a == b)  <span class="keyword">return</span> a;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i --) </span><br><span class="line">		<span class="keyword">if</span>(fa[a][i] != fa[b][i]) &#123;</span><br><span class="line">			a = fa[a][i];</span><br><span class="line">            b = fa[b][i];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> fa[a][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*(N+<span class="number">10</span>));</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N - <span class="number">1</span>; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		<span class="built_in">add</span>(u,v);</span><br><span class="line">		<span class="built_in">add</span>(v,u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">bfs</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		<span class="keyword">int</span> same = <span class="built_in">lca</span>(u, v);</span><br><span class="line">		<span class="keyword">int</span> ans = sum[u] ^ sum[v] ^ a[same];</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week1-day4 - daimayuanoj456. é€‰æ•°</title>
    <url>/2022/03/01/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week1-day4%20-%20daimayuanoj456.%20%E9%80%89%E6%95%B0/</url>
    <content><![CDATA[<p><a href="http://oj.daimayuan.top/problem/456">é€‰æ•°</a></p>
<h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a><strong>é¢˜æ„</strong></h1><p>ç»™ä½ Nä¸ªæ•°ï¼Œé€‰å‡ºè‹¥å¹²ä¸ªï¼Œä»–ä»¬çš„å’Œæ¨¡Nä¸º0ï¼Œè¾“å‡ºè¿™äº›æ•°çš„ä¸ªæ•°å’Œä¸‹æ ‡ã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h1><ul>
<li>æ¨¡Næœ€å¤šæœ‰Nç§ç»“æœ[0,N)ï¼Œå¯¹äºè¿™Nä¸ªæ•°çš„å‰ç¼€å’Œsumæœ‰Nä¸ªï¼Œå†åŠ ä¸Šå…¨éƒ½ä¸é€‰çš„ä¸€ä¸ª0ï¼Œå°±æœ‰N+1ä¸ªæ•°å€¼ï¼Œåˆ™å¿…æœ‰ä¸¤ä¸ªå‰ç¼€ç›¸ç­‰ï¼Œè¿™ä¸¤ä¸ªå‰ç¼€å·®åˆ†ä¸€ä¸‹ï¼Œä¸­é—´é‚£æ®µå’Œæ¨¡Nå°±æ˜¯0.</li>
</ul>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a><strong>ä»£ç </strong></h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i], a[i] %= N;</span><br><span class="line">		</span><br><span class="line">	map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; st;</span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	st[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		(sum += a[i]) %= N;</span><br><span class="line">		<span class="keyword">if</span> (st.<span class="built_in">count</span>(sum)) &#123;</span><br><span class="line">			cout &lt;&lt; i-st[sum] &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = st[sum] + <span class="number">1</span>; j &lt;= i; j ++) &#123;</span><br><span class="line">				cout &lt;&lt; j &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		st[sum] = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week1-day5 - daimayuanoj452. åºåˆ—æ“ä½œ</title>
    <url>/2022/03/02/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week1-day5%20-%20daimayuanoj452.%20%E5%BA%8F%E5%88%97%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<p><a href="http://oj.daimayuan.top/problem/452">åºåˆ—æ“ä½œ</a></p>
<h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a><strong>é¢˜æ„</strong></h1><p>ç»™ä½ ä¸€ä¸ªé•¿åº¦Nçš„åºåˆ—ï¼Œæœ‰Mæ¬¡æ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç§</p>
<ul>
<li>æŠŠä¸€ä¸ªä½ç½®çš„æ•°æ”¹æˆx</li>
<li>æŠŠå°äºxçš„æ•°éƒ½æ”¹æˆx</li>
</ul>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h1><p>æ³¨æ„åˆ°ç¬¬äºŒç§æ“ä½œæ˜¯éä¸¥æ ¼å•è°ƒå¢çš„ã€‚æˆ‘ä»¬åªéœ€è¦å–ä¸€ä¸ªåç¼€çš„æœ€å¤§å€¼ã€‚<br>å½“æŸä¸ªä½ç½®é‡åˆ°æ“ä½œä¸€ï¼Œåˆ™è¯¥ä½ç½®çš„å¤§å°åº”è¯¥å›ºå®šäº†ï¼Œå› ä¸ºå®ƒå‰é¢çš„ä¿®æ”¹å¯¹å…¶æ²¡æœ‰å½±å“ã€‚<br>è¯»å…¥å¾ˆå¤§ï¼Œcinè®°å¾—å…³åŒæ­¥</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a><strong>ä»£ç </strong></h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N)</span>, <span class="title">ans</span><span class="params">(N,<span class="number">-1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">		</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">x</span><span class="params">(M)</span>, <span class="title">y</span><span class="params">(M)</span>, <span class="title">z</span><span class="params">(M)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; x[i];</span><br><span class="line">		<span class="keyword">if</span> (x[i] == <span class="number">2</span>) &#123;</span><br><span class="line">			cin &gt;&gt; y[i];</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			cin &gt;&gt; y[i] &gt;&gt; z[i];</span><br><span class="line">			y[i] --;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> mmax = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = M - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">		<span class="keyword">if</span> (x[i] == <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (ans[y[i]] == <span class="number">-1</span>) &#123;</span><br><span class="line">				a[y[i]] = <span class="built_in">max</span>(&#123;z[i], mmax&#125;);</span><br><span class="line">				ans[y[i]] = a[y[i]];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			mmax = <span class="built_in">max</span>(mmax, y[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		cout &lt;&lt; (ans[i] == <span class="number">-1</span> ? <span class="built_in">max</span>(a[i],mmax) : a[i]) &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="çº¿æ®µæ ‘-åŒºé—´ä¿®æ”¹æœ€å¤§å€¼-å•ç‚¹ä¿®æ”¹"><a href="#çº¿æ®µæ ‘-åŒºé—´ä¿®æ”¹æœ€å¤§å€¼-å•ç‚¹ä¿®æ”¹" class="headerlink" title="çº¿æ®µæ ‘ åŒºé—´ä¿®æ”¹æœ€å¤§å€¼+å•ç‚¹ä¿®æ”¹"></a>çº¿æ®µæ ‘ åŒºé—´ä¿®æ”¹æœ€å¤§å€¼+å•ç‚¹ä¿®æ”¹</h1><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(maxn)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">seg</span>&#123;</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> ls u &lt;&lt; 1</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> rs u &lt;&lt; 1 | 1</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">		<span class="keyword">int</span> l, r, mmax;</span><br><span class="line">		<span class="keyword">int</span> lazy;</span><br><span class="line">	&#125;tr[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">		tr[u].mmax = <span class="built_in">max</span>(tr[ls].mmax, tr[rs].mmax);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (tr[u].lazy != <span class="number">-1</span>) &#123;</span><br><span class="line">			tr[ls].mmax = <span class="built_in">max</span>(tr[ls].mmax, tr[u].lazy);</span><br><span class="line">			tr[rs].mmax = <span class="built_in">max</span>(tr[rs].mmax, tr[u].lazy);</span><br><span class="line">			<span class="keyword">int</span> &amp;la = tr[u].lazy;</span><br><span class="line">			tr[ls].lazy = <span class="built_in">max</span>(tr[ls].lazy, la);</span><br><span class="line">			tr[rs].lazy = <span class="built_in">max</span>(tr[rs].lazy, la);</span><br><span class="line">			la = <span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">		tr[u].l = l, tr[u].r = r;</span><br><span class="line">		<span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">			tr[u] = &#123;l,r,a[l], <span class="number">-1</span>&#125;;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">build</span>(ls,l,mid);</span><br><span class="line">		<span class="built_in">build</span>(rs,mid + <span class="number">1</span>, r);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">update</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (tr[u].l &gt;= l &amp;&amp; tr[u].r &lt;=  r) &#123;</span><br><span class="line">			tr[u].mmax = <span class="built_in">max</span>(tr[u].mmax, x);</span><br><span class="line">			tr[u].lazy = <span class="built_in">max</span>(tr[u].lazy, x);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">pushdown</span>(u);</span><br><span class="line">		<span class="keyword">int</span> mid = (tr[u].l + tr[u].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (mid &gt;= l) &#123;</span><br><span class="line">			<span class="built_in">update</span>(ls,l,r,x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (r &gt; mid) &#123;</span><br><span class="line">			<span class="built_in">update</span>(rs,l,r,x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (tr[u].l == tr[u].r) &#123;</span><br><span class="line">			tr[u].lazy = <span class="number">-1</span>;</span><br><span class="line">			tr[u].mmax = x;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">pushdown</span>(u);</span><br><span class="line">		<span class="keyword">int</span> mid = (tr[u].l + tr[u].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (p &lt;= mid) <span class="built_in">modify</span>(ls,p,x);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">modify</span>(rs,p,x);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (tr[u].l == tr[u].r &amp;&amp; tr[u].l == p) &#123;</span><br><span class="line">			<span class="keyword">return</span> tr[u].mmax;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">pushdown</span>(u);</span><br><span class="line">		<span class="keyword">int</span> mid = (tr[u].l + tr[u].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (p &lt;= mid) <span class="keyword">return</span> <span class="built_in">query</span>(ls,p);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(rs,p);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;tr;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">	tr.<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,N);</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">x</span><span class="params">(M)</span>, <span class="title">y</span><span class="params">(M)</span>, <span class="title">z</span><span class="params">(M)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; x[i];</span><br><span class="line">		<span class="keyword">if</span> (x[i] == <span class="number">2</span>) &#123;</span><br><span class="line">			cin &gt;&gt; y[i];</span><br><span class="line">			tr.<span class="built_in">update</span>(<span class="number">1</span>,<span class="number">1</span>,N,y[i]);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			cin &gt;&gt; y[i] &gt;&gt; z[i];</span><br><span class="line">			tr.<span class="built_in">modify</span>(<span class="number">1</span>,y[i],z[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cout &lt;&lt; tr.<span class="built_in">query</span>(<span class="number">1</span>,i) &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week1-day6 - daimayuanoj464. æ•°æ•°</title>
    <url>/2022/03/03/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week1-day6%20-%20daimayuanoj464.%20%E6%95%B0%E6%95%B0/</url>
    <content><![CDATA[<h1 id="æ•°æ•°"><a href="#æ•°æ•°" class="headerlink" title="æ•°æ•°"></a><a href="http://oj.daimayuan.top/problem/464">æ•°æ•°</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>åœ¨ç»™å®š ğ‘ é•¿çš„æ•°ç»„ {ğ´} ä¸­è¿›è¡Œ ğ‘„ æ¬¡è¯¢é—® [ğ¿ğ‘–,ğ‘…ğ‘–] åŒºé—´ä¸­ä¸å¤§äº ğ»ğ‘– çš„å…ƒç´ ä¸ªæ•°ã€‚</p>
<p>å…±åŒ…å« ğ‘‡ ç»„æ•°æ®ã€‚</p>
<h1 id="1-è«é˜Ÿ-æ ‘çŠ¶æ•°ç»„ï¼ˆ3e8æ²¡è¢«å¡ï¼‰"><a href="#1-è«é˜Ÿ-æ ‘çŠ¶æ•°ç»„ï¼ˆ3e8æ²¡è¢«å¡ï¼‰" class="headerlink" title="1.è«é˜Ÿ + æ ‘çŠ¶æ•°ç»„ï¼ˆ3e8æ²¡è¢«å¡ï¼‰"></a>1.è«é˜Ÿ + æ ‘çŠ¶æ•°ç»„ï¼ˆ3e8æ²¡è¢«å¡ï¼‰</h1><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ul>
<li>ç¦»æ•£åŒ–æ‰€æœ‰aå’ŒæŸ¥è¯¢çš„h</li>
<li>æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å½“å‰åŒºé—´å„ç§å–å€¼çš„ä¸ªæ•°</li>
<li>è«é˜Ÿä¿®æ”¹åŒºé—´</li>
<li>å¤æ‚åº¦O(N<em>sqrt(N)</em>log(N))</li>
</ul>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="keyword">int</span> blo;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> l, r, h, id;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> id[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (id[a.l] != id[b.l]) <span class="keyword">return</span> id[a.l] &lt; id[b.l];</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> a.r &lt; b.r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fenwick</span> &#123;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> n;</span><br><span class="line">    std::vector&lt;T&gt; a;</span><br><span class="line">    <span class="built_in">Fenwick</span>(<span class="keyword">int</span> n) : <span class="built_in">n</span>(n), <span class="built_in">a</span>(n) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, T v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &lt;= n<span class="number">-1</span>; i += i &amp; -i) &#123;</span><br><span class="line">            a[i] += v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">sum</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        T ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &gt; <span class="number">0</span>; i -= i &amp; -i) &#123;</span><br><span class="line">            ans += a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">rangeSum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(r) - <span class="built_in">sum</span>(l - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; Q;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N+<span class="number">1</span>)</span></span>;</span><br><span class="line">	vector&lt;node&gt; query;</span><br><span class="line">	blo = (ll)<span class="built_in">sqrt</span>((<span class="keyword">double</span>)N);</span><br><span class="line">	vector&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">		v.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r, h;</span><br><span class="line">		cin &gt;&gt; l &gt;&gt; r &gt;&gt; h;</span><br><span class="line">		id[l] = l / blo;</span><br><span class="line">		id[r] = r / blo;</span><br><span class="line">		v.<span class="built_in">push_back</span>(h);</span><br><span class="line">		query.<span class="built_in">push_back</span>(&#123;l, r, h, i&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">	v.<span class="built_in">erase</span>(<span class="built_in">unique</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>()),v.<span class="built_in">end</span>());</span><br><span class="line">	</span><br><span class="line">	M = v.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		a[i] = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),a[i]) - v.<span class="built_in">begin</span>() + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		query[i].h = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),query[i].h) - v.<span class="built_in">begin</span>() + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sort</span>(query.<span class="built_in">begin</span>(),query.<span class="built_in">end</span>(),cmp);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function">Fenwick&lt;<span class="keyword">int</span>&gt; <span class="title">t</span><span class="params">(M+<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">auto</span> move = [&amp;](<span class="keyword">int</span> p) &#123;</span><br><span class="line">		<span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (p &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			f = <span class="number">-1</span>;</span><br><span class="line">			p = - p;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		t.<span class="built_in">add</span>(p,f);</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">ans</span><span class="params">(Q+<span class="number">10</span>)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> l = query[<span class="number">0</span>].l, r = query[<span class="number">0</span>].r;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123;</span><br><span class="line">		ans[query[<span class="number">0</span>].id] += a[i] &lt;= query[<span class="number">0</span>].h;</span><br><span class="line">		t.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="keyword">auto</span> &amp;q = query[i];</span><br><span class="line">	    <span class="keyword">while</span> (l &gt; q.l) <span class="built_in">move</span>(a[--l]);</span><br><span class="line">	    <span class="keyword">while</span> (r &lt; q.r) <span class="built_in">move</span>(a[++r]);</span><br><span class="line">	    <span class="keyword">while</span> (l &lt; q.l) <span class="built_in">move</span>(-a[l++]);</span><br><span class="line">	    <span class="keyword">while</span> (r &gt; q.r) <span class="built_in">move</span>(-a[r--]);</span><br><span class="line">	    ans[q.id] = t.<span class="built_in">sum</span>(q.h);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="2-è«é˜Ÿ-åˆ†å—ï¼ˆ2Nsqrt-N-ï¼‰"><a href="#2-è«é˜Ÿ-åˆ†å—ï¼ˆ2Nsqrt-N-ï¼‰" class="headerlink" title="2.è«é˜Ÿ+åˆ†å—ï¼ˆ2Nsqrt(N)ï¼‰"></a>2.è«é˜Ÿ+åˆ†å—ï¼ˆ2<em>N</em>sqrt(N)ï¼‰</h1><h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ul>
<li>å’Œç¬¬ä¸€ä¸ªåšæ³•å·®ä¸å¤šï¼Œä¸è¿‡è«é˜Ÿä¸»è¦å¤æ‚åº¦åœ¨äºn*sqrt(n)æ¬¡ä¿®æ”¹ï¼Œæ ‘çŠ¶æ•°ç»„çš„ä¿®æ”¹æ˜¯logï¼Œåˆ†å—ä¿®æ”¹æ˜¯O(1)ï¼ŒæŸ¥è¯¢æ˜¯O(sqrt(n));</li>
<li>æ‰€ä»¥å¤æ‚åº¦æ˜¯O(2 <em> N</em>sqrt(N)ï¼‰</li>
</ul>
<h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="keyword">int</span> blo;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> l, r, h, id;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> id[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (id[a.l] != id[b.l]) <span class="keyword">return</span> id[a.l] &lt; id[b.l];</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> a.r &lt; b.r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; Q;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N+<span class="number">1</span>)</span></span>;</span><br><span class="line">	vector&lt;node&gt; query;</span><br><span class="line">	blo = (ll)<span class="built_in">sqrt</span>((<span class="keyword">double</span>)N);</span><br><span class="line">	vector&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">		v.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r, h;</span><br><span class="line">		cin &gt;&gt; l &gt;&gt; r &gt;&gt; h;</span><br><span class="line">		id[l] = l / blo;</span><br><span class="line">		id[r] = r / blo;</span><br><span class="line">		v.<span class="built_in">push_back</span>(h);</span><br><span class="line">		query.<span class="built_in">push_back</span>(&#123;l, r, h, i&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">	v.<span class="built_in">erase</span>(<span class="built_in">unique</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>()),v.<span class="built_in">end</span>());</span><br><span class="line">	</span><br><span class="line">	M = v.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		a[i] = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),a[i]) - v.<span class="built_in">begin</span>() + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		query[i].h = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),query[i].h) - v.<span class="built_in">begin</span>() + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sort</span>(query.<span class="built_in">begin</span>(),query.<span class="built_in">end</span>(),cmp);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> block = <span class="built_in">sqrt</span>(M);</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">idv</span><span class="params">(M+<span class="number">1</span>)</span>,<span class="title">sum</span><span class="params">(block + <span class="number">10</span>)</span>,<span class="title">vv</span><span class="params">(M+<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M + <span class="number">1</span>; i ++) idv[i] = i / block;</span><br><span class="line">	<span class="keyword">auto</span> add = [&amp;](<span class="keyword">int</span> p) &#123;</span><br><span class="line">		<span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (p &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			f = <span class="number">-1</span>;</span><br><span class="line">			p = - p;</span><br><span class="line">		&#125;</span><br><span class="line">		vv[p] += f;</span><br><span class="line">		sum[idv[p]] += f;</span><br><span class="line">		</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> ask = [&amp;](<span class="keyword">int</span> x) &#123;</span><br><span class="line">		<span class="keyword">int</span> idr = idv[x];</span><br><span class="line">		<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; idr; i ++) &#123;</span><br><span class="line">			ans += sum[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = idr * block; i &lt;= x; i ++) &#123;</span><br><span class="line">			ans += vv[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">ans</span><span class="params">(Q+<span class="number">10</span>)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> l = query[<span class="number">0</span>].l, r = query[<span class="number">0</span>].r;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123;</span><br><span class="line">		ans[query[<span class="number">0</span>].id] += a[i] &lt;= query[<span class="number">0</span>].h;</span><br><span class="line">		<span class="built_in">add</span>(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="keyword">auto</span> &amp;q = query[i];</span><br><span class="line">	    <span class="keyword">while</span> (l &gt; q.l) <span class="built_in">add</span>(a[--l]);</span><br><span class="line">	    <span class="keyword">while</span> (r &lt; q.r) <span class="built_in">add</span>(a[++r]);</span><br><span class="line">	    <span class="keyword">while</span> (l &lt; q.l) <span class="built_in">add</span>(-a[l++]);</span><br><span class="line">	    <span class="keyword">while</span> (r &gt; q.r) <span class="built_in">add</span>(-a[r--]);</span><br><span class="line">	    ans[q.id] = <span class="built_in">ask</span>(q.h);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h1><h3 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å¯¹äºæ‰€æœ‰è¯¢é—®æŒ‰ç…§hæ’åºï¼Œæ¯æ¬¡æŠŠå°äºç­‰äºhçš„a[i]çš„ä½ç½®æ’å…¥åˆ°æ ‘çŠ¶æ•°ç»„ï¼Œè¿™æ ·ç­”æ¡ˆå°±æ˜¯åŒºé—´[l,r]çš„å’Œã€‚</p>
<h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qq</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> l, r, h, id;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(qq a, qq b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.h &lt; b.h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fenwick</span> &#123;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> n;</span><br><span class="line">    std::vector&lt;T&gt; a;</span><br><span class="line">    <span class="built_in">Fenwick</span>(<span class="keyword">int</span> n) : <span class="built_in">n</span>(n), <span class="built_in">a</span>(n) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, T v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &lt;= n; i += i &amp; -i) &#123;</span><br><span class="line">            a[i] += v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">sum</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        T ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &gt; <span class="number">0</span>; i -= i &amp; -i) &#123;</span><br><span class="line">            ans += a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">rangeSum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(r) - <span class="built_in">sum</span>(l - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; Q;</span><br><span class="line">	vector&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; <span class="built_in">a</span>(N+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i].first;</span><br><span class="line">		a[i].first = -a[i].first;</span><br><span class="line">		a[i].second = i;</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">	priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		q.<span class="built_in">push</span>(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;qq&gt; <span class="title">query</span><span class="params">(Q)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r, h;</span><br><span class="line">		cin &gt;&gt; l &gt;&gt; r &gt;&gt; h;</span><br><span class="line">		query[i] = &#123;l, r, h, i&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sort</span>(query.<span class="built_in">begin</span>(),query.<span class="built_in">end</span>(),cmp);</span><br><span class="line">	</span><br><span class="line">	<span class="function">Fenwick&lt;<span class="keyword">int</span>&gt; <span class="title">t</span><span class="params">(<span class="number">100010</span>)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">ans</span><span class="params">(Q)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="comment">// error(q.top().first);</span></span><br><span class="line">		<span class="keyword">auto</span> [l,r,h,id] = query[i];</span><br><span class="line">		<span class="keyword">while</span> (q.<span class="built_in">size</span>() &amp;&amp; -q.<span class="built_in">top</span>().first &lt;= h) &#123;</span><br><span class="line">			<span class="keyword">auto</span> [hh,p] = q.<span class="built_in">top</span>();</span><br><span class="line">			q.<span class="built_in">pop</span>();</span><br><span class="line">			t.<span class="built_in">add</span>(p,<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		ans[id] = t.<span class="built_in">rangeSum</span>(l,r);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="ä¸»å¸­æ ‘åœ¨çº¿åšæ³•"><a href="#ä¸»å¸­æ ‘åœ¨çº¿åšæ³•" class="headerlink" title="ä¸»å¸­æ ‘åœ¨çº¿åšæ³•"></a>ä¸»å¸­æ ‘åœ¨çº¿åšæ³•</h1><h3 id="æ€è·¯-3"><a href="#æ€è·¯-3" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>ä¸»å¸­æ ‘çš„ç‰ˆæœ¬å°±æ˜¯æŸ¥è¯¢çš„åŒºé—´ï¼Œç»´æŠ¤çš„å€¼æ˜¯a[i]çš„ä¸ªæ•°ã€‚</p>
<h3 id="ä»£ç -3"><a href="#ä»£ç -3" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> l, r, cnt;</span><br><span class="line">&#125;tr[maxn * <span class="number">21</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> root[maxn], tot;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(maxn)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t = ++ tot;</span><br><span class="line">	tr[t] = tr[u];</span><br><span class="line">	tr[t].cnt ++;</span><br><span class="line">	<span class="keyword">if</span> (l == r) <span class="keyword">return</span> t;</span><br><span class="line">	<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (x &lt;= mid) &#123;</span><br><span class="line">		tr[t].l = <span class="built_in">insert</span>(tr[u].l, l, mid, x);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		tr[t].r = <span class="built_in">insert</span>(tr[u].r,mid + <span class="number">1</span>, r, x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (l == r) <span class="keyword">return</span> tr[p].cnt;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (x &gt; mid) &#123;</span><br><span class="line">		<span class="keyword">return</span> tr[tr[p].l].cnt + <span class="built_in">ask</span>(tr[p].r, mid + <span class="number">1</span>, r, x);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">ask</span>(tr[p].l, l, mid, x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; Q;</span><br><span class="line">	a.<span class="built_in">resize</span>(N+<span class="number">1</span>);</span><br><span class="line">	tot = <span class="number">0</span>;</span><br><span class="line">	vector&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">		v.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">	v.<span class="built_in">erase</span>(<span class="built_in">unique</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>()),v.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">int</span> len = v.<span class="built_in">size</span>();</span><br><span class="line">	<span class="comment">// cout &lt;&lt; len &lt;&lt; endl;</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> find = [&amp;](<span class="keyword">int</span> x) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">upper_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),x) - v.<span class="built_in">begin</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		root[i] = <span class="built_in">insert</span>(root[i - <span class="number">1</span>], <span class="number">1</span>, len, <span class="built_in">find</span>(a[i]));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r, h;</span><br><span class="line">		cin &gt;&gt; l &gt;&gt; r &gt;&gt; h;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">ask</span>(root[r],<span class="number">1</span>,len,<span class="built_in">find</span>(h)) - <span class="built_in">ask</span>(root[l<span class="number">-1</span>],<span class="number">1</span>,len,<span class="built_in">find</span>(h)) &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week1-day7 - daimayuanoj454. Minimum Or Spanning Tree</title>
    <url>/2022/03/04/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week1-day7%20-%20daimayuanoj454.%20Minimum%20Or%20Spanning%20Tree/</url>
    <content><![CDATA[<p><a href="http://oj.daimayuan.top/course/10/problem/454">Minimum Or Spanning Tree</a></p>
<h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>æ±‚å›¾çš„æœ€å°æˆ–ç”Ÿæˆæ ‘ï¼Œæƒå€¼æ˜¯æ‰€æœ‰è¾¹æƒæˆ–èµ·æ¥çš„å€¼</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><ul>
<li>ç­”æ¡ˆçš„æ¯ä¸€ä½å¯ä»¥åˆ†å¼€è€ƒè™‘</li>
<li>å› ä¸ºæ˜¯æˆ–ï¼Œç­”æ¡ˆè¿™ä¸€ä½è¦æƒ³æ˜¯0ï¼Œåˆ™è¦æ±‚æ‰€é€‰çš„è¾¹è¿™ä¸€ä½ä¸Šéƒ½æ˜¯0ï¼Œæˆ‘ä»¬æŠŠè¾¹æƒç¬¦åˆçš„è¾¹éƒ½é€‰ä¸Šï¼Œçœ‹æ˜¯å¦èƒ½å¤Ÿå°†æ‰€æœ‰ç‚¹è”é€š</li>
<li>æˆ‘ä»¬ä»é«˜åˆ°ä½è€ƒè™‘æ¯ä¸€ä½ï¼Œæšä¸¾å½“å‰ä½æ—¶ï¼Œè¿™æ¡è¾¹è¿˜è¦æ»¡è¶³å‰é¢ä½çš„è¦æ±‚</li>
<li>å½“ç­”æ¡ˆè¿™ä¸€ä½æ˜¯0ï¼Œåˆ™åé¢æ‰€é€‰è¾¹çš„è¿™ä¸€ä½å¿…é¡»æ˜¯0ï¼Œå¦‚æœæ˜¯1ï¼Œåˆ™æ²¡æœ‰è¦æ±‚ã€‚</li>
</ul>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line">vector&lt;array&lt;<span class="keyword">int</span>,3&gt; &gt; edges;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DSU</span> &#123;</span></span><br><span class="line">    std::vector&lt;<span class="keyword">int</span>&gt; f, siz;</span><br><span class="line">    <span class="built_in">DSU</span>(<span class="keyword">int</span> n) : <span class="built_in">f</span>(n), <span class="built_in">siz</span>(n, <span class="number">1</span>) &#123; std::<span class="built_in">iota</span>(f.<span class="built_in">begin</span>(), f.<span class="built_in">end</span>(), <span class="number">0</span>); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">leader</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (x != f[x]) x = f[x] = f[f[x]];</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">same</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">leader</span>(x) == <span class="built_in">leader</span>(y); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        x = <span class="built_in">leader</span>(x);</span><br><span class="line">        y = <span class="built_in">leader</span>(y);</span><br><span class="line">        <span class="keyword">if</span> (x == y) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        siz[x] += siz[y];</span><br><span class="line">        f[y] = x;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> siz[<span class="built_in">leader</span>(x)]; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	edges.<span class="built_in">clear</span>();</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v, w;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">		u--,v--;</span><br><span class="line">		edges.<span class="built_in">push_back</span>(&#123;u,v,w&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;<span class="comment">//é€†å‘æ€ç»´ï¼Œæœ€åå‡å»</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">29</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">		<span class="keyword">int</span> cur = ans + (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">		<span class="function">DSU <span class="title">g</span><span class="params">(N)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> [u,v,w] : edges) &#123;</span><br><span class="line">			<span class="keyword">if</span> ((w &amp; cur) == <span class="number">0</span>) &#123;<span class="comment">//ansæ˜¯1çš„ä½ï¼Œå¿…é¡»æ˜¯0</span></span><br><span class="line">				g.<span class="built_in">merge</span>(u,v);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> f = <span class="number">1</span>;<span class="comment">//åˆ¤æ–­æ˜¯å¦è”é€š</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) </span><br><span class="line">			<span class="keyword">if</span> (!g.<span class="built_in">same</span>(<span class="number">0</span>,i)) f = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> (f) ans = cur;<span class="comment">//æ›´æ–°ç­”æ¡ˆ</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; (<span class="number">1</span>&lt;&lt;<span class="number">30</span>)<span class="number">-1</span>-ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week2-day3 - daimayuanoj468. å‡½æ•°æ±‚å’Œ</title>
    <url>/2022/03/07/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week2-day3%20-%20daimayuanoj468.%20%E5%87%BD%E6%95%B0%E6%B1%82%E5%92%8C/</url>
    <content><![CDATA[<h1 id="å‡½æ•°æ±‚å’Œ"><a href="#å‡½æ•°æ±‚å’Œ" class="headerlink" title="å‡½æ•°æ±‚å’Œ"></a><a href="http://oj.daimayuan.top/problem/468">å‡½æ•°æ±‚å’Œ</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>ç›´æ¥çœ‹é¢˜ç›®å§ï¼ˆä¸æƒ³æ•²å…¬å¼.jpgï¼‰</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>ä»å°åˆ°å¤§æšä¸¾a[i]ï¼Œè®¡ç®—æœ‰å¤šå°‘ä¸ªæ•°&amp;a[i]ä¸ç­‰äºa[i]ï¼Œå°±æ˜¯a[i]ç­‰äº1çš„ä½ä¸Šè‡³å°‘æœ‰ä¸€ä¸ªæ˜¯0ï¼Œç­‰äº0çš„ä½ä¸Šéšä¾¿å–ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯power(2,cnt0)*(power(2,cnt1)-1)</p>
<p>ä½†æ˜¯å½“å‰æšä¸¾çš„æ•°å¯èƒ½å†æ›´å°içš„a[i]è¢«æšä¸¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æšä¸¾çš„æ•°è¿˜å¾—æ»¡è¶³&amp;a[j]ï¼ˆj &lt; iï¼‰ç­‰äºa[j]çš„æ¡ä»¶ï¼Œå°±æ˜¯a[j]ç­‰äº1çš„ä½ä¸Šä¸€å®šæ˜¯1ï¼Œç­‰äº0çš„ä½ä¸Šéšä¾¿å–ã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">using</span> i64 = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">norm</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        x += P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= P) &#123;</span><br><span class="line">        x -= P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">power</span><span class="params">(T a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    T res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b /= <span class="number">2</span>, a *= a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span>) &#123;</span><br><span class="line">            res *= a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Z</span> &#123;</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">Z</span>(<span class="keyword">int</span> x = <span class="number">0</span>) : <span class="built_in">x</span>(<span class="built_in">norm</span>(x)) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">val</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    Z <span class="keyword">operator</span>-() <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Z</span>(<span class="built_in">norm</span>(P - x));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Z <span class="title">inv</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(x != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">power</span>(*<span class="keyword">this</span>, P - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>*=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">i64</span>(x) * rhs.x % P;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>+=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x + rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>-=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x - rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>/=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> *= rhs.<span class="built_in">inv</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>*(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res *= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>+(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res += rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>-(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res -= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>/(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res /= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Z ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; K;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> limit = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//limit 1çš„åœ°æ–¹å¿…é¡»æ˜¯0</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//&amp;ç›¸åŒï¼Œä¸€æ˜¯ä¸€</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> sum = K;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) &#123;</span><br><span class="line">			<span class="keyword">if</span> ((limit &gt;&gt; j) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				sum --;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				cnt += ((a[i] &gt;&gt; j) &amp; <span class="number">1</span>) == <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		Z temp = <span class="built_in">power</span>((Z)<span class="number">2</span>,cnt)*(<span class="built_in">power</span>((Z)<span class="number">2</span>,sum-cnt)<span class="number">-1</span>);</span><br><span class="line">		ans += temp * <span class="built_in">Z</span>(i + <span class="number">1</span>);</span><br><span class="line">		limit |= a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; ans.<span class="built_in">val</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week2-day1 - daimayuanoj466. æ‘˜æ¡ƒå­</title>
    <url>/2022/03/05/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week2-day1%20-%20daimayuanoj466.%20%E6%91%98%E6%A1%83%E5%AD%90/</url>
    <content><![CDATA[<h1 id="æ‘˜æ¡ƒå­"><a href="#æ‘˜æ¡ƒå­" class="headerlink" title="æ‘˜æ¡ƒå­"></a><a href="http://oj.daimayuan.top/course/10/problem/466">æ‘˜æ¡ƒå­</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>æœ‰å¤šå°‘ä¸ªå­—ä¸²ï¼ˆè¿ç»­çš„ï¼‰æ»¡è¶³æ‰€æœ‰å…ƒç´ å’Œæ¨¡Kç­‰äºå­—ä¸²çš„é•¿åº¦</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><ul>
<li>é•¿åº¦æ˜¯å’Œæ¨¡Kç›¸åŒï¼Œé‚£ä¹ˆé•¿åº¦ä¸è¶…è¿‡Kï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ»‘åŠ¨çª—å£</li>
<li>æ¨¡Kç­‰äºå­—ä¸²çš„é•¿åº¦ï¼Œä»¤a[i] = a[i] - 1ï¼Œé‚£ä¹ˆå°±æ˜¯å­—ä¸²å’Œæ¨¡é•¿åº¦ç­‰äº0</li>
<li>æ±‚æœ‰å¤šå°‘ä¸ªåŒºé—´å’Œæ˜¯Kçš„å€æ•°ï¼Œæˆ‘ä»¬æŠŠa[i]=%Kç„¶åå†DPä¸€ä¸‹ï¼ŒKå¯èƒ½å¾ˆå¤§ï¼Œè¦ç”¨map</li>
</ul>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; K;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N+<span class="number">1</span>)</span>, <span class="title">sum</span><span class="params">(N+<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i];</span><br><span class="line">		sum[i] = (sum[i<span class="number">-1</span>] + a[i] - <span class="number">1</span>) % K;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; cnt;</span><br><span class="line">	</span><br><span class="line">	cnt[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(i &gt;= K) cnt[sum[i - K]] --;<span class="comment">//é•¿åº¦å¤§äºç­‰äºKäº†ï¼Œå·¦ç«¯ç‚¹å³æ»‘</span></span><br><span class="line">		ans += cnt[sum[i]];</span><br><span class="line">		cnt[sum[i]] ++;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week2-day2 - daimayuanoj467. è·¯å¾„è®¡æ•°2</title>
    <url>/2022/03/06/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week2-day2%20-%20daimayuanoj467.%20%E8%B7%AF%E5%BE%84%E8%AE%A1%E6%95%B02/</url>
    <content><![CDATA[<h1 id="è·¯å¾„è®¡æ•°2"><a href="#è·¯å¾„è®¡æ•°2" class="headerlink" title="è·¯å¾„è®¡æ•°2"></a><a href="http://oj.daimayuan.top/problem/467">è·¯å¾„è®¡æ•°2</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>ç»™ä½ ä¸€ä¸ªN*Nçš„ç½‘æ ¼ï¼Œå†ç»™ä½ Mä¸ªéšœç¢ç‰©çš„åæ ‡ï¼Œé—®ä½ ä»ï¼ˆ1ï¼Œ1ï¼‰ç‚¹èµ°åˆ°ï¼ˆMï¼ŒMï¼‰ç‚¹æœ‰å¤šå°‘ç§æ–¹æ³•ã€‚</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>Nçš„å¤§å°å³1e6ï¼Œè‚¯å®šä¸èƒ½æ­£å¸¸DPï¼Œæ³¨æ„Mçš„èŒƒå›´æ˜¯3000ï¼Œå¯ä»¥æƒ³åˆ°åº”è¯¥æ˜¯ä¸€ä¸ªMæ–¹çš„ç®—æ³•ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰dp[i]æ˜¯ä»ï¼ˆ1ï¼Œ1ï¼‰èµ°åˆ°ç¬¬iä¸ªç‚¹ä¹‹å‰æ²¡ç¢°åˆ°éšœç¢ç‰©åé¢éšä¾¿èµ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç®—dp[i]çš„è½¬ç§»åº”è¯¥ä¸ºæ²¡æœ‰é™åˆ¶ä¸‹ï¼ˆ1ï¼Œ1ï¼‰èµ°åˆ°ç¬¬iä¸ªç‚¹å†å‡å»dp<a href="j&lt;i">j</a>,æŒ‰ç…§ç¬¬ä¸€ä¸ªèµ°åˆ°çš„éšœç¢ç‰©æ˜¯å“ªä¸ªæšä¸¾äº†æ‰€æœ‰ä¸åˆæ³•æƒ…å†µã€‚</p>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">using</span> i64 = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">norm</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        x += P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= P) &#123;</span><br><span class="line">        x -= P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">power</span><span class="params">(T a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    T res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b /= <span class="number">2</span>, a *= a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span>) &#123;</span><br><span class="line">            res *= a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Z</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">Z</span>(<span class="keyword">int</span> x = <span class="number">0</span>) : <span class="built_in">x</span>(<span class="built_in">norm</span>(x)) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">val</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    Z <span class="keyword">operator</span>-() <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Z</span>(<span class="built_in">norm</span>(P - x));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Z <span class="title">inv</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(x != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">power</span>(*<span class="keyword">this</span>, P - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>*=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">i64</span>(x) * rhs.x % P;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>+=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x + rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>-=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        x = <span class="built_in">norm</span>(x - rhs.x);</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Z &amp;<span class="keyword">operator</span>/=(<span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> *= rhs.<span class="built_in">inv</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>*(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res *= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>+(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res += rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>-(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res -= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Z <span class="keyword">operator</span>/(<span class="keyword">const</span> Z &amp;lhs, <span class="keyword">const</span> Z &amp;rhs) &#123;</span><br><span class="line">        Z res = lhs;</span><br><span class="line">        res /= rhs;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    </span><br><span class="line">    vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; <span class="built_in">a</span>(M);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x,y] : a) &#123;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">    a.<span class="built_in">push_back</span>(&#123;N,N&#125;);</span><br><span class="line">    <span class="function">vector&lt;Z&gt; <span class="title">dp</span><span class="params">(M+<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;Z&gt; <span class="title">fact</span><span class="params">(<span class="number">2</span>*N+<span class="number">1</span>)</span>, <span class="title">infact</span><span class="params">(<span class="number">2</span>*N+<span class="number">1</span>)</span></span>;</span><br><span class="line">    fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span>*N; i ++) fact[i] = i * fact[i<span class="number">-1</span>];</span><br><span class="line">  </span><br><span class="line">    infact[<span class="number">2</span>*N] = fact[<span class="number">2</span>*N].<span class="built_in">inv</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>*N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) infact[i] = infact[i+<span class="number">1</span>] * (i+<span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">auto</span> combine = [&amp;](<span class="keyword">int</span> n, <span class="keyword">int</span> m) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; m || n &lt; <span class="number">0</span> || m &lt; <span class="number">0</span>) <span class="built_in"><span class="keyword">return</span></span> (Z)<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> infact[m] * infact[n-m] * fact[n];</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">        dp[i] = <span class="built_in">combine</span>(a[i].first + a[i].second - <span class="number">2</span>, a[i].first - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">auto</span> [x,y] = a[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j ++) &#123;</span><br><span class="line">            <span class="keyword">auto</span> [xx,yy] = a[j];</span><br><span class="line">            <span class="keyword">if</span> (xx &gt; x || yy &gt; y) <span class="keyword">continue</span>;</span><br><span class="line">            dp[i] -= dp[j]*<span class="built_in">combine</span>(x + y - xx - yy, x - xx);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; dp[M].<span class="built_in">val</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week2-day4 - daimayuanoj497. XOR Inverse</title>
    <url>/2022/03/08/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week2-day4%20-%20daimayuanoj497.%20XOR%20Inverse/</url>
    <content><![CDATA[<h1 id="XOR-Inverse"><a href="#XOR-Inverse" class="headerlink" title="XOR Inverse"></a><a href="http://oj.daimayuan.top/problem/497">XOR Inverse</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>ç»™ä½ Nä¸ªæ•°ï¼Œç»™æ¯ä¸ªæ•°éƒ½å¼‚æˆ–ä¸Šxï¼Œæ±‚ä½¿æ–°å¾—åˆ°çš„æ•°ç»„çš„é€†åºå¯¹æœ€å°‘çš„xï¼Œå’Œé€†åºå¯¹æ•°é‡ï¼Œå¦‚æœæœ‰å¤šä¸ªé€†åºå¯¹ç›¸åŒçš„xï¼Œæ±‚æœ€å°çš„xã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>ä»é«˜åˆ°ä½å¯¹äºæ¯ä¸€ä½è€ƒè™‘ï¼Œç„¶åå°†æ‰€æœ‰æ•°æŒ‰ç…§è¿™ä¸€ä½æ˜¯0è¿˜æ˜¯1åˆ†ç»„ï¼Œç»§ç»­é€’å½’ä¸‹å»ã€‚å› ä¸ºä¸åŒç»„ä¹‹é—´è¿™ä¸€ä½ä¸€å®šä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´å¤§å°å…³ç³»å·²ç»ç¡®è®¤äº†ï¼Œæ‰€ä»¥åé¢çš„å˜åŒ–ä¸ä¼šå½±å“ä¸åŒç»„ä¹‹é—´çš„é€†åºå¯¹æ•°é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é€’å½’è€ƒè™‘æ¯ä¸€ç»„å†…éƒ¨çš„é€†åºå¯¹å³å¯ã€‚</p>
<p>æœ€ååªæœ‰æ¯”è¾ƒä¸€ä¸‹xè¿™ä¸€ä½æ”¾1è¿˜æ˜¯0å“ªä¸ªé€†åºå¯¹æ•°é‡å°‘ï¼Œå¦‚æœç›¸åŒæ”¾0ï¼ˆä¿è¯xæœ€å°ï¼‰</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dp[maxn][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">(<span class="keyword">int</span> wei, vector&lt;<span class="keyword">int</span>&gt; a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (wei &lt; <span class="number">0</span> || a.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> o = <span class="number">0</span>,z = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ni = <span class="number">0</span>, ni2 = <span class="number">0</span>;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; x, y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((a[i] &gt;&gt; wei) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            o ++;</span><br><span class="line">            x.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">            ni2 += z;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ni += o;</span><br><span class="line">            z ++;</span><br><span class="line">            y.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[wei][<span class="number">0</span>] += ni;</span><br><span class="line">    dp[wei][<span class="number">1</span>] += ni2;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dp1</span>(wei<span class="number">-1</span>,x);</span><br><span class="line">    <span class="built_in">dp1</span>(wei<span class="number">-1</span>,y);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">dp1</span>(<span class="number">31</span>,a);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">30</span>; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dp[i][<span class="number">0</span>] &lt;= dp[i][<span class="number">1</span>]) &#123;</span><br><span class="line">            ans += dp[i][<span class="number">0</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ans += dp[i][<span class="number">1</span>];</span><br><span class="line">            res |= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 0 1 3 2</span></span><br><span class="line">    <span class="comment">// 0 0 1 1</span></span><br><span class="line">    <span class="comment">// 0 1 1 0</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week2-day5 - daimayuanoj469. Closest Equals</title>
    <url>/2022/03/09/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week2-day5%20-%20daimayuanoj469.%20Closest%20Equals/</url>
    <content><![CDATA[<h1 id="Closest-Equals"><a href="#Closest-Equals" class="headerlink" title="Closest Equals"></a><a href="http://oj.daimayuan.top/course/10/problem/469">Closest Equals</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>é—®ä½ åŒºé—´å†…ä»»æ„ä¸¤ä¸ªç›¸åŒçš„æ•°çš„æœ€å°è·ç¦»</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>å¯¹äºæ¯ä¸ªç‚¹å’Œä»–å‰ä¸€ä¸ªç›¸åŒçš„ç‚¹å¯ä»¥çœ‹æˆä¸€ä¸ªçº¿æ®µçš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œè¿™æ ·é—®é¢˜è½¬åŒ–ä¸ºäº†æ±‚å®Œå…¨åŒ…å«äºè¯¢é—®åŒºé—´å†…çš„æœ€çŸ­çº¿æ®µã€‚</p>
<p>å¦‚æœä¸€æ¡çº¿æ®µiåŒ…å«äºå¦ä¸€æ¡çº¿æ®µjï¼Œé‚£ä¹ˆçº¿æ®µjå¯ä»¥åˆ å»ã€‚å› ä¸ºçº¿æ®µjåœ¨åŒºé—´å†…ï¼Œåˆ™çº¿æ®µiä¸€å®šä¹Ÿåœ¨åŒºé—´å†…ï¼Œè€Œçº¿æ®µiæ›´çŸ­ã€‚</p>
<p>æˆ‘ä»¬æšä¸¾çš„iæ˜¯å³ç«¯ç‚¹ï¼Œæ˜¯é€’å¢çš„ï¼Œæ»¡è¶³ä¸¤ä¸ªçº¿æ®µæ²¡æœ‰åŒ…å«å…³ç³»ï¼Œåˆ™å·¦ç«¯ç‚¹ä¹Ÿæ˜¯é€’å¢çš„ã€‚</p>
<p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥äºŒåˆ†å‡ºä¸€æ®µåŒºé—´ï¼Œè¿™äº›çº¿æ®µæ˜¯åœ¨è¯¢é—®åŒºé—´å†…çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨rmqæŸ¥è¯¢åŒºé—´æœ€å°å€¼ã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); cout &lt;&lt; endl;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> l[maxn], r[maxn], tot;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RMQ</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">highest_bit</span><span class="params">(<span class="keyword">unsigned</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x == <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">31</span> - __builtin_clz(x);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">    vector&lt;vector&lt;T&gt;&gt; range_min;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">RMQ</span>(<span class="keyword">const</span> vector&lt;T&gt; &amp;values = &#123;&#125;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!values.<span class="built_in">empty</span>())</span><br><span class="line">            <span class="built_in">build</span>(values);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">static</span> T <span class="title">better</span><span class="params">(T a, T b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(a, b);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">const</span> vector&lt;T&gt; &amp;values)</span> </span>&#123;</span><br><span class="line">        n = (<span class="keyword">int</span>)(values.<span class="built_in">size</span>());</span><br><span class="line">        <span class="keyword">int</span> levels = <span class="built_in">highest_bit</span>(n) + <span class="number">1</span>;</span><br><span class="line">        range_min.<span class="built_in">resize</span>(levels);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; levels; k++)</span><br><span class="line">            range_min[k].<span class="built_in">resize</span>(n - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span>)</span><br><span class="line">            range_min[<span class="number">0</span>] = values;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; levels; k++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - (<span class="number">1</span> &lt;&lt; k); i++)</span><br><span class="line">                range_min[k][i] = <span class="built_in">better</span>(range_min[k - <span class="number">1</span>][i], range_min[k - <span class="number">1</span>][i + (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))]);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">T <span class="title">query_value</span><span class="params">(ll a, ll b)</span> <span class="keyword">const</span> </span>&#123;<span class="comment">//[a,b),idx from 1</span></span><br><span class="line">        <span class="comment">// assert(0 &lt;= a &amp;&amp; a &lt; b &amp;&amp; b &lt;= n);</span></span><br><span class="line">        <span class="keyword">int</span> level = <span class="built_in">highest_bit</span>(b - a + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">better</span>(range_min[level][a], range_min[level][b - (<span class="number">1</span> &lt;&lt; level) + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; las;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="keyword">int</span> pre = las[x];</span><br><span class="line">        <span class="keyword">if</span> (pre == <span class="number">0</span>) &#123;</span><br><span class="line">            las[x] = i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (pre &gt; l[tot]) &#123;</span><br><span class="line">                l[++tot] = pre;</span><br><span class="line">                r[tot] = i;</span><br><span class="line">            &#125;</span><br><span class="line">            las[x] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(tot)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot; i ++) &#123;</span><br><span class="line">        <span class="comment">// debug(i, l[i], r[i]);</span></span><br><span class="line">        a[i - <span class="number">1</span>] = r[i] - l[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">RMQ&lt;<span class="keyword">int</span>&gt; <span class="title">rmq</span><span class="params">(a)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> L, R;</span><br><span class="line">        cin &gt;&gt; L &gt;&gt; R;</span><br><span class="line">        <span class="keyword">int</span> LL = <span class="built_in">lower_bound</span>(l + <span class="number">1</span>, l + <span class="number">1</span> + tot, L) - l - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> RR = <span class="built_in">upper_bound</span>(r + <span class="number">1</span>, r + <span class="number">1</span> + tot, R) - r - <span class="number">1</span>;</span><br><span class="line">        RR --;</span><br><span class="line">        <span class="comment">// debug(LL, RR);</span></span><br><span class="line">        <span class="keyword">if</span> (RR &lt; LL) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; rmq.<span class="built_in">query_value</span>(LL,RR) &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week2-day6 - daimayuanoj380.Damaged Bicycle</title>
    <url>/2022/03/10/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week2-day6%20-%20daimayuanoj380.Damaged%20Bicycle/</url>
    <content><![CDATA[<h1 id="Damaged-Bicycle"><a href="#Damaged-Bicycle" class="headerlink" title="Damaged Bicycle"></a><a href="http://oj.daimayuan.top/course/10/problem/380">Damaged Bicycle</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>ç»™ä½ ä¸€å¼ Nä¸ªç‚¹ï¼ŒMæ¡è¾¹çš„å›¾ï¼Œå…¶ä¸­Kä¸ªç‚¹æœ‰å…±äº«å•è½¦ï¼Œæ¯è¾†å•è½¦æœ‰p[i]çš„æ¦‚ç‡æ˜¯åçš„ã€‚èµ°è·¯çš„é€Ÿåº¦æ˜¯tï¼Œéª‘è½¦çš„é€Ÿåº¦æ˜¯rã€‚é—®ä½ ä»1å·ç‚¹èµ°åˆ°Nå·ç‚¹çš„æœ€å°æœŸæœ›æ—¶é—´æ˜¯å¤šå°‘ã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><ul>
<li>ç”Ÿæ´»å¸¸è¯†ï¼Œéª‘è½¦çš„é€Ÿåº¦æ¯”èµ°è·¯å¿«ï¼Œæ‰€ä»¥ä¸ºäº†æ—¶é—´æœ€å°ï¼Œä¸€æ—¦æˆ‘ä»¬æˆåŠŸéª‘åˆ°è½¦æˆ‘ä»¬å°†æ²¿ç€æœ€çŸ­è·¯èµ°åˆ°ç»ˆç‚¹ã€‚è€Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯èµ°è·¯ã€‚</li>
<li>èµ°çš„è·¯å…¨éƒ¨éƒ½æ˜¯æœ€çŸ­è·¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é¢„å¤„ç†èµ·ç‚¹ï¼Œç»ˆç‚¹ï¼Œæœ‰è½¦ç‚¹åˆ°å…¶ä»–ç‚¹çš„æœ€çŸ­è·¯ã€‚</li>
<li>ç”¨dp[S][i]çŠ¶å‹ä»£è¡¨SäºŒè¿›åˆ¶ä¸­1çš„å•è½¦éƒ½åäº†çš„æƒ…å†µä¸‹å½“å‰åœ¨iåˆ°ç»ˆç‚¹è¿˜éœ€è¦çš„æ—¶é—´çš„æœ€å°æœŸæœ›ã€‚</li>
<li>è½¬ç§»æ–¹ç¨‹<ol>
<li>è½¦æ˜¯å¥½çš„ï¼Œç›´æ¥éª‘åˆ°ç»ˆç‚¹ã€‚t_car</li>
<li>è½¦æ˜¯åçš„<ul>
<li>èµ°åˆ°è¿˜æ²¡ç¡®è®¤å¥½åçš„è½¦é‚£é‡Œ</li>
<li>èµ°è·¯åˆ°ç»ˆç‚¹</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>ç­”æ¡ˆæ˜¯1+minï¼ˆ2ï¼‰</p>
<ul>
<li>dp[s][i] = dp[s | (1 &lt;&lt; j)][j] + d[i][j] / v_walk;</li>
<li>æœ€åæšä¸¾åœ¨å“ªä¸ªç‚¹æ‰«åˆ°è½¦å°±å¥½äº†ï¼Œæ—¶é—´æ˜¯d[k][i] / t_walk + dp[1&lt;&lt;i][i];</li>
</ul>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	<span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxm = <span class="number">5e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> e[maxm],w[maxm],ne[maxm],h[maxn],idx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">	e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dis[maxn];</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">21</span>][<span class="number">21</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(dis));</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">st</span><span class="params">(maxn+<span class="number">7</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	dis[u] = <span class="number">0</span>;</span><br><span class="line">	priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; , vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt;, greater&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt;&gt; heap;</span><br><span class="line">	heap.<span class="built_in">push</span>(&#123;<span class="number">0</span>, u&#125;);      <span class="comment">// firstå­˜å‚¨è·ç¦»ï¼Œsecondå­˜å‚¨èŠ‚ç‚¹ç¼–å·</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (heap.<span class="built_in">size</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = heap.<span class="built_in">top</span>();</span><br><span class="line">        heap.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ver = t.second, distance = t.first;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (st[ver]) <span class="keyword">continue</span>;</span><br><span class="line">        st[ver] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[ver]; i != <span class="number">-1</span>; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> j = e[i];</span><br><span class="line">            <span class="keyword">if</span> (dis[j] &gt; distance + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[j] = distance + w[i];</span><br><span class="line">                heap.<span class="built_in">push</span>(&#123;dis[j], j&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> dp[<span class="number">1</span>&lt;&lt;<span class="number">20</span>][<span class="number">18</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*(maxn));</span><br><span class="line">	<span class="keyword">int</span> t, r;</span><br><span class="line">	cin &gt;&gt; t &gt;&gt; r;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u, v, w;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">		<span class="built_in">add</span>(u, v, w);</span><br><span class="line">		<span class="built_in">add</span>(v, u, w);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; K;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(K + <span class="number">2</span>)</span>, <span class="title">p</span><span class="params">(K)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) &#123;</span><br><span class="line">		cin &gt;&gt; a[i] &gt;&gt; p[i];</span><br><span class="line">	&#125;</span><br><span class="line">	a[K] = <span class="number">1</span>;</span><br><span class="line">	a[K + <span class="number">1</span>] = N;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K + <span class="number">2</span>; i ++) &#123;</span><br><span class="line">		<span class="built_in">dijkstra</span>(a[i]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K + <span class="number">2</span>; j ++) &#123;</span><br><span class="line">			d[i][j] = dis[a[j]];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (d[K][K + <span class="number">1</span>] == INF) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> S = (<span class="number">1</span> &lt;&lt; K) - <span class="number">1</span>; S &gt;= <span class="number">0</span>; S --) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) &#123;</span><br><span class="line">			<span class="keyword">if</span> ((S &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">double</span> pbad = <span class="number">0.01</span> * p[i];</span><br><span class="line">				<span class="keyword">double</span> t_car = <span class="number">1.</span> * d[i][K + <span class="number">1</span>] / r;<span class="comment">//å¼€è½¦åˆ°ç»ˆç‚¹</span></span><br><span class="line">				<span class="keyword">double</span> t_walk = <span class="number">1.</span> * d[i][K + <span class="number">1</span>] / t;<span class="comment">//èµ°è·¯åˆ°ç»ˆç‚¹</span></span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) &#123;</span><br><span class="line">					<span class="keyword">if</span> ((S &gt;&gt; j) &amp; <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">					t_walk = <span class="built_in">min</span>(t_walk, <span class="number">1.</span> * d[i][j] / t + dp[S | (<span class="number">1</span> &lt;&lt; j)][j]);</span><br><span class="line">				&#125;</span><br><span class="line">				dp[S][i] = pbad * t_walk + (<span class="number">1</span> - pbad) * t_car;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">double</span> ans = <span class="number">1.</span> * d[K][K + <span class="number">1</span>] / t;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) &#123;</span><br><span class="line">		ans = <span class="built_in">min</span>(ans, <span class="number">1.</span> * d[K][i] / t + dp[<span class="number">1</span> &lt;&lt; i][i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// cout &lt;&lt; ans &lt;&lt; endl;</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%.7lf&quot;</span>,ans);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>namomoæ¯æ—¥ä¸€é¢˜week3-day4 - daimayuanoj555. æ•´é½çš„æ•°ç»„2</title>
    <url>/2022/03/15/namomo%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98week3-day4%20-%20daimayuanoj555.%20%E6%95%B4%E9%BD%90%E7%9A%84%E6%95%B0%E7%BB%842/</url>
    <content><![CDATA[<h1 id="æ•´é½çš„æ•°ç»„"><a href="#æ•´é½çš„æ•°ç»„" class="headerlink" title="æ•´é½çš„æ•°ç»„"></a><a href="http://oj.daimayuan.top/course/10/problem/555">æ•´é½çš„æ•°ç»„</a></h1><h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>é€‰æ‹©ä¸€ä¸ªkï¼Œå¯ä»¥å¯¹ä»»æ„æ•°æ‰§è¡Œè‹¥å¹²æ¬¡ï¼Œæœ€åèƒ½å¤Ÿè®©æ•°ç»„è‡³å°‘ä¸€åŠç›¸åŒã€‚é—®æ»¡è¶³æ¡ä»¶çš„æœ€å¤§çš„kï¼Œå¦‚æœkå¯ä»¥ä»»æ„æ‰“ï¼Œè¾“å‡º-1ã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>é¦–å…ˆï¼Œå¦‚æœå¼€å§‹æ•°ç»„æœ‰ä¸€åŠç›¸åŒï¼Œé‚£ä¹ˆç›´æ¥è¾“å‡º-1.</p>
<p>å¦åˆ™ï¼Œæšä¸¾æœ€åç›¸åŒçš„æ•°æ˜¯a[i]ï¼Œå…¶ä»–æ•°éƒ½å’Œa[i]ä½œå·®ï¼Œå¾—åˆ°bæ•°ç»„ï¼Œå½“kæ˜¯b[j]çš„å› å­ï¼Œåˆ™a[j]å¯ä»¥é€šè¿‡è‹¥å¹²æ¬¡æ“ä½œå˜æˆa[i]ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ ¹å·æšä¸¾b[j]<br>ã€‚å¹¶ç”¨mapè®°å½•æ¬¡æ•°ï¼Œå¦‚æœå¤§äºä¸€åŠåˆ™æ›´æ–°ç­”æ¡ˆã€‚</p>
<ul>
<li>æšä¸¾å› å­æ—¶ï¼Œå¦‚æœb[j]æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œé‚£ä¹ˆåªèƒ½åŠ ä¸€æ¬¡</li>
<li>å¦‚æœb[j]å’Œa[i]ç›¸ç­‰ä¸ä¼šè¢«æ ¹å·æšä¸¾ï¼Œä½†æ˜¯å¯ä»¥æ“ä½œ0æ¬¡å’Œa[i]ç›¸ç­‰ï¼Œå¯ä»¥åœ¨å¤„ç†bæ•°ç»„æ—¶ç»Ÿè®¡ã€‚</li>
</ul>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); cout &lt;&lt; <span class="meta-string">&quot;\n&quot;</span>;&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">  cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;   &quot;</span>;</span><br><span class="line">  <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rd</span><span class="params">(T&amp; t)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">int</span> s=<span class="number">0</span>,w=<span class="number">1</span>;</span><br><span class="line">   <span class="keyword">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">   <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">&#x27;-&#x27;</span>)w=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">   <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) s=s*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>,ch=<span class="built_in">getchar</span>();</span><br><span class="line">   t = s*w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span>... Args&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rd</span><span class="params">(T&amp; t, Args&amp;... args)</span></span>&#123;<span class="built_in">rd</span>(t);<span class="built_in">rd</span>(args...);&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N)</span></span>;</span><br><span class="line">    map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; cc;</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">        <span class="comment">// debug(a[i]%13);</span></span><br><span class="line">        cc[a[i]] ++;</span><br><span class="line">        <span class="keyword">if</span> (cc[a[i]] &gt;= N / <span class="number">2</span>) &#123;</span><br><span class="line">            f = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; b;</span><br><span class="line">        <span class="keyword">int</span> z = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j ++) &#123;</span><br><span class="line">            b.<span class="built_in">push_back</span>(a[i] - a[j]);</span><br><span class="line">            z += (a[i] - a[j] == <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j ++) &#123;</span><br><span class="line">            b.<span class="built_in">push_back</span>(a[j] - a[i]);</span><br><span class="line">            z += (a[i] - a[j] == <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(b.<span class="built_in">begin</span>(),b.<span class="built_in">end</span>());</span><br><span class="line">        cc.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; b.<span class="built_in">size</span>(); j ++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= <span class="built_in">sqrt</span>(b[j]); k ++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (b[j] % k == <span class="number">0</span>) &#123;</span><br><span class="line">                    cc[k] ++;</span><br><span class="line">                    <span class="keyword">if</span> (cc[k] + <span class="number">1</span> + z &gt;= N / <span class="number">2</span>) &#123;</span><br><span class="line">                        ans = <span class="built_in">max</span>(ans, k);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (k*k != b[j]) &#123;</span><br><span class="line">                        cc[b[j] / k] ++;</span><br><span class="line">                        <span class="keyword">if</span> (cc[b[j] / k] + <span class="number">1</span> + z &gt;= N / <span class="number">2</span>) &#123;</span><br><span class="line">                            ans = <span class="built_in">max</span>(ans, b[j]/k);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">  cin &gt;&gt; T;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>ä¸‰è§’æœè®¡æ•°</title>
    <url>/2022/01/18/%E4%B8%89%E8%A7%92%E6%9E%9C%E8%AE%A1%E6%95%B0/</url>
    <content><![CDATA[<p><a href="http://oj.daimayuan.top/problem/505">ä¸‰è§’æœè®¡æ•°</a></p>
<h1 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h1><p>æ±‚ä¸€ä¸ªæ•°ä¸Šæœ‰å‡ ç§ä¸‰ç‚¹çš„é›†åˆï¼Œä»–ä»¬ä¸¤ä¸¤çš„æœ€çŸ­è·¯èƒ½å½¢æˆä¸€ä¸ªä¸‰è§’å½¢ã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>æˆ‘ä»¬æšä¸¾ä¸¤ä¸ªç‚¹ï¼Œçœ‹æœ‰å¤šå°‘ä¸ªç¬¬ä¸‰ç‚¹æ»¡è¶³æ¡ä»¶ã€‚</p>
<p>å½“ä¸‰ä¸ªç‚¹åœ¨åŒä¸€æ¡é“¾ä¸Šæ—¶ï¼Œä»–ä»¬çš„æœ€çŸ­è·¯å§‹ç»ˆæ»¡è¶³è¾ƒå°ä¸¤è¾¹åŠ èµ·æ¥ç­‰äºç¬¬ä¸‰è¾¹ï¼Œä¸æ»¡è¶³ä¸‰è§’å½¢ã€‚</p>
<p>æˆ‘ä»¬æšä¸¾çš„æ˜¯å…¶ä¸­ä¸¤ä¸ªç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œç„¶ååœ¨ä»–çš„ä¸¤ä¸ªå­æ ‘ä¸­å„é€‰ä¸€ä¸ªä½œä¸ºå…¶ä¸­ä¸¤ä¸ªç‚¹ï¼Œé‚£ä¹ˆç¬¬ä¸‰ç‚¹çš„æ•°é‡å°±æ˜¯é™¤äº†è¿™ä¸¤æ£µå­æ ‘å’Œè¿™ä¸ªç‚¹ä»¥å¤–çš„æ‰€æœ‰ç‚¹ã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&quot;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">&#x27;,&#x27;</span>, <span class="meta-string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt;</span> _it(_ss); err(_it, args); cout &lt;&lt; <span class="meta-string">&quot;\n&quot;</span>;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">  cerr &lt;&lt; *it &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;   &quot;</span>;</span><br><span class="line">  <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> e[maxn],w[maxn],ne[maxn],h[maxn],idx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">  e[idx] = b, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">  e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> siz[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// siz[u] = 1;</span></span><br><span class="line">    <span class="comment">// int x = 1;</span></span><br><span class="line">    <span class="comment">// int f = 0;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[u]; i != <span class="number">-1</span>; i = ne[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span> (j == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(j, u);</span><br><span class="line">        <span class="comment">// x *= siz[j];</span></span><br><span class="line">        ans += siz[j] * siz[u] * (N - siz[u] - siz[j] - <span class="number">1</span>);</span><br><span class="line">        siz[u] += siz[j];</span><br><span class="line">    &#125;</span><br><span class="line">    siz[u] ++;</span><br><span class="line">    <span class="comment">// debug(u, ans, siz[u]);</span></span><br><span class="line">    <span class="comment">// if (f) ans += x * (N - siz[u]);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*(maxn));</span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        <span class="built_in">add</span>(u, v);</span><br><span class="line">        <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// a + b, a + c, b + c;</span></span><br><span class="line"><span class="comment">// a - b, a + c, b + c;</span></span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>åŸºå°”éœå¤«çŸ©é˜µ</title>
    <url>/2022/02/21/%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB%E7%9F%A9%E9%98%B5/</url>
    <content><![CDATA[<p>Matrix-Tree å®šç†åˆç§°åŸºå°”éœå¤«çŸ©é˜µæ ‘å®šç†ï¼Œå…¶ç”¨äºè§£å†³ï¼šç»™å®š n ä¸ªç‚¹ m æ¡è¾¹çš„æ— å‘å›¾ï¼Œæ±‚å›¾çš„ç”Ÿæˆæ ‘ä¸ªæ•°çš„é—®é¢˜ã€‚</p>
<p>ã€åŸºå°”éœå¤«çŸ©é˜µã€‘</p>
<h1 id="1-åŸºæœ¬å®šä¹‰"><a href="#1-åŸºæœ¬å®šä¹‰" class="headerlink" title="1.åŸºæœ¬å®šä¹‰"></a>1.åŸºæœ¬å®šä¹‰</h1><p>1ï¼‰æ— å‘å›¾ ğºï¼šç»™å®š ğ‘› ä¸ªç‚¹ï¼Œğ‘š æ¡è¾¹çš„æ— å‘å›¾ï¼Œè®¾ç‚¹é›†ä¸º ğ‘‰ï¼Œè¾¹é›†ä¸º ğ¸ï¼Œåˆ™å…¶è®°ä¸º ğº(ğ‘‰,ğ¸)<br>2ï¼‰åº¦æ•°çŸ©é˜µ ğ·[ğº]ï¼šå½“ ğ‘–â‰ ğ‘— æ—¶ï¼Œğ·[ğ‘–][ğ‘—]=0ï¼Œå½“ ğ‘–=ğ‘— æ—¶ï¼Œğ·[ğ‘–][ğ‘—]=ç‚¹ğ‘£çš„åº¦æ•°<br>3ï¼‰é‚»æ¥çŸ©é˜µ ğ´[ğº]ï¼šå½“ ğ‘£ğ‘–ã€ğ‘£ğ‘— æœ‰è¾¹è¿æ¥æ—¶ï¼Œğ´[ğ‘–][ğ‘—]=1ï¼Œå½“ ğ‘£ğ‘–ã€ğ‘£ğ‘— æ— è¾¹è¿æ¥æ—¶ï¼Œğ´[ğ‘–][ğ‘—]=0<br>4ï¼‰åŸºå°”éœå¤«çŸ©é˜µ(Kirchhoff) ğ¾[ğº]ï¼šä¹Ÿç§°æ‹‰æ™®æ‹‰æ–¯ç®—å­ï¼Œå…¶å®šä¹‰ä¸º ğ¾[ğº]=ğ·[ğº]âˆ’ğ´[ğº]ï¼Œå³ï¼šğ¾[ğ‘–][ğ‘—]=ğ·[ğ‘–][ğ‘—]âˆ’ğ´[ğ‘–][ğ‘—]<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATsAAACgCAMAAABE1DvBAAABmFBMVEX///8AAACTk5P6+vqqqqo0NDR5eXnV1dVbW1vAwMDl5eW2trb39/d/f3+kpKRISEhmZmbLy8vx8fHb29uxsbE3Nzeampo/Pz/0///j4+OGhoZubm7r6+va6/69vb1gYGD///jk2LZ7XEogICAtLS22kofa+fxPT09mh6b///Dt///86tv+8eaHnaWLf3eWf3cTExMcHBz//+WCjo6LprLM7fO+1escMEvj0LTFurHs+P/538qQssP/8diuiX/u49q5xNHJtbWljIKAi6CjmYbTr5Z/jZasjnqMhY24qaTEopTbzsNLMypKRUxvX1B4lKlvSzVBIBiBYUO8nn6du9xLNDR3UzKmxtqFqc4AADN2SRokQ2W0t8I2GSFZQB+kmX+siF86AACVb0gAABhOcZeZe14lHzYsHhAyQU5hbolTYHMiCyLlxqlFXHtgQzU2P2QtAABBWH9nY02Bmr1WbXCIdHiJc2RXeYtzd4SHYDHDsJQALVnz0ba9qY0vS2WkvMdxUVF9gqHG4P+Pe2ikqr1RKQClpZeCfpOzQaRQAAAQ6klEQVR4nO2djV/bxhnH7yz5Dcs2fsHglxi1uHMdO4GwhNqk1AQSArht1iYrW5s1XddtbUbadVnajo1mTVjyb0+nu5PvHlmyRDDBWL/kY1vnu9Ojr+90d48eCYQCBZpwKYryuk0YT0WTsxjjej7A51fFME5VjPfMNC68blvGTEVc4h+n6uXXacnYqYijwlYAz4+WQuS1V12lmzjxOo0ZL8WXyKteff8C3c7gYSVy0ag2WpvGRfNV+v4mY4euFN2yZ8p4NjyD60HrNFRjbchiFwo5Z9ZmcCJL3uM1nBu1ZWdeuSvsg8UuU3fMrOCk9TmOXdvnJMjOLj7rBEWTxpHcxLe8Ae0OhzGeDoUqlQrIm6QtUi/SLxILp2LhGRZmhCx2kTyaqiRCIWORNlNLqiriCzUNk1Mduv5B6MM7tGgUTbaSKfr+G84O9ycg0WgqksR4ab5ejVdRgk6bPzIyfrxCPqlJNNnKgflcaNaWpVKNz8fmMc6QDZ283r1HPmaHTgXPu2IlcSvrPALgKf5J/y1dhOCJ97tcESZ0Gs475uuz+2SPpUw8O3Qlxqmk3FazfFRBn/yOpwTsUAin89ForoRn3KZsBda5P+bo4rFRGzYWypRr4XC95JqHDQ1f/j4UKq2TT/XqyO0aGxWxm3+kUjDPhVpxqlgskpkeHKEnW9OOLvepQhiXEjLbcGr0Fo2Ppga3JC0Rw9NxRNb/2X7qgou/ZRI1beeRTdQpOKIqLrGmp+IAnawKnHVE0zicUcQMOJZX82WcnvS1rF3SIiMTwbOq7EzJYS1ejkTyWRQIqmINB9EITqu2cXc2c8oGjZPoBLiSxEulAYuGfPi07RkrYa1SqOHQYN8xDpqdiyrTC7jktDJTp0/VlrGSlsC47Lxa0HAwRAwWn8gVHFe1kchp2nPmlFNnwrVBfTJfx2U2kXNa1WYnutkllnAhF82lFrAqpZsTOWsr5XAZouzsFj3/imC+tsos9M/6tomcMviq9fBAlXOspHgVh8WKGeDCKpzIpeyXewzVJrjZqXK7SReIRw6HpgZkHXThNbM0GrPGQuwS4c305hz5kMOzjhO5woCGN8nhJ5m0+fbpPdT+zPw07eK6tF9oDKVHY9ZYqGServT7xssfzBNcfN45c8pGaqIDd/isTd/5nF3nchs34Rkv4n4Z6JyLT2z16IPP5miKS25VbngV16tA517C0X9xj6a4ZicjSzEapcSHXH0870qbw2z7bcQjcaKuvjg1nYuQyOKldD64mpink+HP95T2O2afTbpeItQwTpE2p2RmcWZhwi9is5W8frN8yRxmNQzDOiWJizY88d7iiDwnibj6MZfEq9yVwF1cE6+oppbcRs6C3NIm2g1AtZDkvJSSe/iXtQDrXaMlJ/yEZ2iarmBzIVx3RWfdYqH/kbILosVILNMMxrhWGOQ8EVTg7qYv/0TZKRPtMrbk5d72GbYi2//qz5SdEC8byF3s6n/rL3NfBux8irW7j1dQ0O78iq5BerFY7K9fm7esRGuv16AxkmLN51ifLQchnp4V49PojnkTymRfmfWpKfn8NuEuKJ+Kipd20sGzK3wpisusnybwZIehHEPZMk7nVTW5FJ54J8pxlClHIqqrly9QoECBAgUaA+lTxWIwnh1Pb7wTCn349YXhGcdRy98g1H64Oqrq3yBX65t/G1n9NukfnNqu0PJ36NZno6veZIf23x7dHoD28cqp7Wv50e5XI6yeslse4a8D9G3m9Pa1jO+MsnrKrvGdldBbBzn0hJzSSczBSnx4xdtfoX9JDa+lwup6eekM0s3bzsZZmwWDtfz3RyBn9/6QvYFNIsejo+za/aat/RrkWJxbOxIrv9bYBDnaPnr8p3fiD+R+9Nav5Bz7e2hb2GzdR3cBPL3u8fS8/P0+bOSLF+XtWyuNl+Le1tFNUHnrZ6fqTXatj/rW6YCdHkWNLSlh50jO0frHY6fabbr+c7wa/1ZiAdnl4AH2noC2cvufXtl9hw6/l5MguyhCcvW9bTkD+uFHp+rJHOXyjNCLIDtDz+XfvfuT/PXlhnd2Zn/dlxoeZGe0Y7k+7YE8urTvwabhJIMduiu3csgOoYM9eW8b8tEerDg+nYDMjaUQfDu7RamyjPG7S0d78PbBI69TnOv/NnfxvlijjV1POsF3L6C1d8WExgfxDz0O1Q3SQ3akzDZ2B1Ll3VX0H4ll82E85nn2a+uzb96prgvbvcIL0GfRsufzXbfCLezrPcDu4J2qeL5ubCe2pU6lINspyYcgu8Of4+LY19rubMK9gW4W6EQVDQEV/Cf4uu0LFh5evy1DyPP1x+zQvRWG782x9tSMnLkQngZ14RKoC4Pqy75uwMGgtgisLjY71CLPE8spWPl0DVQ+GwMJOAL35swOXggtw6BBW5QwrCzqjx3YzsHQYtszPe0W+WAHEqrw4mVJBQm2h8q5sIOWTsNn+UFLNVhZ5pXY2QJP/FvkLBu7BIx5tsXeh+EdlQE7poBdwI6Ks+vwqfo4sNtZJ6/M0paaYhNPZmlv6+aKZOnB1Zt0os3Z3TwK0SIe2fUKoimHvDRn173K8nGLSjtPJYu6/+WzaS/seuYYwNm9yJfo3vrsdukyhrHrbu2wdQVnZ+1uELvr7wqWLs7pLyVLjVn1E9HSxi9Ip8tlxu6Ne+g6XWl4bXeLc31T1h6jJi3N2TUBO2MRsbEqWtRfxXlqd2YtjF1znR2twK51iWaj7ErW4Vrt7j2v7LKowdYg1FJ9y1i/XhQsXbtj7gBZ7Pb3UJP+dMdh195DLVrakd1FdGtFsMgvO9PYfp+9TTuNCzu2XPfPDqEfpD5L2G2I7JYfG0sCc7vf7tjhHoedUZoZ79Ludq8JFr0au0PWIym7bn4dsDNW82/RwzXZdYyltXd2l7nXgFm6e6G5KVm6sdqmN8EydkYPPqTt4jjslBI6oKWd2PUsX+gJsOPoHNvd7gp37Xpqd82nfUv155e414Rb2rkvW6rnWQY+VrTybAbuld2GwM4YnFhpa47Cb8Lgv2YvPydb1OO+EE/szJGJseuqVWZsn51OGfFxtsO98ha7HksYgznKK1jkrAmZ372CRc4K2J1ZdmfPjzLcouOzi5+kH0XFM2FRM0sLIAGHgWCJBV+3a8LSNVt1S0Mt8sHOf+U1mOBYe2o6FxWVixVAAo5L29EMBhlU5z8vNoidXDqar4HqSuWhFvlgB4oWYiChXAIJtbxsn8sTM2xnl7Lt7AL6rHKy5zsPvs8TPN9Vg7HC686CcTZg52DKWLLLmM5GbmmX30vjaGmGOSc5Oz3DvAce2bE9sNJdPhXg7FoZtgZiFnVD/GIz9yhaswlP/rt18tpn16PPauHsunxvFrsWA9Bn16uIBgvSQ6vmYpyvvK92tyRLUZf7cbkv4AKL4OC+gNIqC+Hwxm5/b21TMCXLbxlj7FqbWeae5L+mdSmfW3SZV+WB3cGKGcUltDtamrFrPtVLFJ7FTlsU/CimetQ7YWfXWqeeCyePT+dp70i0dPmXAT4o6k/0xq7KHCncFD4DZuwOnvGIEEd21pzZA7v71JfpxM44/iRgh96D7JpO7BCLc+Ls5qCnEck+KBJYI/s+V/z6PmmckwO7u9e4a/dE2Bk/BvGYUXat/P05yK6XpK38eOyerwiWknYne7hbL6R21zDaHfS5N3353Nubkin+2501hnhh1zZ/CKd2VzH93malJjvT1ymyI95RR3b683fNGyyYpc1L3UuSpVngc0eH68xZyceKjdxNP9d62g+niqIp4Hynl3JscODsNsBYgayHbUnstKmKpSnrQSwHP5p7E9jRoYCxax91t4/fZ/ViMSewQy0+7jFLN3Jd2W+M+L0s1jib8zXOTk3lcqIpPB6Hj7N6Th5n+3Kfo9zAgp7xVOPoADsq3mez/HD77JhBwhyFphxjftfjk5YzPr/LiotPGKAXzI3P3tyYKmAHEvyxU0Sh6TxIwEVpW8likEFmdyM8ayk8IGQXlo6GQYIHi/ywk4sa7OQEg52cYLADe3OsXcWvLsn3mYkkLUUGsTsBiewqcUH2890JyJGd3eceBwm2J+ScrM+9+Io+9xviYT4DOUfrcx//853UwYCCseIMjxWyAnZwb461B+xAghd2vdQLwX+HOqocu4h2eDgIszTLDebsuuo6/eCNnR5KXBVMafLSVuwiP2k7WaRDi9zUCnVIuA1n11MZEc/sWnn+iw1gV0Fm5A+z1Fjns78kydezqy15PVvh9/0xdsbXB37ioJRVelMnLd3Y5o4M7gtgYVI+LHKTNoeer/ZjFzfRIYy/26Erfc5ul99fxtgtrq6xWwMH9dnW8z0k+qBuib5PW/wdso7t2PF3nYd9U2zxd2uQnQeLXHVI7nZj7Paf8Rv7nGLIUIuHsFF2y3eMvdGEwee7Hy5Kvk9o6W1XdkazWfPn+6QtrR/3OYQd8MYOsMhdpDRjZ3wcxq4psyOHtuH4B0u258z4YWap0aTl6N5t7up0Yrd2hK7TXufRf3ePsuiXluKNG5CdB4tcZPT43X6fNfbNzhBOcZ+QHXrZ35u9dl1NrPYtbYVAVHlza0eOc4fs0MFRiqZ4bHcd+gCCfmk5zh2y82CR697Mxw3wsWL3PkPk3O6Y65eza196wRaUJzFHgeOspfGco7TWzTfrfLfO0oP5HVMwNx4bdkNjF89XHFTJxs6HHyWWER1g8Uy9FJcTsConVLFcIl7wF38nF46nFkB1yfmhFvlgByov1UHl8xFQeS0FDHTxfV6Zj4maX5iNyQm4LifEsFwilvbHDpSuw4SZ2lCLfLADlc8ugMprMyBhCRzuvB/f57mONw7u2z6rY0XADu7NsfaAHUjwxu666L+zNEJ2R4NMGRU7HcTfUZ0QO/1/AjslxBeL/C7pUIqv56ilvaMCXYDy2EW1wwKlvLK7+71gSvcJu02Qs7Ouxnm2yF1fCD4oYj4NzezH3y1StxFjZ6yeWeWcXYPfeziI3W3RbzzUa6G/ROwuScaOeCro4Xtkt7Z1p29Kw7qjk8d9/sD+Ts/J+FFQu0Bcl86xi9zlxthtzPHKGTt9m/jJ+gbLld9rC+yG+u+IF1WKXTT0xE8Mmf4TEmJm1yA7Hnbqx6PootY3DV/sbPdt60WX2MVO9cFjH5ba7ts2vmd9yhu7br5jPjb3dNj1Ep1Hlv/OFvfZy18YwA7E3+ll2jQGjhVNIWbW6IGX5wRLjUbckK8ObHM3sfWcCv6AOc9jxbpoyjB2xCKpz9oscleD7M17n13V2fMSODud9SoPc5SdHWY7vyqV4k+jY5Y2U+xxY4xdb4s/r+54c5QbLCTWid1wizxIYEet77PrSex0lV+V49fJvr2aiEoG23Vm5nddHiI7FvM7U2eG3StY5KyA3ZllF/hRZPnxoywkI6KSC/WInIDLckIEyyUiMX/sQOlpkJBM14Za5IMd2FsdHm44DRLwPNybY+05FSjvPwFGO7oKFh5evy2D6vaHuyVpQ/c2/OhgwwwUaIA0Egnab5iapplpsqQIUYV+n1XMjBpSjE9GDVnyppjJk/J3NQ1YSjarZY2D14wNZHxS2GeDjLFhfmO8GmTYR0WjOc33rEEvSzdJBuOdpE2GskZLUSgJ0pAUxUgg2LLGO2lOCkFJUulH8p25ZcIidHlTJV9Sqprn8+uYi7EzWpNCWBEGpOWZ+BTjG0Uxv88SrCSdfIVYdsaOQSYNMmtmzw7/Y+vnQgr5Z3ZJTaEbGnvR6AnM+sYEYn5BWiBJRPS/xr8hYskTpAFHq0zKWStQoECm/g+AcAmRda07LQAAAABJRU5ErkJggg==" alt=""></p>
<h1 id="2-åŸºå°”éœå¤«çŸ©é˜µæ€§è´¨"><a href="#2-åŸºå°”éœå¤«çŸ©é˜µæ€§è´¨" class="headerlink" title="2.åŸºå°”éœå¤«çŸ©é˜µæ€§è´¨"></a>2.åŸºå°”éœå¤«çŸ©é˜µæ€§è´¨</h1><p>å¯¹äºä»»æ„ä¸€ä¸ªå›¾ ğºï¼Œå…¶åŸºå°”éœå¤«çŸ©é˜µ ğ¾ å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p>
<p>1.åŸºå°”éœå¤«çŸ©é˜µ ğ¾ çš„æ¯ä¸€è¡Œæˆ–æ¯ä¸€åˆ—ä¸Šçš„å…ƒç´ å’Œéƒ½æ˜¯ 0<br>2.åŸºå°”éœå¤«çŸ©é˜µ ğ¾ çš„è¡Œåˆ—å¼çš„å€¼ä¸º 0<br>3.åŸºå°”éœå¤«çŸ©é˜µ ğ¾ çš„ä»»æ„ä¸€ä¸ªä»£æ•°ä½™å­å¼å€¼éƒ½ç›¸åŒ<br>4.å¦‚æœå›¾ ğº ä¸è¿é€šï¼ŒåŸºå°”éœå¤«çŸ©é˜µ ğ¾ çš„ä»»æ„ä¸»å­å¼è¡Œåˆ—å¼å€¼ä¸º 0<br>5.å¦‚æœå›¾ ğº æ˜¯ä¸€æ£µæ ‘ï¼ŒåŸºå°”éœå¤«çŸ©é˜µ ğ¾ çš„ä»»æ„ä¸€ä¸ª ğ‘›âˆ’1 é˜¶ä¸»å­å¼çš„è¡Œåˆ—å¼ä¸º 1</p>
<h1 id="3-Matrix-Tree-å®šç†"><a href="#3-Matrix-Tree-å®šç†" class="headerlink" title="3.Matrix-Tree å®šç†"></a>3.Matrix-Tree å®šç†</h1><p>Matrix-Tree å®šç†çš„å†…å®¹ä¸ºï¼šå¯¹äºå·²ç»å¾—å‡ºçš„åŸºå°”éœå¤«çŸ©é˜µï¼Œå»æ‰å…¶éšæ„ä¸€è¡Œä¸€åˆ—å¾—å‡ºçš„çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œå…¶ç»å¯¹å€¼ä¸ºç”Ÿæˆæ ‘çš„ä¸ªæ•°</p>
<p>å› æ­¤ï¼Œå¯¹äºç»™å®šçš„å›¾ ğºï¼Œè‹¥è¦æ±‚å…¶ç”Ÿæˆæ ‘ä¸ªæ•°ï¼Œå¯ä»¥å…ˆæ±‚å…¶åŸºå°”éœå¤«çŸ©é˜µï¼Œç„¶åéšæ„å–å…¶ä»»æ„ä¸€ä¸ª ğ‘›âˆ’1 é˜¶è¡Œåˆ—å¼ï¼Œç„¶åæ±‚å‡ºè¡Œåˆ—å¼çš„å€¼ï¼Œå…¶ç»å¯¹å€¼å°±æ˜¯è¿™ä¸ªå›¾ä¸­ç”Ÿæˆæ ‘çš„ä¸ªæ•°ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>å­ä¸²çš„æœ€å¤§å·®</title>
    <url>/2022/02/27/%E5%AD%90%E4%B8%B2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%B7%AE/</url>
    <content><![CDATA[<p><a href="http://oj.daimayuan.top/problem/436">#436. å­ä¸²çš„æœ€å¤§å·®</a></p>
<h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ï¼Œæ±‚æ‰€æœ‰åŒºé—´çš„ï¼ˆæœ€å¤§å€¼-æœ€å°å€¼ï¼‰çš„å’Œã€‚</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å¯¹äºæ¯ä¸ªæ•°è®¡ç®—å®ƒçš„è´¡çŒ®ã€‚è´¡çŒ®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ä½œä¸ºæœ€å¤§å€¼ï¼Œä¸€éƒ¨åˆ†æ˜¯ä½œä¸ºæœ€å°å€¼ã€‚å½“a[i]ä½œä¸ºæœ€å¤§å€¼ï¼Œä½ è¦æ‰¾åˆ°å®ƒå·¦è¾¹ç¬¬ä¸€ä¸ªå¤§äºç­‰äºï¼ˆå¯èƒ½å­˜åœ¨è¿ç»­ç›¸ç­‰çš„æ•°ï¼Œé¿å…é‡å¤å·¦é—­å³å¼€ï¼‰ä»–çš„æ•°ä½ç½®lå’Œå³è¾¹ç¬¬ä¸€ä¸ªæ¯”ä»–å¤§çš„æ•°ä½ç½®rï¼Œé‚£ä¹ˆå½“å‰æ ‘çš„è´¡çŒ®æ˜¯a[i] <em> ï¼ˆi-lï¼‰</em> ï¼ˆr-iï¼‰ã€‚æœ€å°å€¼åŒç†ä¸è¿‡æ˜¯å‡å»ã€‚</p>
<p>è¿™é‡Œä»‹ç»ä¸¤ç§å¯»æ‰¾æ¯ä¸ªæ•°çš„lï¼Œrçš„æ–¹æ³•ã€‚</p>
<ol>
<li>å•è°ƒæ ˆ<br>å¥½åƒå°±ç›¸å½“æ˜¯ä¸ªæ¿å­äº†</li>
<li>äºŒåˆ†+stè¡¨<br>å¯¹äºæ¯ä¸ªæ•°a[i]äºŒåˆ†å®ƒçš„å·¦è¾¹ã€0ï¼Œi-1ã€‘å’Œå³è¾¹[i+1,N]ï¼Œç„¶åç”¨stè¡¨æ¥checkã€‚ä¸€æ®µåŒºé—´çš„å‰ç¼€æˆ–åç¼€çš„æœ€å€¼æ˜¯å•è°ƒçš„ï¼Œæ»¡è¶³äºŒåˆ†ã€‚</li>
</ol>
<h3 id="å•è°ƒæ ˆä»£ç "><a href="#å•è°ƒæ ˆä»£ç " class="headerlink" title="å•è°ƒæ ˆä»£ç "></a>å•è°ƒæ ˆä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N+<span class="number">2</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">	a[<span class="number">0</span>] = a[N+<span class="number">1</span>] = <span class="number">1e9</span>;<span class="comment">//è®¾ç½®å“¨å…µï¼Œ</span></span><br><span class="line">		</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">maxl</span><span class="params">(N+<span class="number">2</span>)</span>,<span class="title">maxr</span><span class="params">(N+<span class="number">2</span>)</span>,<span class="title">minl</span><span class="params">(N+<span class="number">2</span>)</span>,<span class="title">minr</span><span class="params">(N+<span class="number">2</span>)</span></span>;</span><br><span class="line">	stack&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; q;<span class="comment">//pairæ˜¯å€¼å’Œä½ç½®</span></span><br><span class="line">	</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(a[<span class="number">0</span>], <span class="number">0</span>));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N + <span class="number">1</span>; i ++) &#123;<span class="comment">//i is max</span></span><br><span class="line">		<span class="keyword">while</span> (q.<span class="built_in">size</span>() &amp;&amp; q.<span class="built_in">top</span>().first &lt; a[i]) &#123;</span><br><span class="line">			maxr[q.<span class="built_in">top</span>().second] = i;<span class="comment">//a[i]ä½œä¸ºæ ˆé¡¶å³è¾¹çš„æœ€å¤§å€¼</span></span><br><span class="line">			q.<span class="built_in">pop</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (q.<span class="built_in">size</span>()) maxl[i] = q.<span class="built_in">top</span>().second;<span class="comment">//æ ˆé¡¶ä½œä¸ºa[i]å·¦è¾¹çš„æœ€å¤§å€¼</span></span><br><span class="line">		q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(a[i], i));<span class="comment">//a[i]å…¥æ ˆ</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">size</span>()) q.<span class="built_in">pop</span>();<span class="comment">//æ¸…ç©ºæ ˆå†…å…ƒç´ 	</span></span><br><span class="line">	a[<span class="number">0</span>] = a[N+<span class="number">1</span>] = <span class="number">-1e9</span>;<span class="comment">//å“¨å…µ</span></span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(a[<span class="number">0</span>], <span class="number">0</span>));</span><br><span class="line">	<span class="comment">//æ±‚æœ€å°å€¼åŒç†</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N + <span class="number">1</span>; i ++) &#123;<span class="comment">//i is min</span></span><br><span class="line">		<span class="keyword">while</span> (q.<span class="built_in">size</span>() &amp;&amp; q.<span class="built_in">top</span>().first &gt; a[i]) &#123;</span><br><span class="line">			minr[q.<span class="built_in">top</span>().second] = i;</span><br><span class="line">			q.<span class="built_in">pop</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (q.<span class="built_in">size</span>()) minl[i] = q.<span class="built_in">top</span>().second;</span><br><span class="line">		q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(a[i], i));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;<span class="comment">//æšä¸¾æ¯ä¸ªä½ç½®çš„è´¡çŒ®</span></span><br><span class="line">		<span class="keyword">int</span> r = maxr[i] - i;</span><br><span class="line">		<span class="keyword">int</span> l = i - maxl[i];</span><br><span class="line">		<span class="keyword">int</span> cnt = r * l;</span><br><span class="line">		r = minr[i] - i;</span><br><span class="line">		l = i - minl[i];</span><br><span class="line">		ans += a[i] * cnt;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="äºŒåˆ†-stè¡¨ä»£ç "><a href="#äºŒåˆ†-stè¡¨ä»£ç " class="headerlink" title="äºŒåˆ†+stè¡¨ä»£ç "></a>äºŒåˆ†+stè¡¨ä»£ç </h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K,Q;</span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">A</span><span class="params">(maxn)</span>, <span class="title">dp</span><span class="params">(maxn)</span>, <span class="title">f</span><span class="params">(maxn)</span>, <span class="title">B</span><span class="params">(maxn)</span></span>;</span><br><span class="line"><span class="keyword">int</span> a, b, c, x, t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RMQ</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">highest_bit</span><span class="params">(<span class="keyword">unsigned</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x == <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">31</span> - __builtin_clz(x);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">    vector&lt;vector&lt;T&gt;&gt; range_max;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">RMQ</span>(<span class="keyword">const</span> vector&lt;T&gt; &amp;values = &#123;&#125;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!values.<span class="built_in">empty</span>())</span><br><span class="line">            <span class="built_in">build</span>(values);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">static</span> T <span class="title">better</span><span class="params">(T a, T b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(a, b);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">const</span> vector&lt;T&gt; &amp;values)</span> </span>&#123;</span><br><span class="line">        n = (<span class="keyword">int</span>)(values.<span class="built_in">size</span>());</span><br><span class="line">        <span class="keyword">int</span> levels = <span class="built_in">highest_bit</span>(n) + <span class="number">1</span>;</span><br><span class="line">        range_max.<span class="built_in">resize</span>(levels);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; levels; k++)</span><br><span class="line">            range_max[k].<span class="built_in">resize</span>(n - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span>)</span><br><span class="line">            range_max[<span class="number">0</span>] = values;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; levels; k++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - (<span class="number">1</span> &lt;&lt; k); i++)</span><br><span class="line">                range_max[k][i] = <span class="built_in">better</span>(range_max[k - <span class="number">1</span>][i], range_max[k - <span class="number">1</span>][i + (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))]);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">T <span class="title">query_value</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="keyword">const</span> </span>&#123;<span class="comment">//[a,b),idx from 1</span></span><br><span class="line">        <span class="comment">// assert(0 &lt;= a &amp;&amp; a &lt; b &amp;&amp; b &lt;= n);</span></span><br><span class="line">        <span class="keyword">int</span> level = <span class="built_in">highest_bit</span>(b - a + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">better</span>(range_max[level][a], range_max[level][b - (<span class="number">1</span> &lt;&lt; level) + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RMQ1</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">highest_bit</span><span class="params">(<span class="keyword">unsigned</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x == <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">31</span> - __builtin_clz(x);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">    vector&lt;vector&lt;T&gt;&gt; range_min;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">RMQ1</span>(<span class="keyword">const</span> vector&lt;T&gt; &amp;values = &#123;&#125;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!values.<span class="built_in">empty</span>())</span><br><span class="line">            <span class="built_in">build</span>(values);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">static</span> T <span class="title">better</span><span class="params">(T a, T b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(a, b);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">const</span> vector&lt;T&gt; &amp;values)</span> </span>&#123;</span><br><span class="line">        n = (<span class="keyword">int</span>)(values.<span class="built_in">size</span>());</span><br><span class="line">        <span class="keyword">int</span> levels = <span class="built_in">highest_bit</span>(n) + <span class="number">1</span>;</span><br><span class="line">        range_min.<span class="built_in">resize</span>(levels);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; levels; k++)</span><br><span class="line">            range_min[k].<span class="built_in">resize</span>(n - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span>)</span><br><span class="line">            range_min[<span class="number">0</span>] = values;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; levels; k++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - (<span class="number">1</span> &lt;&lt; k); i++)</span><br><span class="line">                range_min[k][i] = <span class="built_in">better</span>(range_min[k - <span class="number">1</span>][i], range_min[k - <span class="number">1</span>][i + (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))]);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">T <span class="title">query_value</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="keyword">const</span> </span>&#123;<span class="comment">//[a,b),idx from 1</span></span><br><span class="line">        <span class="comment">// assert(0 &lt;= a &amp;&amp; a &lt; b &amp;&amp; b &lt;= n);</span></span><br><span class="line">        <span class="keyword">int</span> level = <span class="built_in">highest_bit</span>(b - a + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">better</span>(range_min[level][a], range_min[level][b - (<span class="number">1</span> &lt;&lt; level) + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(N+<span class="number">2</span>)</span>, <span class="title">sum</span><span class="params">(N+<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cin &gt;&gt; a[i];</span><br><span class="line">	a[<span class="number">0</span>] = a[N+<span class="number">1</span>] = <span class="number">1e9</span>;</span><br><span class="line">	<span class="function">RMQ&lt;<span class="keyword">int</span>&gt; <span class="title">rmq</span><span class="params">(a)</span></span>;<span class="comment">//ç»´æŠ¤åŒºé—´æœ€å¤§</span></span><br><span class="line">	a[<span class="number">0</span>] = a[N+<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">	<span class="function">RMQ1&lt;<span class="keyword">int</span>&gt; <span class="title">rmq1</span><span class="params">(a)</span></span>;<span class="comment">//ç»´æŠ¤åŒºé—´æœ€å°</span></span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;<span class="comment">//max</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//äºŒåˆ†æ±‚å³è¾¹ç•Œ</span></span><br><span class="line">		<span class="keyword">int</span> l = i + <span class="number">1</span>, r = N+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">			<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (rmq.<span class="built_in">query_value</span>(i + <span class="number">1</span>,mid) &gt; a[i]) r = mid ;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				l = mid + <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> right = l - i;<span class="comment">//æš‚å­˜å³è¾¹ç•Œçš„é•¿åº¦</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//äºŒåˆ†å·¦è¾¹ç•Œ</span></span><br><span class="line">		l = <span class="number">0</span>, r = i - <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">			<span class="keyword">int</span> mid = (l + r + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (rmq.<span class="built_in">query_value</span>(mid, i - <span class="number">1</span>) &lt; a[i]) r = mid - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				l = mid;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ans += right * (i-r) * a[i];<span class="comment">//è®¡ç®—è´¡çŒ®</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;<span class="comment">//minåŒç†</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> l = i + <span class="number">1</span>, r = N+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">			<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (rmq1.<span class="built_in">query_value</span>(i + <span class="number">1</span>,mid) &lt; a[i]) r = mid ;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				l = mid + <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> right = l - i;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		l = <span class="number">0</span>, r = i - <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">			<span class="keyword">int</span> mid = (l + r + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (rmq1.<span class="built_in">query_value</span>(mid, i - <span class="number">1</span>) &gt; a[i]) r = mid - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				l = mid;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		ans -= right * (i-r) * a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i ++) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>namomoæ¯æ—¥ä¸€é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>template</title>
    <url>/2022/04/13/template/</url>
    <content><![CDATA[<h1 id="STLç®€ä»‹"><a href="#STLç®€ä»‹" class="headerlink" title="STLç®€ä»‹"></a>STLç®€ä»‹</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">vector, å˜é•¿æ•°ç»„ï¼Œå€å¢çš„æ€æƒ³</span><br><span class="line">    <span class="built_in">size</span>()  è¿”å›å…ƒç´ ä¸ªæ•°</span><br><span class="line">    <span class="built_in">empty</span>()  è¿”å›æ˜¯å¦ä¸ºç©º</span><br><span class="line">    <span class="built_in">clear</span>()  æ¸…ç©º</span><br><span class="line">    <span class="built_in">front</span>()/<span class="built_in">back</span>()</span><br><span class="line">    <span class="built_in">push_back</span>()/<span class="built_in">pop_back</span>()</span><br><span class="line">    <span class="built_in">begin</span>()/<span class="built_in">end</span>()</span><br><span class="line">    []</span><br><span class="line">    æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼ŒæŒ‰å­—å…¸åº</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span><br><span class="line">    first, ç¬¬ä¸€ä¸ªå…ƒç´ </span><br><span class="line">    second, ç¬¬äºŒä¸ªå…ƒç´ </span><br><span class="line">    æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼Œä»¥firstä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œä»¥secondä¸ºç¬¬äºŒå…³é”®å­—ï¼ˆå­—å…¸åºï¼‰</span><br><span class="line"></span><br><span class="line">stringï¼Œå­—ç¬¦ä¸²</span><br><span class="line">    <span class="built_in">size</span>()/<span class="built_in">length</span>()  è¿”å›å­—ç¬¦ä¸²é•¿åº¦</span><br><span class="line">    <span class="built_in">empty</span>()</span><br><span class="line">    <span class="built_in">clear</span>()</span><br><span class="line">    <span class="built_in">substr</span>(èµ·å§‹ä¸‹æ ‡ï¼Œ(å­ä¸²é•¿åº¦))  è¿”å›å­ä¸²</span><br><span class="line">    <span class="built_in">c_str</span>()  è¿”å›å­—ç¬¦ä¸²æ‰€åœ¨å­—ç¬¦æ•°ç»„çš„èµ·å§‹åœ°å€</span><br><span class="line"></span><br><span class="line">queue, é˜Ÿåˆ—</span><br><span class="line">    <span class="built_in">size</span>()</span><br><span class="line">    <span class="built_in">empty</span>()</span><br><span class="line">    <span class="built_in">push</span>()  å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªå…ƒç´ </span><br><span class="line">    <span class="built_in">front</span>()  è¿”å›é˜Ÿå¤´å…ƒç´ </span><br><span class="line">    <span class="built_in">back</span>()  è¿”å›é˜Ÿå°¾å…ƒç´ </span><br><span class="line">    <span class="built_in">pop</span>()  å¼¹å‡ºé˜Ÿå¤´å…ƒç´ </span><br><span class="line"></span><br><span class="line">priority_queue, ä¼˜å…ˆé˜Ÿåˆ—ï¼Œé»˜è®¤æ˜¯å¤§æ ¹å †</span><br><span class="line">    <span class="built_in">size</span>()</span><br><span class="line">    <span class="built_in">empty</span>()</span><br><span class="line">    <span class="built_in">push</span>()  æ’å…¥ä¸€ä¸ªå…ƒç´ </span><br><span class="line">    <span class="built_in">top</span>()  è¿”å›å †é¡¶å…ƒç´ </span><br><span class="line">    <span class="built_in">pop</span>()  å¼¹å‡ºå †é¡¶å…ƒç´ </span><br><span class="line">    å®šä¹‰æˆå°æ ¹å †çš„æ–¹å¼ï¼špriority_queue&lt;<span class="keyword">int</span>, vector&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line"></span><br><span class="line">stack, æ ˆ</span><br><span class="line">    <span class="built_in">size</span>()</span><br><span class="line">    <span class="built_in">empty</span>()</span><br><span class="line">    <span class="built_in">push</span>()  å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªå…ƒç´ </span><br><span class="line">    <span class="built_in">top</span>()  è¿”å›æ ˆé¡¶å…ƒç´ </span><br><span class="line">    <span class="built_in">pop</span>()  å¼¹å‡ºæ ˆé¡¶å…ƒç´ </span><br><span class="line"></span><br><span class="line">deque, åŒç«¯é˜Ÿåˆ—</span><br><span class="line">    <span class="built_in">size</span>()</span><br><span class="line">    <span class="built_in">empty</span>()</span><br><span class="line">    <span class="built_in">clear</span>()</span><br><span class="line">    <span class="built_in">front</span>()/<span class="built_in">back</span>()</span><br><span class="line">    <span class="built_in">push_back</span>()/<span class="built_in">pop_back</span>()</span><br><span class="line">    <span class="built_in">push_front</span>()/<span class="built_in">pop_front</span>()</span><br><span class="line">    <span class="built_in">begin</span>()/<span class="built_in">end</span>()</span><br><span class="line">    []</span><br><span class="line"></span><br><span class="line">set, map, multiset, multimap, åŸºäºå¹³è¡¡äºŒå‰æ ‘ï¼ˆçº¢é»‘æ ‘ï¼‰ï¼ŒåŠ¨æ€ç»´æŠ¤æœ‰åºåºåˆ—</span><br><span class="line">    <span class="built_in">size</span>()</span><br><span class="line">    <span class="built_in">empty</span>()</span><br><span class="line">    <span class="built_in">clear</span>()</span><br><span class="line">    <span class="built_in">begin</span>()/<span class="built_in">end</span>()</span><br><span class="line">    ++, -- è¿”å›å‰é©±å’Œåç»§ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="built_in">O</span>(logn)</span><br><span class="line"></span><br><span class="line">    set/<span class="function">multiset</span></span><br><span class="line"><span class="function">        <span class="title">insert</span><span class="params">()</span>  æ’å…¥ä¸€ä¸ªæ•°</span></span><br><span class="line"><span class="function">        <span class="title">find</span><span class="params">()</span>  æŸ¥æ‰¾ä¸€ä¸ªæ•°</span></span><br><span class="line"><span class="function">        <span class="title">count</span><span class="params">()</span>  è¿”å›æŸä¸€ä¸ªæ•°çš„ä¸ªæ•°</span></span><br><span class="line"><span class="function">        <span class="title">erase</span><span class="params">()</span></span></span><br><span class="line"><span class="function">            <span class="params">(<span class="number">1</span>)</span> è¾“å…¥æ˜¯ä¸€ä¸ªæ•°xï¼Œåˆ é™¤æ‰€æœ‰x   <span class="title">O</span><span class="params">(k + logn)</span></span></span><br><span class="line"><span class="function">            <span class="params">(<span class="number">2</span>)</span> è¾“å…¥ä¸€ä¸ªè¿­ä»£å™¨ï¼Œåˆ é™¤è¿™ä¸ªè¿­ä»£å™¨</span></span><br><span class="line"><span class="function">        <span class="title">lower_bound</span><span class="params">()</span>/<span class="title">upper_bound</span><span class="params">()</span></span></span><br><span class="line"><span class="function">            <span class="title">lower_bound</span><span class="params">(x)</span>  è¿”å›å¤§äºç­‰äºxçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨</span></span><br><span class="line"><span class="function">            <span class="title">upper_bound</span><span class="params">(x)</span>  è¿”å›å¤§äºxçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨</span></span><br><span class="line"><span class="function">    map/multimap</span></span><br><span class="line"><span class="function">        <span class="title">insert</span><span class="params">()</span>  æ’å…¥çš„æ•°æ˜¯ä¸€ä¸ªpair</span></span><br><span class="line"><span class="function">        <span class="title">erase</span><span class="params">()</span>  è¾“å…¥çš„å‚æ•°æ˜¯pairæˆ–è€…è¿­ä»£å™¨</span></span><br><span class="line"><span class="function">        <span class="title">find</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        []  æ³¨æ„multimapä¸æ”¯æŒæ­¤æ“ä½œã€‚ æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="title">O</span><span class="params">(logn)</span></span></span><br><span class="line"><span class="function">        <span class="title">lower_bound</span><span class="params">()</span>/<span class="title">upper_bound</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">unordered_set, unordered_map, unordered_multiset, unordered_multimap, å“ˆå¸Œè¡¨</span></span><br><span class="line"><span class="function">    å’Œä¸Šé¢ç±»ä¼¼ï¼Œå¢åˆ æ”¹æŸ¥çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="title">O</span><span class="params">(<span class="number">1</span>)</span></span></span><br><span class="line"><span class="function">    ä¸æ”¯æŒ <span class="title">lower_bound</span><span class="params">()</span>/<span class="title">upper_bound</span><span class="params">()</span>ï¼Œ è¿­ä»£å™¨çš„++ï¼Œ--</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">bitset, åœ§ä½</span></span><br><span class="line"><span class="function">    bitset&lt;10000&gt; s</span>;</span><br><span class="line">    ~, &amp;, |, ^</span><br><span class="line">    &gt;&gt;, &lt;&lt;</span><br><span class="line">    ==, !=</span><br><span class="line">    []</span><br><span class="line"></span><br><span class="line">    <span class="built_in">count</span>()  è¿”å›æœ‰å¤šå°‘ä¸ª<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">any</span>()  åˆ¤æ–­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ª<span class="number">1</span></span><br><span class="line">    <span class="built_in">none</span>()  åˆ¤æ–­æ˜¯å¦å…¨ä¸º<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span>()  æŠŠæ‰€æœ‰ä½ç½®æˆ<span class="number">1</span></span><br><span class="line">    <span class="built_in">set</span>(k, v)  å°†ç¬¬kä½å˜æˆv</span><br><span class="line">    <span class="built_in">reset</span>()  æŠŠæ‰€æœ‰ä½å˜æˆ<span class="number">0</span></span><br><span class="line">    <span class="built_in">flip</span>()  ç­‰ä»·äº~</span><br><span class="line">    <span class="built_in">flip</span>(k) æŠŠç¬¬kä½å–å</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="logé¢„å¤„ç†"><a href="#logé¢„å¤„ç†" class="headerlink" title="logé¢„å¤„ç†"></a>logé¢„å¤„ç†</h1><script type="math/tex; mode=display">
\left\{\begin{aligned} Logn[1] &=0, \\ Logn\left[i\right] &=Logn[\frac{i}{2}] + 1. \end{aligned}\right.</script><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getlog</span><span class="params">()</span></span>&#123;<span class="comment">//é¢„å¤„ç†Logæ•°ç»„</span></span><br><span class="line">	Log[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">		Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="STè¡¨"><a href="#STè¡¨" class="headerlink" title="STè¡¨"></a>STè¡¨</h1><p><strong>ç”¨å¤„ï¼š</strong></p>
<p>é™æ€åŒºé—´æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œgcdï¼ˆå¯é‡å¤è´¡çŒ®çš„é—®é¢˜ï¼‰é™¤ RMQ ä»¥å¤–ï¼Œè¿˜æœ‰å…¶å®ƒçš„â€œå¯é‡å¤è´¡çŒ®é—®é¢˜â€ã€‚ä¾‹å¦‚â€œåŒºé—´æŒ‰ä½å’Œâ€ã€â€œåŒºé—´æŒ‰ä½æˆ–â€ã€â€œåŒºé—´ GCDâ€ï¼ŒST è¡¨éƒ½èƒ½é«˜æ•ˆåœ°è§£å†³ã€‚ä¾‹å¦‚â€œåŒºé—´æŒ‰ä½ä¸â€å°±æ˜¯æ¯ä¸€ä½å–æœ€å°å€¼ï¼Œâ€œåŒºé—´æŒ‰ä½æˆ–â€å°±æ˜¯æ¯ä¸€ä½å–æœ€å¤§å€¼ï¼Œè€Œâ€œåŒºé—´ GCDâ€åˆ™æ˜¯æ¯ä¸€ä¸ªè´¨å› æ•°çš„æŒ‡æ•°å–æœ€å°å€¼ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> a[N];<span class="comment">//é™æ€æ•°ç»„</span></span><br><span class="line"><span class="keyword">int</span> Log[N];<span class="comment">//log(i)çš„å€¼</span></span><br><span class="line"><span class="keyword">int</span> dp[N][<span class="number">20</span>];<span class="comment">//åŒºé—´ã€iï¼Œi+(2^j)-1ã€‘é‡Œçš„ä¿¡æ¯ï¼ˆæœ€å€¼ï¼Œgcdç­‰ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getlog</span><span class="params">()</span></span>&#123;<span class="comment">//é¢„å¤„ç†Logæ•°ç»„</span></span><br><span class="line">	Log[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">		Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;j)&lt;= n; j ++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span> &lt;= n; i++)&#123;</span><br><span class="line">      <span class="comment">//ç”±åŸæ¥ä¸¤åŠå¾—åˆ°åˆå¹¶åé•¿åº¦çš„ä¿¡æ¯ï¼ˆç±»ä¼¼åŒºé—´dpï¼‰</span></span><br><span class="line">			dp[i][j] = <span class="built_in">max</span>(dp[i][j<span class="number">-1</span>],dp[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    	cin &gt;&gt; a[i];</span><br><span class="line">    	dp[i][<span class="number">0</span>] = a[i];<span class="comment">//åŒºé—´é•¿åº¦ä¸º1æ—¶å°±æ˜¯è‡ªå·±</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">getlog</span>();</span><br><span class="line">    <span class="built_in">RMQ</span>();</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">    	<span class="keyword">int</span> l,r;</span><br><span class="line">    	cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">    	<span class="keyword">int</span> e = Log[r-l+<span class="number">1</span>];</span><br><span class="line">      <span class="comment">//ä»å‰2^eå’Œä»å2^eå›Šæ‹¬äº†æ•´ä¸ªåŒºé—´</span></span><br><span class="line">    	cout &lt;&lt; <span class="built_in">max</span>(dp[l][e],dp[r-(<span class="number">1</span>&lt;&lt;e)+<span class="number">1</span>][e]) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios_base::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="Lca"><a href="#Lca" class="headerlink" title="Lca"></a>Lca</h1><p>å€å¢æ³•æ±‚å…¬å…±ç¥–å…ˆ</p>
<p><strong>ç”¨å¤„ï¼š</strong></p>
<p>1 -  æ±‚æ ‘ä¸Šä¸¤ç‚¹æœ€çŸ­è·ç¦»</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; g[N];<span class="comment">//å­˜å›¾</span></span><br><span class="line"><span class="keyword">int</span> deep[N];<span class="comment">//èŠ‚ç‚¹çš„æ·±åº¦</span></span><br><span class="line"><span class="keyword">int</span> pre[N][<span class="number">64</span>];<span class="comment">//ièŠ‚ç‚¹å¾€ä¸Š2^jå±‚èŠ‚ç‚¹ç¼–å·</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	deep[u] = deep[fa]+<span class="number">1</span>;<span class="comment">//æ·±åº¦æ˜¯çˆ¶èŠ‚ç‚¹æ·±åº¦+1</span></span><br><span class="line">	pre[u][<span class="number">0</span>] = fa;<span class="comment">//å¾€ä¸Š2^0=1å±‚å°±æ˜¯çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">	</span><br><span class="line">  <span class="comment">//å¾€ä¸Š2^jå±‚æ˜¯å¾€ä¸Š2^(j-1)åå†å¾€ä¸Š2^(j-1)å±‚</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;j) &lt;= deep[u]; j ++)&#123;</span><br><span class="line">		pre[u][j] = pre[pre[u][j<span class="number">-1</span>]][j<span class="number">-1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(g[u][i]==fa) <span class="keyword">continue</span>;<span class="comment">//ä¸èƒ½å¾€å›èµ°</span></span><br><span class="line">		<span class="built_in">init</span>(g[u][i],u);<span class="comment">//dfsé€’å½’</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(deep[u] &lt; deep[v]) <span class="built_in">swap</span>(u,v);<span class="comment">//ä¿è¯uçš„æ·±åº¦&gt;=vçš„æ·±åº¦</span></span><br><span class="line">	<span class="keyword">int</span> d = deep[u] - deep[v];<span class="comment">//æ·±åº¦å·®</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; (<span class="number">1</span>&lt;&lt;i) &lt;= d; i ++)&#123;<span class="comment">//å°†æ·±åº¦å·®è½¬åŒ–æˆ2è¿›åˆ¶</span></span><br><span class="line">		<span class="keyword">if</span>((<span class="number">1</span>&lt;&lt;i)&amp;d) u = pre[u][i];<span class="comment">//ç¬¬iä½æ˜¯1è¯´æ˜dç”±2^iç´¯åŠ </span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(u==v) <span class="keyword">return</span> u;<span class="comment">//å·²ç»ç›¸ç­‰äº†ï¼Œç›´æ¥è¿”å›ï¼ˆvï¼ŒuåŒä¸€æ¡é“¾ï¼‰</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i --)&#123;<span class="comment">//uï¼ŒvåŒæ—¶å¾€ä¸Šè·³</span></span><br><span class="line">    <span class="comment">//å…¬å…±ç¥–å…ˆåŠä»¥ä¸Šæ˜¯ç›¸ç­‰ï¼Œå¯èƒ½è·³è¿‡ï¼Œæ‰€ä»¥ç”¨ä¸ç›¸ç­‰åˆ¤æ–­</span></span><br><span class="line">		<span class="keyword">if</span>(pre[u][i]!=pre[v][i])&#123;<span class="comment">//è¿˜æ²¡è·³åˆ°å…¬å…±ç¥–å…ˆ</span></span><br><span class="line">			u = pre[u][i];</span><br><span class="line">			v = pre[v][i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//ç»“æŸåæ˜¯å…¬å…±ç¥–å…ˆçš„å­èŠ‚ç‚¹	</span></span><br><span class="line">	<span class="keyword">return</span> pre[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ‚¬çº¿æ³•"><a href="#æ‚¬çº¿æ³•" class="headerlink" title="æ‚¬çº¿æ³•"></a>æ‚¬çº¿æ³•</h1><p>æ±‚æœ€å¤§å­çŸ©é˜µï¼ˆè¦æ±‚æ¯ä¸ªçŸ©é˜µåº•è¾¹åœ¨åŒä¸€è¡Œï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhujuqiang/blog_img/jVqWdfCBgI21TbK.png" alt="iShot2021-10-20 17.08.50.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> std::max;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N];</span><br><span class="line"><span class="keyword">int</span> l[N], r[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF &amp;&amp; n) &#123;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//a[i]æ˜¯æ¯ä¸€åˆ—çš„é«˜åº¦ï¼Œ l[i],r[i]åˆ†åˆ«æŒ‡ä»¥a[i]ä¸ºé«˜çš„çŸ©é˜µçš„å·¦è¾¹ç•Œå’Œå³è¾¹ç•Œ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), l[i] = r[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="comment">//l[i]--iæ˜¯å•è°ƒå‡çš„</span></span><br><span class="line">      <span class="keyword">while</span> (l[i] &gt; <span class="number">1</span> &amp;&amp; a[i] &lt;= a[l[i] - <span class="number">1</span>]) l[i] = l[l[i] - <span class="number">1</span>];<span class="comment">//è®¡ç®—å·¦è¾¹ç•Œ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--)<span class="comment">//i--r[i]iæ˜¯å•è°ƒå¢çš„</span></span><br><span class="line">      <span class="keyword">while</span> (r[i] &lt; n &amp;&amp; a[i] &lt;= a[r[i] + <span class="number">1</span>]) r[i] = r[r[i] + <span class="number">1</span>];<span class="comment">//è®¡ç®—å³è¾¹ç•Œ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="comment">//æšä¸¾å–Max</span></span><br><span class="line">      ans = <span class="built_in">max</span>(ans, (<span class="keyword">long</span> <span class="keyword">long</span>)(r[i] - l[i] + <span class="number">1</span>) * a[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2021æ­ç”µå¤šæ ¡ç¬¬ä¸€åœº-Maximal-submatrix"><a href="#2021æ­ç”µå¤šæ ¡ç¬¬ä¸€åœº-Maximal-submatrix" class="headerlink" title="2021æ­ç”µå¤šæ ¡ç¬¬ä¸€åœº    Maximal submatrix"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=6957">2021æ­ç”µå¤šæ ¡ç¬¬ä¸€åœº    Maximal submatrix</a></h4><p>æšä¸¾æ¯ä¸€è¡Œä¸ºåº•è¾¹å°±è½¬åŒ–æˆä¸Šè¿°çš„å­é—®é¢˜</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e3</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> a[N][N], g[N][N], l[N], r[N], h[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span> a);</span><br><span class="line">    <span class="built_in">memset</span>(g,<span class="number">0</span>,<span class="keyword">sizeof</span> g);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j ++)&#123;</span><br><span class="line">    		cin &gt;&gt; a[i][j];</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)&#123;</span><br><span class="line">    	<span class="keyword">int</span> t = <span class="number">1</span>, x = <span class="number">1</span>;</span><br><span class="line">    	<span class="keyword">while</span>(t&lt;=n)&#123;</span><br><span class="line">    		x = <span class="number">1</span>-x;</span><br><span class="line">    		<span class="keyword">while</span>(a[t][i]&lt;=a[t+<span class="number">1</span>][i])&#123;</span><br><span class="line">    			g[t][i] = x;</span><br><span class="line">    			t++;</span><br><span class="line">    			<span class="comment">//if(t&gt;n) break;</span></span><br><span class="line">    		&#125;</span><br><span class="line">    		g[t][i] = x;</span><br><span class="line">    		t++;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) h[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j ++) l[j] = r[j] = j;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j ++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(g[i][j]==g[i<span class="number">-1</span>][j])&#123;</span><br><span class="line">    			h[j]++;</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">else</span>&#123;</span><br><span class="line">    			h[j] = <span class="number">1</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j ++)&#123;</span><br><span class="line">    		<span class="keyword">while</span>(l[j]&gt;<span class="number">1</span> &amp;&amp; h[j]&lt;=h[l[j]<span class="number">-1</span>]) l[j] = l[l[j]<span class="number">-1</span>];</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j = m; j &gt;= <span class="number">1</span>; j --)&#123;</span><br><span class="line">    		<span class="keyword">while</span>(r[j]&lt;m &amp;&amp; h[j]&lt;=h[r[j]+<span class="number">1</span>]) r[j] = r[r[j]+<span class="number">1</span>];</span><br><span class="line">    	&#125;</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j ++) &#123;</span><br><span class="line">    		ans = <span class="built_in">max</span>(ans, h[j]*(r[j]-l[j]+<span class="number">1</span>));</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios_base::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h1><p>ç”¨äºæ±‚è§£ä¸‹è¿°å¼å­</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhujuqiang/blog_img/20220420231215.png" alt=""></p>
<p><strong>ç®—æ³•æè¿°</strong></p>
<p>ä»¤ $ x = A \left \lceil \sqrt p \right \rceil - B $ï¼Œå…¶ä¸­ $0\le A,B \le \left \lceil \sqrt p \right \rceil$ï¼Œåˆ™æœ‰ $a^{A\left \lceil \sqrt p \right \rceil -B} \equiv b \pmod p$ï¼Œç¨åŠ å˜æ¢ï¼Œåˆ™æœ‰ $a^{A\left \lceil \sqrt p \right \rceil} \equiv ba^B \pmod p$ã€‚</p>
<p>æˆ‘ä»¬å·²çŸ¥çš„æ˜¯ $a,b$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆç®—å‡ºç­‰å¼å³è¾¹çš„ $ba^B$çš„æ‰€æœ‰å–å€¼ï¼Œæšä¸¾ $B$ï¼Œç”¨ <code>hash</code>/<code>map</code> å­˜ä¸‹æ¥ï¼Œç„¶åé€ä¸€è®¡ç®— $a^{A\left \lceil \sqrt p \right \rceil}$ï¼Œæšä¸¾ $A$ï¼Œå¯»æ‰¾æ˜¯å¦æœ‰ä¸ä¹‹ç›¸ç­‰çš„ $ba^B$ï¼Œä»è€Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„ $x$ï¼Œ$x=A \left \lceil \sqrt p \right \rceil - B$ã€‚</p>
<p>æ³¨æ„åˆ° $A,B$ å‡å°äº $\left \lceil \sqrt p \right \rceil$ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸º $\Theta\left (\sqrt p\right )$ï¼Œç”¨ <code>map</code> åˆ™å¤šä¸€ä¸ª $log$ã€‚</p>
<p><strong>å·¥å…·</strong></p>
<ol>
<li>mapå“ˆå¸Œ</li>
<li>åˆ†å—</li>
</ol>
<h4 id="ç®€å•è®¡ç®—æœºï¼ˆæ¨¡æ¿é¢˜ï¼‰"><a href="#ç®€å•è®¡ç®—æœºï¼ˆæ¨¡æ¿é¢˜ï¼‰" class="headerlink" title="ç®€å•è®¡ç®—æœºï¼ˆæ¨¡æ¿é¢˜ï¼‰"></a>ç®€å•è®¡ç®—æœºï¼ˆæ¨¡æ¿é¢˜ï¼‰</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bsgs</span><span class="params">(ll a, ll b, ll p)</span></span>&#123;</span><br><span class="line">  <span class="comment">//ç‰¹åˆ¤a==0çš„æƒ…å†µ</span></span><br><span class="line">	<span class="keyword">if</span>(a==<span class="number">0</span>&amp;&amp;b!=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Orz, I cannot find x!\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(a==<span class="number">0</span>&amp;&amp;b==<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	ll m = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p));<span class="comment">//åˆ†å—</span></span><br><span class="line">	unordered_map&lt;ll,ll&gt; dis;<span class="comment">//è®°å½•  dis[(b*a^B)%p] = B</span></span><br><span class="line">	</span><br><span class="line">	ll temp = b%p;</span><br><span class="line">	dis[temp] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)&#123;</span><br><span class="line">		temp = (temp*a)%p;</span><br><span class="line">		dis[temp] = i;<span class="comment">//é¢„å¤„ç†dis</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ll t = <span class="built_in">qmi</span>(a,m,p);</span><br><span class="line">	temp = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)&#123;</span><br><span class="line">		temp = (temp*t)%p;</span><br><span class="line">		<span class="keyword">if</span>(dis[temp])&#123;</span><br><span class="line">			ll x =i*m-dis[temp];<span class="comment">//è®¡ç®—x</span></span><br><span class="line">			x = (x%p+p)%p;<span class="comment">//å¯èƒ½å˜è´Ÿæ•°ï¼Œå–æ­£</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Orz, I cannot find x!&quot;</span>);<span class="comment">//æ— è§£</span></span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç‚¹åˆ†æ²»"><a href="#ç‚¹åˆ†æ²»" class="headerlink" title="ç‚¹åˆ†æ²»"></a>ç‚¹åˆ†æ²»</h1><p>ç”¨åˆ†æ²»æ€æƒ³å¤„ç†æ ‘ä¸Šçš„ä¸€äº›é—®é¢˜ï¼Œå³æ ¹èŠ‚ç‚¹ä¿¡æ¯å¯ä»¥ç”±æ‰€æœ‰å­èŠ‚ç‚¹çš„ä¿¡æ¯æ¨å‡º</p>
<blockquote>
<p>æ±‚æ ‘ä¸Šé•¿åº¦ç­‰äºkçš„è·¯å¾„æœ‰å‡ æ¡</p>
</blockquote>
<p><strong>ç¬¬ä¸€æ­¥ï¼šæ±‚å‡ºæ ‘çš„é‡å¿ƒ</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> pre)</span> <span class="comment">//siz:æ ‘çš„å¤§å°,mx:å­æ ‘ä¸­sizeçš„æœ€å¤§å€¼,rootæ ‘çš„é‡å¿ƒ</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  siz[x] = <span class="number">1</span>;<span class="comment">//å½“å‰èŠ‚ç‚¹å¤§å°ä¸º1</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = h[x]; i!=<span class="number">-1</span>; i = ne[i])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(to[i]!=pre)<span class="comment">//ä¸èƒ½å¾€å›èµ°ï¼Œæ‰€ä»¥åˆ°çˆ¶äº²èŠ‚ç‚¹æ—¶è·³è¿‡</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">getroot</span>(to[i],x);<span class="comment">//é€’å½’æ±‚å­æ ‘</span></span><br><span class="line">      siz[x] += size[to[i]];</span><br><span class="line">      mx[x] = <span class="built_in">max</span>(mx[x], size[to[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  mx[x] = <span class="built_in">max</span>(mx[x], n-siz[x]);</span><br><span class="line">  <span class="keyword">if</span>(mx[x]&lt;mx[root]) root = x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬äºŒæ­¥ï¼šä»¥æ–°çš„rootä¸ºæ ¹</strong></p>
<h1 id="æ‰«æçº¿"><a href="#æ‰«æçº¿" class="headerlink" title="æ‰«æçº¿"></a>æ‰«æçº¿</h1><p>é¡¾åæ€ä¹‰ï¼Œä¸€æ¡çº¿åœ¨æ•´ä¸ªå›¾ä¸Šæ‰«æ¥æ‰«å»ã€‚</p>
<p><strong>æ¨¡å‹ï¼š</strong>åœ¨äºŒç»´åæ ‡ç³»ä¸Šï¼Œç»™å‡ºå¤šä¸ªçŸ©å½¢çš„å·¦ä¸‹ä»¥åŠå³ä¸Šåæ ‡ï¼Œæ±‚å‡ºæ‰€æœ‰çŸ©å½¢æ„æˆçš„å›¾å½¢çš„é¢ç§¯ã€‚å®ƒä¸€èˆ¬è¢«ç”¨æ¥è§£å†³å›¾å½¢é¢ç§¯ï¼Œå‘¨é•¿ç­‰é—®é¢˜ã€‚</p>
<p><strong>æ€è·¯ï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/zhujuqiang/blog_img/20220420231518.png" alt=""></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ¯ä¸€ç§yç”»ä¸€æ¡æ¨ªçº¿ï¼ˆè¿™å°±æ˜¯æ‰«æçº¿ï¼‰ï¼ŒæŠŠæ•´ä¸ªçŸ©å½¢åˆ†æˆå¦‚å›¾å„ä¸ªé¢œè‰²ä¸åŒçš„å°çŸ©å½¢ï¼Œé‚£ä¹ˆè¿™ä¸ªå°çŸ©å½¢çš„é«˜å°±æ˜¯æˆ‘ä»¬æ‰«è¿‡çš„è·ç¦»ï¼Œé‚£ä¹ˆå‰©ä¸‹äº†ä¸€ä¸ªå˜é‡ï¼Œé‚£å°±æ˜¯çŸ©å½¢çš„é•¿ä¸€ç›´åœ¨å˜åŒ–ï¼ˆè‹¥å¹²ä¸ªåŒºé—´å¹¶é›†çš„é•¿åº¦ï¼‰ã€‚</li>
<li>æˆ‘ä»¬çš„çº¿æ®µæ ‘å°±æ˜¯ä¸ºäº†ç»´æŠ¤çŸ©å½¢çš„é•¿ï¼Œæˆ‘ä»¬ç»™æ¯ä¸€ä¸ªçŸ©å½¢çš„ä¸Šä¸‹è¾¹è¿›è¡Œæ ‡è®°ï¼Œä¸‹é¢çš„è¾¹æ ‡è®°ä¸º 1ï¼Œä¸Šé¢çš„è¾¹æ ‡è®°ä¸º -1ï¼Œæ¯é‡åˆ°ä¸€ä¸ªçŸ©å½¢æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“äº†æ ‡è®°ä¸º 1 çš„è¾¹ï¼Œæˆ‘ä»¬å°±åŠ è¿›æ¥è¿™ä¸€æ¡çŸ©å½¢çš„é•¿ï¼Œç­‰åˆ°æ‰«æåˆ° -1 æ—¶ï¼Œè¯æ˜è¿™ä¸€æ¡è¾¹éœ€è¦åˆ é™¤ï¼Œå°±åˆ å»ï¼Œåˆ©ç”¨ 1 å’Œ -1 å¯ä»¥è½»æ¾çš„åˆ°è¿™ç§çŠ¶æ€ã€‚ï¼ˆæœ€åæ ‡è®°å¤§äº0çš„é›†åˆå°±æ˜¯åŒºé—´å¹¶é›†ï¼Œä¹Ÿå°±æ˜¯é•¿ï¼‰</li>
<li>è¿˜è¦æ³¨æ„è¿™é‡Œçš„çº¿æ®µæ ‘æŒ‡çš„å¹¶ä¸æ˜¯çº¿æ®µçš„ä¸€ä¸ªç«¯ç‚¹ï¼Œè€ŒæŒ‡çš„æ˜¯ä¸€ä¸ªåŒºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯r+1å’Œr-1 ã€‚</li>
<li>éœ€è¦ ç¦»æ•£åŒ–</li>
</ul>
<h4 id="æ¨¡æ¿ï¼šç‰›å®¢å¤šæ ¡6H-Hopping-Rabbit"><a href="#æ¨¡æ¿ï¼šç‰›å®¢å¤šæ ¡6H-Hopping-Rabbit" class="headerlink" title="æ¨¡æ¿ï¼šç‰›å®¢å¤šæ ¡6H_Hopping Rabbit"></a>æ¨¡æ¿ï¼š<a href="https://ac.nowcoder.com/acm/contest/11257/H">ç‰›å®¢å¤šæ ¡6H_Hopping Rabbit</a></h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">A</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> yl,yr;<span class="comment">//	çŸ©å½¢å·¦è¾¹ç•Œï¼Œå³è¾¹ç•Œ</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Seg</span>&#123;</span><span class="comment">//		å­˜å‚¨çº¿æ®µä¿¡æ¯</span></span><br><span class="line">	<span class="keyword">int</span> mi[N*<span class="number">4</span>],lazy[N*<span class="number">4</span>]ï¼›</span><br><span class="line">  <span class="keyword">int</span> L,R,W;	<span class="comment">//å·¦ç«¯ç‚¹ï¼Œå³ç«¯ç‚¹ï¼Œä¿®æ”¹çš„å€¼</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">		mi[x]=<span class="built_in">min</span>(mi[x&lt;&lt;<span class="number">1</span>],mi[x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(lazy[x])&#123;</span><br><span class="line">			lazy[x&lt;&lt;<span class="number">1</span>]+=lazy[x],mi[x&lt;&lt;<span class="number">1</span>]+=lazy[x];</span><br><span class="line">			lazy[x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]+=lazy[x],mi[x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]+=lazy[x];</span><br><span class="line">			lazy[x]=<span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(l&gt;=L&amp;&amp;r&lt;=R)&#123;mi[x]+=W,lazy[x]+=W;<span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="built_in">pushdown</span>(x);</span><br><span class="line">		<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(L&lt;=mid)<span class="built_in">change</span>(x&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">		<span class="keyword">if</span>(R&gt;mid)<span class="built_in">change</span>(x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">		<span class="built_in">update</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(l==r)<span class="keyword">return</span> l;</span><br><span class="line">		<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;<span class="built_in">pushdown</span>(x);</span><br><span class="line">		<span class="keyword">if</span>(!mi[x&lt;&lt;<span class="number">1</span>])<span class="keyword">return</span> <span class="built_in">query</span>(x&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query1</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(mi[<span class="number">1</span>])<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n)<span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;S;</span><br><span class="line">vector&lt;A&gt; V[N],V1[N];</span><br><span class="line"><span class="keyword">int</span> n,d;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">	x=(x%d+d)%d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">op1</span><span class="params">(<span class="keyword">int</span> x1,<span class="keyword">int</span> x2,<span class="keyword">int</span> y1,<span class="keyword">int</span> y2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x1&gt;=x2||y1&gt;=y2)<span class="keyword">return</span>;</span><br><span class="line">	V[x1].<span class="built_in">push_back</span>(A&#123;y1+<span class="number">1</span>,y2&#125;);</span><br><span class="line">	V1[x2].<span class="built_in">push_back</span>(A&#123;y1+<span class="number">1</span>,y2&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">op</span><span class="params">(<span class="keyword">int</span> x1,<span class="keyword">int</span> x2,<span class="keyword">int</span> y1,<span class="keyword">int</span> y2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(y2-y1&gt;=d)&#123;<span class="built_in">op1</span>(x1,x2,<span class="number">0</span>,d);<span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="built_in">cal</span>(y1),<span class="built_in">cal</span>(y2);</span><br><span class="line">	<span class="keyword">if</span>(y1&gt;y2)&#123;<span class="built_in">op1</span>(x1,x2,y1,d),<span class="built_in">op1</span>(x1,x2,<span class="number">0</span>,y2);&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">op1</span>(x1,x2,y1,y2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x1,y1,x2,y2;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;d);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>,&amp;x1,&amp;y1,&amp;x2,&amp;y2);</span><br><span class="line">    <span class="comment">//å–æ¨¡ç¦»æ•£åŒ–åˆ°å°èŒƒå›´å¯èƒ½å˜æˆå¤šä¸ªçŸ©å½¢</span></span><br><span class="line">    <span class="comment">//ä»¥ä¸‹åŠopå‡½æ•°éƒ½åœ¨å¤„ç†è¯¥é—®é¢˜</span></span><br><span class="line">		<span class="keyword">if</span>(x2-x1&gt;=d)&#123;<span class="built_in">op</span>(<span class="number">0</span>,d,y1,y2);<span class="keyword">continue</span>;&#125;</span><br><span class="line">		<span class="built_in">cal</span>(x1),<span class="built_in">cal</span>(x2);</span><br><span class="line">		<span class="keyword">if</span>(x1&gt;x2)&#123;<span class="built_in">op</span>(x1,d,y1,y2),<span class="built_in">op</span>(<span class="number">0</span>,x2,y1,y2);&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">op</span>(x1,x2,y1,y2);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;d;i++)&#123;<span class="comment">//æšä¸¾æ¯ä¸ªï¼ˆæ‰«æï¼‰çº¿</span></span><br><span class="line">    <span class="comment">//è¿™æ¡çº¿ä¸Šçš„åŒºé—´å˜åŒ–å</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> x:V[i])S.L=x.yl,S.R=x.yr,S.W=<span class="number">1</span>,S.<span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,d);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> x:V1[i])S.L=x.yl,S.R=x.yr,S.W=<span class="number">-1</span>,S.<span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,d);</span><br><span class="line">		<span class="keyword">int</span> y=S.<span class="built_in">query1</span>(d);<span class="comment">//åŒºé—´æœ€å°å€¼ä¸ä¸º0ï¼Œåˆ™åŒºé—´å…¨è¢«è¦†ç›–</span></span><br><span class="line">		<span class="keyword">if</span>(y!=<span class="number">-1</span>)&#123;<span class="built_in">printf</span>(<span class="string">&quot;YES\n%d %d\n&quot;</span>,i,y);<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">(<span class="number">1</span>)æœ´ç´ å¹¶æŸ¥é›†ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[N]; <span class="comment">//å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x] != x) p[x] = <span class="built_in">find</span>(p[x]);</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) p[i] = i;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š</span></span><br><span class="line">p[<span class="built_in">find</span>(a)] = <span class="built_in">find</span>(b);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)ç»´æŠ¤sizeçš„å¹¶æŸ¥é›†ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[N], size[N];</span><br><span class="line"><span class="comment">//p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, size[]åªæœ‰ç¥–å®—èŠ‚ç‚¹çš„æœ‰æ„ä¹‰ï¼Œè¡¨ç¤ºç¥–å®—èŠ‚ç‚¹æ‰€åœ¨é›†åˆä¸­çš„ç‚¹çš„æ•°é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x] != x) p[x] = <span class="built_in">find</span>(p[x]);</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">&#123;</span><br><span class="line">    p[i] = i;</span><br><span class="line">    size[i] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š</span></span><br><span class="line">size[<span class="built_in">find</span>(b)] += size[<span class="built_in">find</span>(a)];</span><br><span class="line">p[<span class="built_in">find</span>(a)] = <span class="built_in">find</span>(b);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)ç»´æŠ¤åˆ°ç¥–å®—èŠ‚ç‚¹è·ç¦»çš„å¹¶æŸ¥é›†ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[N], d[N];</span><br><span class="line"><span class="comment">//p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, d[x]å­˜å‚¨xåˆ°p[x]çš„è·ç¦»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x] != x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="built_in">find</span>(p[x]);</span><br><span class="line">        d[x] += d[p[x]];</span><br><span class="line">        p[x] = u;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">&#123;</span><br><span class="line">    p[i] = i;</span><br><span class="line">    d[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š</span></span><br><span class="line">p[<span class="built_in">find</span>(a)] = <span class="built_in">find</span>(b);</span><br><span class="line">d[<span class="built_in">find</span>(a)] = distance; <span class="comment">// æ ¹æ®å…·ä½“é—®é¢˜ï¼Œåˆå§‹åŒ–find(a)çš„åç§»é‡</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="å•è°ƒæ ˆ"><a href="#å•è°ƒæ ˆ" class="headerlink" title="å•è°ƒæ ˆ"></a>å•è°ƒæ ˆ</h1><p>æ»¡è¶³å•è°ƒæ€§çš„æ ˆ</p>
<p><strong><a href="https://www.luogu.com.cn/problem/P5788">æ¨¡æ¿é¢˜</a></strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ft first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sd second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_INT 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// inline void print(__int128 x)&#123;if(x&lt;0)&#123;putchar(&#x27;-&#x27;);x=-x;&#125;if(x&gt;9) print(x/10);putchar(x%10+&#x27;0&#x27;);&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a % b) : a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123;<span class="keyword">if</span>(!b)&#123;x = <span class="number">1</span>; y = <span class="number">0</span>;<span class="keyword">return</span> a;&#125;<span class="keyword">int</span> d = <span class="built_in">exgcd</span>(b, a % b, y, x);y -= (a/b) * x;<span class="keyword">return</span> d;&#125;</span><br><span class="line"><span class="function">ll <span class="title">qmi</span><span class="params">(ll m, ll k, ll p)</span></span>&#123;ll res = <span class="number">1</span> % p, t = m;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k&amp;<span class="number">1</span>) res = res * t % p;t = t * t % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e6</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v,pos,idx;</span><br><span class="line">&#125;a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i].v);a[i].idx = i;&#125;</span><br><span class="line">    stack&lt;node&gt; s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;</span><br><span class="line">            s.<span class="built_in">push</span>(a[i]);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> now = a[i].v;</span><br><span class="line">        <span class="keyword">auto</span> t = s.<span class="built_in">top</span>();</span><br><span class="line">        <span class="keyword">while</span>(now&gt;t.v)&#123;</span><br><span class="line">            a[t.idx].pos = i;</span><br><span class="line">            s.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(s.<span class="built_in">empty</span>()) <span class="keyword">break</span>;</span><br><span class="line">            t = s.<span class="built_in">top</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        s.<span class="built_in">push</span>(a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        cout &lt;&lt; a[i].pos &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios_base::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//cin &gt;&gt; T;</span></span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="int128è¯»å†™æ¨¡æ¿å­"><a href="#int128è¯»å†™æ¨¡æ¿å­" class="headerlink" title="__int128è¯»å†™æ¨¡æ¿å­"></a>__int128è¯»å†™æ¨¡æ¿å­</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> __int128 <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    __int128 x=<span class="number">0</span>,f=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ch==<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f=<span class="number">-1</span>;</span><br><span class="line">        ch=<span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">        x=x*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch=<span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(__int128 x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;<span class="number">9</span>)</span><br><span class="line">        <span class="built_in">print</span>(x/<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> c)</span><span class="comment">//ä¿®æ”¹æ ‘çŠ¶æ•°ç»„xä½ç½®çš„å€¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=x;i&lt;=n;i+=<span class="built_in">lowbit</span>(i)) tr[i]+=c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span><span class="comment">//æŸ¥è¯¢åŒºé—´1~xçš„åŒºé—´å’Œï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=x;i&gt;=<span class="number">1</span>;i-=<span class="built_in">lowbit</span>(i)) res+=tr[i];</span><br><span class="line">	<span class="keyword">return</span> res; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ ‘é“¾å‰–åˆ†"><a href="#æ ‘é“¾å‰–åˆ†" class="headerlink" title="æ ‘é“¾å‰–åˆ†"></a>æ ‘é“¾å‰–åˆ†</h1><h4 id="ç‚¹æƒ"><a href="#ç‚¹æƒ" class="headerlink" title="ç‚¹æƒ"></a>ç‚¹æƒ</h4><p>åŸºäºç‚¹æƒï¼ŒæŸ¥è¯¢å•ç‚¹å€¼ï¼Œä¿®æ”¹è·¯å¾„çš„ä¸Šçš„ç‚¹æƒ(HDU 3966 æ ‘é“¾å‰–åˆ† + æ ‘çŠ¶æ•°ç»„)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">50010</span>; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to,next; </span><br><span class="line">&#125;edge[MAXN*<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> head[MAXN],tot;</span><br><span class="line"><span class="keyword">int</span> top[MAXN];<span class="comment">//top[v] è¡¨ç¤º v æ‰€åœ¨çš„é‡é“¾çš„é¡¶ç«¯èŠ‚ç‚¹ int fa[MAXN];//çˆ¶äº²èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> deep[MAXN];<span class="comment">//æ·±åº¦</span></span><br><span class="line"><span class="keyword">int</span> num[MAXN];<span class="comment">//num[v] è¡¨ç¤ºä»¥ v ä¸ºæ ¹çš„å­æ ‘çš„èŠ‚ç‚¹æ•° int p[MAXN];//p[v] è¡¨ç¤º v å¯¹åº”çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">int</span> fp[MAXN];<span class="comment">//fp å’Œ p æ•°ç»„ç›¸å</span></span><br><span class="line"><span class="keyword">int</span> son[MAXN];<span class="comment">//é‡å„¿å­</span></span><br><span class="line"><span class="keyword">int</span> pos;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	tot = <span class="number">0</span>; </span><br><span class="line">    <span class="built_in">memset</span>(head,âˆ’<span class="number">1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(head));</span><br><span class="line">	pos = <span class="number">1</span>;<span class="comment">//ä½¿ç”¨æ ‘çŠ¶æ•°ç»„ï¼Œç¼–å·ä»å¤´ 1 å¼€å§‹ </span></span><br><span class="line">    <span class="built_in">memset</span>(son,âˆ’<span class="number">1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(son));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[tot].to = v; edge[tot].next = head[u]; head[u] = tot++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pre,<span class="keyword">int</span> d)</span></span>&#123; </span><br><span class="line">    deep[u] = d;</span><br><span class="line">    fa[u] = pre;</span><br><span class="line">    num[u] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i != âˆ’<span class="number">1</span>; i = edge[i].next)&#123; </span><br><span class="line">        <span class="keyword">int</span> v = edge[i].to;</span><br><span class="line">		<span class="keyword">if</span>(v != pre)&#123;</span><br><span class="line">			<span class="built_in">dfs1</span>(v,u,d+<span class="number">1</span>);</span><br><span class="line">            num[u] += num[v];</span><br><span class="line">			<span class="keyword">if</span>(son[u] == âˆ’<span class="number">1</span> || num[v] &gt; num[son[u]])</span><br><span class="line">				son[u] = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getpos</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> sp)</span></span>&#123;</span><br><span class="line">    top[u] = sp;</span><br><span class="line">    p[u] = pos++;</span><br><span class="line">    fp[p[u]] = u;</span><br><span class="line">    <span class="keyword">if</span>(son[u] == âˆ’<span class="number">1</span>) <span class="keyword">return</span>; </span><br><span class="line">    <span class="built_in">getpos</span>(son[u],sp);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; i != <span class="number">-1</span>; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(v != son[u] &amp;&amp; v != fa[u])&#123;</span><br><span class="line">            <span class="built_in">getpos</span>(v,v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ ‘çŠ¶æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(âˆ’x); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> c[MAXN];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123; </span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">while</span>(i &gt; <span class="number">0</span>)&#123;</span><br><span class="line">		s += c[i];</span><br><span class="line">		i âˆ’= <span class="built_in">lowbit</span>(i); </span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> s; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> val)</span></span>&#123; </span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">		c[i] += val;</span><br><span class="line">        i += <span class="built_in">lowbit</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//u-&gt;v çš„è·¯å¾„ä¸Šç‚¹çš„å€¼æ”¹å˜ val</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Change</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> f1 = top[u], f2 = top[v]; </span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(f1 != f2)&#123;</span><br><span class="line">		<span class="keyword">if</span>(deep[f1] &lt; deep[f2])&#123; </span><br><span class="line">            <span class="built_in">swap</span>(f1,f2);</span><br><span class="line">			<span class="built_in">swap</span>(u,v); </span><br><span class="line">        &#125;</span><br><span class="line">		<span class="built_in">add</span>(p[f1],val); <span class="built_in">add</span>(p[u]+<span class="number">1</span>,âˆ’val); </span><br><span class="line">        u = fa[f1];</span><br><span class="line">		f1 = top[u];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(deep[u] &gt; deep[v]) <span class="built_in">swap</span>(u,v); </span><br><span class="line">    <span class="built_in">add</span>(p[u],val); </span><br><span class="line">    <span class="built_in">add</span>(p[v]+<span class="number">1</span>,âˆ’val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </span><br><span class="line">    <span class="keyword">int</span> M,P;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;M,&amp;P) == <span class="number">3</span>)&#123; </span><br><span class="line">        <span class="keyword">int</span> u,v;</span><br><span class="line">    	<span class="keyword">int</span> C1,C2,K;</span><br><span class="line">    	<span class="keyword">char</span> op[<span class="number">10</span>];</span><br><span class="line">    	<span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(Mâˆ’âˆ’)&#123; </span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;u,&amp;v); </span><br><span class="line">            <span class="built_in">addedge</span>(u,v); </span><br><span class="line">            <span class="built_in">addedge</span>(v,u);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">getpos</span>(<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line">        <span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(c)); </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">            <span class="built_in">add</span>(p[i],a[i]);</span><br><span class="line">        	<span class="built_in">add</span>(p[i]+<span class="number">1</span>,âˆ’a[i]); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(Pâˆ’âˆ’)&#123; </span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">        	<span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;Q&#x27;</span>)&#123; </span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;u);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">sum</span>(p[u]));</span><br><span class="line">            &#125;</span><br><span class="line">        	<span class="keyword">else</span>&#123; </span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;C1,&amp;C2,&amp;K); </span><br><span class="line">                <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;D&#x27;</span>)&#123;</span><br><span class="line">                    K = âˆ’K; </span><br><span class="line">                    <span class="built_in">Change</span>(C1,C2,K);</span><br><span class="line">                &#125;</span><br><span class="line">        	&#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è¾¹æƒ"><a href="#è¾¹æƒ" class="headerlink" title="è¾¹æƒ"></a>è¾¹æƒ</h4><p>åŸºäºè¾¹æƒï¼Œä¿®æ”¹å•æ¡è¾¹æƒï¼ŒæŸ¥è¯¢è·¯å¾„è¾¹æƒæœ€å¤§å€¼(SPOJ QTREE æ ‘é“¾å‰–åˆ† + çº¿æ®µæ ‘)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10010</span>; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to,next; </span><br><span class="line">&#125;edge[MAXN*<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> head[MAXN],tot;</span><br><span class="line"><span class="keyword">int</span> top[MAXN];<span class="comment">//top[v] è¡¨ç¤º v æ‰€åœ¨çš„é‡é“¾çš„é¡¶ç«¯èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> fa[MAXN]; <span class="comment">//çˆ¶äº²èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> deep[MAXN];<span class="comment">//æ·±åº¦</span></span><br><span class="line"><span class="keyword">int</span> num[MAXN];<span class="comment">//num[v] è¡¨ç¤ºä»¥ v ä¸ºæ ¹çš„å­æ ‘çš„èŠ‚ç‚¹æ•°</span></span><br><span class="line"><span class="keyword">int</span> p[MAXN];<span class="comment">//p[v] è¡¨ç¤º v ä¸å…¶çˆ¶äº²èŠ‚ç‚¹çš„è¿è¾¹åœ¨çº¿æ®µæ ‘ä¸­çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">int</span> fp[MAXN];<span class="comment">//å’Œ p æ•°ç»„ç›¸å </span></span><br><span class="line"><span class="keyword">int</span> son[MAXN];<span class="comment">//é‡å„¿å­</span></span><br><span class="line"><span class="keyword">int</span> pos;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	tot = <span class="number">0</span>; </span><br><span class="line">	<span class="built_in">memset</span>(head,âˆ’<span class="number">1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(head)); </span><br><span class="line">	pos = <span class="number">0</span>; </span><br><span class="line">	<span class="built_in">memset</span>(son,âˆ’<span class="number">1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(son));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[tot].to = v;edge[tot].next = head[u];head[u] = tot++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç¬¬ä¸€é dfs æ±‚å‡º fa,deep,num,son </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pre,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">	deep[u] = d; </span><br><span class="line">	fa[u] = pre; </span><br><span class="line">	num[u] = <span class="number">1</span>; </span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; i != <span class="number">-1</span>; i = edge[i].next)&#123;</span><br><span class="line">		<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line">		<span class="keyword">if</span>(v != pre)&#123;</span><br><span class="line">			<span class="built_in">dfs1</span>(v,u,d+<span class="number">1</span>);</span><br><span class="line">            num[u] += num[v];</span><br><span class="line">            <span class="keyword">if</span>(son[u] == âˆ’<span class="number">1</span> || num[v] &gt; num[son[u]])</span><br><span class="line">            	son[u] = v;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç¬¬äºŒé dfs æ±‚å‡ºtopå’Œp</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getpos</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> sp)</span></span>&#123;</span><br><span class="line">	top[u] = sp;</span><br><span class="line">	p[u] = pos++;</span><br><span class="line">	fp[p[u]] = u;</span><br><span class="line">	<span class="keyword">if</span>(son[u] == âˆ’<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">	<span class="built_in">getpos</span>(son[u],sp);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u] ; i != âˆ’<span class="number">1</span>; i = edge[i].next)&#123;</span><br><span class="line">		<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line">		<span class="keyword">if</span>(v != son[u] &amp;&amp; v != fa[u])</span><br><span class="line">            <span class="built_in">getpos</span>(v,v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//çº¿æ®µæ ‘ </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> l,r;</span><br><span class="line">	<span class="keyword">int</span> Max;</span><br><span class="line">&#125;segTree[MAXN*<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	segTree[i].l = l; segTree[i].r = r; </span><br><span class="line">	segTree[i].Max = <span class="number">0</span>; </span><br><span class="line">	<span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>; </span><br><span class="line">	<span class="built_in">build</span>(i&lt;&lt;<span class="number">1</span>,l,mid); <span class="built_in">build</span>((i&lt;&lt;<span class="number">1</span>)|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    segTree[i].Max = <span class="built_in">max</span>(segTree[i&lt;&lt;<span class="number">1</span>].Max,segTree[(i&lt;&lt;<span class="number">1</span>)|<span class="number">1</span>].Max);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ›´æ–°çº¿æ®µæ ‘çš„ç¬¬ k ä¸ªå€¼ä¸º val</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> k,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(segTree[i].l == k &amp;&amp; segTree[i].r == k)&#123; </span><br><span class="line">		segTree[i].Max = val;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> mid = (segTree[i].l + segTree[i].r)/<span class="number">2</span>; </span><br><span class="line">	<span class="keyword">if</span>(k &lt;= mid)<span class="built_in">update</span>(i&lt;&lt;<span class="number">1</span>,k,val);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">update</span>((i&lt;&lt;<span class="number">1</span>)|<span class="number">1</span>,k,val);</span><br><span class="line">	<span class="built_in">push_up</span>(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŸ¥è¯¢çº¿æ®µæ ‘ä¸­ [l,r] çš„æœ€å¤§å€¼ </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(segTree[i].l == l &amp;&amp; segTree[i].r == r) </span><br><span class="line">    	<span class="keyword">return</span> segTree[i].Max;</span><br><span class="line">    <span class="keyword">int</span> mid = (segTree[i].l + segTree[i].r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(r &lt;= mid) <span class="keyword">return</span> <span class="built_in">query</span>(i&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(l &gt; mid) <span class="keyword">return</span> <span class="built_in">query</span>((i&lt;&lt;<span class="number">1</span>)|<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">query</span>(i&lt;&lt;<span class="number">1</span>,l,mid),<span class="built_in">query</span>((i&lt;&lt;<span class="number">1</span>)|<span class="number">1</span>,mid+<span class="number">1</span>,r));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŸ¥è¯¢ u-&gt;v è¾¹çš„æœ€å¤§å€¼ </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> f1 = top[u], f2 = top[v]; </span><br><span class="line">	<span class="keyword">int</span> tmp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(f1 != f2)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(deep[f1] &lt; deep[f2])&#123; </span><br><span class="line">            <span class="built_in">swap</span>(f1,f2);</span><br><span class="line">            <span class="built_in">swap</span>(u,v); </span><br><span class="line">        &#125;</span><br><span class="line">        tmp = <span class="built_in">max</span>(tmp,<span class="built_in">query</span>(<span class="number">1</span>,p[f1],p[u]));</span><br><span class="line">    	u= fa[f1]; </span><br><span class="line">    	f1 = top[u]; </span><br><span class="line">   	&#125;</span><br><span class="line">   	<span class="keyword">if</span>(u == v) <span class="keyword">return</span> temp;</span><br><span class="line">   	<span class="keyword">if</span>(deep[u] &gt; deep[v]) <span class="built_in">swap</span>(u,v);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>(tmp,<span class="built_in">query</span>(<span class="number">1</span>,p[son[u]],p[v]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> e[MAXN][<span class="number">3</span>]; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="keyword">int</span> n; </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T); </span><br><span class="line">    <span class="keyword">while</span>(Tâˆ’âˆ’)&#123;</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; nâˆ’<span class="number">1</span>;i++)&#123; </span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;e[i][<span class="number">0</span>],&amp;e[i][<span class="number">1</span>],&amp;e[i][<span class="number">2</span>]); </span><br><span class="line">            <span class="built_in">addedge</span>(e[i][<span class="number">0</span>],e[i][<span class="number">1</span>]); </span><br><span class="line">            <span class="built_in">addedge</span>(e[i][<span class="number">1</span>],e[i][<span class="number">0</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">getpos</span>(<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>,<span class="number">0</span>,posâˆ’<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; nâˆ’<span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(deep[e[i][<span class="number">0</span>]] &gt; deep[e[i][<span class="number">1</span>]]) </span><br><span class="line">                <span class="built_in">swap</span>(e[i][<span class="number">0</span>],e[i][<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>,p[e[i][<span class="number">1</span>]],e[i][<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">char</span> op[<span class="number">10</span>];</span><br><span class="line">		<span class="keyword">int</span> u,v; </span><br><span class="line">		<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op) == <span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;D&#x27;</span>)<span class="keyword">break</span>; </span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;u,&amp;v); </span><br><span class="line">			<span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">find</span>(u,v));<span class="comment">//æŸ¥è¯¢ u-&gt;v è·¯å¾„ä¸Šè¾¹æƒçš„æœ€å¤§å€¼</span></span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">update</span>(<span class="number">1</span>,p[e[uâˆ’<span class="number">1</span>][<span class="number">1</span>]],v);<span class="comment">//ä¿®æ”¹ç¬¬ u æ¡è¾¹çš„é•¿åº¦ä¸º v</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Manacher-é©¬æ‹‰è½¦"><a href="#Manacher-é©¬æ‹‰è½¦" class="headerlink" title="Manacher(é©¬æ‹‰è½¦)"></a>Manacher(é©¬æ‹‰è½¦)</h1><p><strong>ç”¨å¤„ï¼š</strong>æ±‚å­—ç¬¦ä¸²æ‰€æœ‰çš„å›æ–‡å­ä¸²é•¿åº¦ï¼ˆæœ€å¤§å€¼ï¼‰</p>
<p>p[i]ä»£è¡¨ä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²é•¿åº¦</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e7</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> a[N], b[N];</span><br><span class="line"><span class="keyword">int</span> p[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    b[k ++ ] = <span class="string">&#x27;$&#x27;</span>, b[k ++ ] = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ ) b[k ++ ] = a[i], b[k ++ ] = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    b[k ++ ] = <span class="string">&#x27;^&#x27;</span>;</span><br><span class="line">    n = k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manacher</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mr = <span class="number">0</span>, mid;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; mr) p[i] = <span class="built_in">min</span>(p[mid * <span class="number">2</span> - i], mr - i);</span><br><span class="line">        <span class="keyword">else</span> p[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (b[i - p[i]] == b[i + p[i]]) p[i] ++ ;</span><br><span class="line">        <span class="keyword">if</span> (i + p[i] &gt; mr)</span><br><span class="line">        &#123;</span><br><span class="line">            mr = i + p[i];</span><br><span class="line">            mid = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, a);</span><br><span class="line">    n = <span class="built_in">strlen</span>(a);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">manacher</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ ) res = <span class="built_in">max</span>(res, p[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, res - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h1><p>åŒ…å«å€¼åŸŸå’ŒæŒ‡é’ˆåŸŸ</p>
<h4 id="å•å‘é“¾è¡¨"><a href="#å•å‘é“¾è¡¨" class="headerlink" title="å•å‘é“¾è¡¨"></a>å•å‘é“¾è¡¨</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// headå­˜å‚¨é“¾è¡¨å¤´ï¼Œe[]å­˜å‚¨èŠ‚ç‚¹çš„å€¼ï¼Œne[]å­˜å‚¨èŠ‚ç‚¹çš„nextæŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> head, e[N], ne[N], idx;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    head = <span class="number">-1</span>;</span><br><span class="line">    idx = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨é“¾è¡¨å¤´æ’å…¥ä¸€ä¸ªæ•°a</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = a, ne[idx] = head, head = idx ++ ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å¤´ç»“ç‚¹åˆ é™¤ï¼Œéœ€è¦ä¿è¯å¤´ç»“ç‚¹å­˜åœ¨</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    head = ne[head];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="åŒå‘é“¾è¡¨"><a href="#åŒå‘é“¾è¡¨" class="headerlink" title="åŒå‘é“¾è¡¨"></a>åŒå‘é“¾è¡¨</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// e[]è¡¨ç¤ºèŠ‚ç‚¹çš„å€¼ï¼Œl[]è¡¨ç¤ºèŠ‚ç‚¹çš„å·¦æŒ‡é’ˆï¼Œr[]è¡¨ç¤ºèŠ‚ç‚¹çš„å³æŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> e[N], l[N], r[N], idx;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//0æ˜¯å·¦ç«¯ç‚¹ï¼Œ1æ˜¯å³ç«¯ç‚¹</span></span><br><span class="line">    r[<span class="number">0</span>] = <span class="number">1</span>, l[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    idx = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨èŠ‚ç‚¹açš„å³è¾¹æ’å…¥ä¸€ä¸ªæ•°x</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">r_insert</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = x;</span><br><span class="line">    l[idx] = a, r[idx] = r[a];</span><br><span class="line">    l[r[a]] = idx, r[a] = idx ++ ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨èŠ‚ç‚¹açš„å·¦è¾¹æ’å…¥ä¸€ä¸ªæ•°x</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">l_insert</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = x;</span><br><span class="line">    r[idx] = a, l[idx] = l[a];</span><br><span class="line">    r[r[a]] = idx, l[a] = idx ++ ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤èŠ‚ç‚¹a</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    l[r[a]] = l[a];</span><br><span class="line">    r[l[a]] = r[a];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="å­—ç¬¦ä¸²å“ˆå¸Œ"><a href="#å­—ç¬¦ä¸²å“ˆå¸Œ" class="headerlink" title="å­—ç¬¦ä¸²å“ˆå¸Œ"></a>å­—ç¬¦ä¸²å“ˆå¸Œ</h1><p>æ ¸å¿ƒæ€æƒ³ï¼šå°†å­—ç¬¦ä¸²çœ‹æˆPè¿›åˆ¶æ•°ï¼ŒPçš„ç»éªŒå€¼æ˜¯131æˆ–13331ï¼Œå–è¿™ä¸¤ä¸ªå€¼çš„å†²çªæ¦‚ç‡ä½<br>å°æŠ€å·§ï¼šå–æ¨¡çš„æ•°ç”¨2^64ï¼Œè¿™æ ·ç›´æ¥ç”¨unsigned long longå­˜å‚¨ï¼Œæº¢å‡ºçš„ç»“æœå°±æ˜¯å–æ¨¡çš„ç»“æœ</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">ULL h[N], p[N]; <span class="comment">// h[k]å­˜å‚¨å­—ç¬¦ä¸²å‰kä¸ªå­—æ¯çš„å“ˆå¸Œå€¼, p[k]å­˜å‚¨ P^k mod 2^64</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">&#123;</span><br><span class="line">    h[i] = h[i - <span class="number">1</span>] * P + str[i];</span><br><span class="line">    p[i] = p[i - <span class="number">1</span>] * P;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—å­ä¸² str[l ~ r] çš„å“ˆå¸Œå€¼</span></span><br><span class="line"><span class="function">ULL <span class="title">get</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> h[r] - h[l - <span class="number">1</span>] * p[r - l + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h1><p>ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> primes[N], cnt;     <span class="comment">// primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°</span></span><br><span class="line"><span class="keyword">int</span> euler[N];           <span class="comment">// å­˜å‚¨æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°</span></span><br><span class="line"><span class="keyword">bool</span> st[N];         <span class="comment">// st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_eulers</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    euler[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i])</span><br><span class="line">        &#123;</span><br><span class="line">            primes[cnt ++ ] = i;</span><br><span class="line">            euler[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; j ++ )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> t = primes[j] * i;</span><br><span class="line">            st[t] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                euler[t] = euler[i] * primes[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            euler[t] = euler[i] * (primes[j] - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æœ´ç´ æ±‚å•ä¸ªæ¬§æ‹‰å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x / i; i ++ )</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            res = res / i * (i - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) x /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) res = res / x * (x - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="è´¨æ•°ç­›"><a href="#è´¨æ•°ç­›" class="headerlink" title="è´¨æ•°ç­›"></a>è´¨æ•°ç­›</h1><p>çº¿æ€§ç­›</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> primes[N], cnt;     <span class="comment">// primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°</span></span><br><span class="line"><span class="keyword">bool</span> st[N];         <span class="comment">// st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_primes</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt ++ ] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; j ++ )</span><br><span class="line">        &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="åˆ†è§£è´¨å› æ•°"><a href="#åˆ†è§£è´¨å› æ•°" class="headerlink" title="åˆ†è§£è´¨å› æ•°"></a>åˆ†è§£è´¨å› æ•°</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> x)</span><span class="comment">//ç›´æ¥å¤„ç†</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x / i; i ++ )</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) x /= i, s ++ ;</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------ </span><br><span class="line"><span class="comment">//å…ˆç­›å‡ºè´¨æ•°å‡å°‘å¾ªç¯</span></span><br><span class="line"><span class="keyword">int</span> primes[N], cnt;     <span class="comment">// primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°</span></span><br><span class="line"><span class="keyword">bool</span> st[N];         <span class="comment">// st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_primes</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt ++ ] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; j ++ )</span><br><span class="line">        &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> x)</span><span class="comment">//è¾“å‡ºæ ¼å¼ è´¨å› æ•° ä¸ªæ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;<span class="comment">//è´¨å› å­ç§ç±»æ•°  8åªæœ‰1ä¸ª</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; primes[i] &lt;= x / primes[i]; i ++ )</span><br><span class="line">        <span class="keyword">if</span> (x % primes[i] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (x % primes[i] == <span class="number">0</span>) x /= primes[i], s ++ ;</span><br><span class="line">            cout &lt;&lt; primes[i] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">        cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç»„åˆæ•°"><a href="#ç»„åˆæ•°" class="headerlink" title="ç»„åˆæ•°"></a>ç»„åˆæ•°</h1><h4 id="é€’å½’æ³•-èŒƒå›´2000"><a href="#é€’å½’æ³•-èŒƒå›´2000" class="headerlink" title="é€’å½’æ³•    èŒƒå›´2000"></a>é€’å½’æ³•    èŒƒå›´2000</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// c[a][b] è¡¨ç¤ºä»aä¸ªè‹¹æœä¸­é€‰bä¸ªçš„æ–¹æ¡ˆæ•°</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++ )</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++ )</span><br><span class="line">        <span class="keyword">if</span> (!j) c[i][j] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> c[i][j] = (c[i - <span class="number">1</span>][j] + c[i - <span class="number">1</span>][j - <span class="number">1</span>]) % mod;</span><br></pre></td></tr></table></figure>
<h4 id="é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•°-èŒƒå›´1e5"><a href="#é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•°-èŒƒå›´1e5" class="headerlink" title="é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•°        èŒƒå›´1e5"></a>é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•°        èŒƒå›´1e5</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">é¦–å…ˆé¢„å¤„ç†å‡ºæ‰€æœ‰é˜¶ä¹˜å–æ¨¡çš„ä½™æ•°fact[N]ï¼Œä»¥åŠæ‰€æœ‰é˜¶ä¹˜å–æ¨¡çš„é€†å…ƒinfact[N]</span><br><span class="line">å¦‚æœå–æ¨¡çš„æ•°æ˜¯è´¨æ•°ï¼Œå¯ä»¥ç”¨è´¹é©¬å°å®šç†æ±‚é€†å…ƒ</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span>    <span class="comment">// å¿«é€Ÿå¹‚æ¨¡æ¿</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;</span><br><span class="line">        a = (ll)a * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¢„å¤„ç†é˜¶ä¹˜çš„ä½™æ•°å’Œé˜¶ä¹˜é€†å…ƒçš„ä½™æ•°</span></span><br><span class="line">fact[<span class="number">0</span>] = infact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++ )</span><br><span class="line">&#123;</span><br><span class="line">    fact[i] = (ll)fact[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    infact[i] = (ll)infact[i - <span class="number">1</span>] * <span class="built_in">qmi</span>(i, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(n,m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fact[n]*infact[m]%mod*infact[n-m]%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.acwing.com/media/article/image/2020/07/16/35805_f4228ae4c7-%E7%BB%84%E5%90%88%E6%95%B0.png" alt=""></p>
<h4 id="Lucaså®šç†-èŒƒå›´1e18-ï¼Œæ¨¡æ•°pèŒƒå›´1e5"><a href="#Lucaså®šç†-èŒƒå›´1e18-ï¼Œæ¨¡æ•°pèŒƒå›´1e5" class="headerlink" title="Lucaså®šç†        èŒƒå›´1e18  ï¼Œæ¨¡æ•°pèŒƒå›´1e5"></a>Lucaså®šç†        èŒƒå›´1e18  ï¼Œæ¨¡æ•°pèŒƒå›´1e5</h4><p>è‹¥pæ˜¯è´¨æ•°ï¼Œåˆ™å¯¹äºä»»æ„æ•´æ•° 1 &lt;= m &lt;= nï¼Œæœ‰ï¼š</p>
<p> C(n, m) = C(n % p, m % p) * C(n / p, m / p) (mod p)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span>  <span class="comment">// å¿«é€Ÿå¹‚æ¨¡æ¿</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span> % p;</span><br><span class="line">    <span class="keyword">while</span> (k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;</span><br><span class="line">        a = (ll)a * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span>  <span class="comment">// é€šè¿‡å®šç†æ±‚ç»„åˆæ•°C(a, b)</span></span></span><br><span class="line"><span class="function"><span class="comment">//å¯ä»¥æ›¿æ¢æˆä¸Šé¢é¢„å¤„ç†é˜¶ä¹˜æ±‚ç»„åˆæ•°å˜æˆO(1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; b) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    LL x = <span class="number">1</span>, y = <span class="number">1</span>;  <span class="comment">// xæ˜¯åˆ†å­ï¼Œyæ˜¯åˆ†æ¯</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = a, j = <span class="number">1</span>; j &lt;= b; i --, j ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        x = (ll)x * i % p;</span><br><span class="line">        y = (ll) y * j % p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> x * (LL)<span class="built_in">qmi</span>(y, p - <span class="number">2</span>, p) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lucas</span><span class="params">(ll a, ll b, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; p &amp;&amp; b &lt; p) <span class="keyword">return</span> <span class="built_in">C</span>(a, b, p);</span><br><span class="line">    <span class="keyword">return</span> (ll)<span class="built_in">C</span>(a % p, b % p, p) * <span class="built_in">lucas</span>(a / p, b / p, p) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="è´¨å› æ•°åˆ†è§£æ±‚ç»„åˆæ•°-çœŸå®å€¼"><a href="#è´¨å› æ•°åˆ†è§£æ±‚ç»„åˆæ•°-çœŸå®å€¼" class="headerlink" title="è´¨å› æ•°åˆ†è§£æ±‚ç»„åˆæ•°    çœŸå®å€¼"></a>è´¨å› æ•°åˆ†è§£æ±‚ç»„åˆæ•°    çœŸå®å€¼</h4><p>å½“æˆ‘ä»¬éœ€è¦æ±‚å‡ºç»„åˆæ•°çš„çœŸå®å€¼ï¼Œè€Œéå¯¹æŸä¸ªæ•°çš„ä½™æ•°æ—¶ï¼Œåˆ†è§£è´¨å› æ•°çš„æ–¹å¼æ¯”è¾ƒå¥½ç”¨ï¼š</p>
<ol>
<li>ç­›æ³•æ±‚å‡ºèŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•°</li>
<li>é€šè¿‡ C(a, b) = a! / b! / (a - b)! è¿™ä¸ªå…¬å¼æ±‚å‡ºæ¯ä¸ªè´¨å› å­çš„æ¬¡æ•°ã€‚ n! ä¸­pçš„æ¬¡æ•°æ˜¯ n / p + n / p^2 + n / p^3 + â€¦</li>
<li>ç”¨é«˜ç²¾åº¦ä¹˜æ³•å°†æ‰€æœ‰è´¨å› å­ç›¸ä¹˜</li>
</ol>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> primes[N], cnt;     <span class="comment">// å­˜å‚¨æ‰€æœ‰è´¨æ•°</span></span><br><span class="line"><span class="keyword">int</span> sum[N];     <span class="comment">// å­˜å‚¨æ¯ä¸ªè´¨æ•°çš„æ¬¡æ•°</span></span><br><span class="line"><span class="keyword">bool</span> st[N];     <span class="comment">// å­˜å‚¨æ¯ä¸ªæ•°æ˜¯å¦å·²è¢«ç­›æ‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_primes</span><span class="params">(<span class="keyword">int</span> n)</span>      <span class="comment">// çº¿æ€§ç­›æ³•æ±‚ç´ æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt ++ ] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; j ++ )</span><br><span class="line">        &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> p)</span>       <span class="comment">// æ±‚nï¼ä¸­çš„æ¬¡æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n)</span><br><span class="line">    &#123;</span><br><span class="line">        res += n / p;</span><br><span class="line">        n /= p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">mul</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; a, <span class="keyword">int</span> b)</span>       <span class="comment">// é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦æ¨¡æ¿</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; c;</span><br><span class="line">    <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        t += a[i] * b;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (t)</span><br><span class="line">    &#123;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">get_primes</span>(a);  <span class="comment">// é¢„å¤„ç†èŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i ++ )     <span class="comment">// æ±‚æ¯ä¸ªè´¨å› æ•°çš„æ¬¡æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> p = primes[i];</span><br><span class="line">    sum[i] = <span class="built_in">get</span>(a, p) - <span class="built_in">get</span>(b, p) - <span class="built_in">get</span>(a - b, p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">res.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i ++ )     <span class="comment">// ç”¨é«˜ç²¾åº¦ä¹˜æ³•å°†æ‰€æœ‰è´¨å› å­ç›¸ä¹˜</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sum[i]; j ++ )</span><br><span class="line">        res = <span class="built_in">mul</span>(res, primes[i]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Splay"><a href="#Splay" class="headerlink" title="Splay"></a>Splay</h1><p><strong>ä¸»è¦ä½œç”¨ï¼š</strong>ç»´æŠ¤åŒºé—´ç‰¹å®šçš„é¡ºåºï¼ˆä¸­åºéå†é¡ºåºä¸å˜ï¼‰</p>
<p><strong>æ–‡è‰ºä¼¸å±•æ ‘</strong></p>
<p>åŒºé—´ç¿»è½¬é—®é¢˜ï¼šè¿™é‡Œç¼–å·å¯èƒ½ä¼šæ”¹å˜ï¼Œä½†æ˜¯ç»´æŠ¤çš„æ˜¯å¦ä¸€ä¸ªéšè—çš„é¡ºåºâ€”â€”æ­¤æ—¶åŒºé—´ä»å·¦å¾€å³çš„é¡ºåºã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> s[<span class="number">2</span>];<span class="comment">//s[0]å·¦å„¿å­,s[1]å³å„¿å­</span></span><br><span class="line">  <span class="keyword">int</span> p, v;<span class="comment">//pçˆ¶äº²èŠ‚ç‚¹ç¼–å·ï¼ŒvèŠ‚ç‚¹ç¼–å·</span></span><br><span class="line">	<span class="keyword">int</span> size;<span class="comment">//å½“å‰èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘å¤§å°</span></span><br><span class="line">  <span class="keyword">int</span> flag;<span class="comment">//å½“å‰èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘æ˜¯å¦åè½¬</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _v, <span class="keyword">int</span> _p)</span></span>&#123;<span class="comment">//æ–°èŠ‚ç‚¹åˆå§‹åŒ–</span></span><br><span class="line">		v = _v, p = _p;</span><br><span class="line">		size = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="keyword">int</span> root, idx;<span class="comment">//æ ¹èŠ‚ç‚¹ç¼–å·ï¼ŒèŠ‚ç‚¹ä¸ªæ•°ï¼ˆç›¸å½“äºå†…å­˜æ± çš„æŒ‡é’ˆï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span><span class="comment">//ç”±å­æ ‘æ›´æ–°å½“å‰èŠ‚ç‚¹ä¿¡æ¯ï¼ˆç»´æŠ¤çš„ä¿¡æ¯ä¸€èˆ¬æ˜¯æ‰€æœ‰å­èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ˆæœ€å€¼ï¼Œä¸ªæ•°ï¼‰ï¼‰</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	tr[x].size = tr[tr[x].s[<span class="number">0</span>]].size + tr[tr[x].s[<span class="number">1</span>]].size + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="comment">//æ›´æ–°å­èŠ‚ç‚¹ä¿¡æ¯ï¼Œä¸€èˆ¬åœ¨ä¿®æ”¹æ—¶ç”¨åˆ°ï¼ŒæŸ¥è¯¢ä¹Ÿç”¨åˆ°ï¼ˆè¦ä¼ åˆ°å¶å­èŠ‚ç‚¹æ‰èƒ½å¾—åˆ°çœŸå®å€¼ï¼‰</span></span><br><span class="line">	<span class="keyword">if</span>(tr[x].flag)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">swap</span>(tr[x].s[<span class="number">0</span>], tr[x].s[<span class="number">1</span>]);<span class="comment">//åè½¬æ“ä½œ</span></span><br><span class="line">    <span class="comment">//ä¸‹ä¼ </span></span><br><span class="line">		tr[tr[x].s[<span class="number">0</span>]].flag ^= <span class="number">1</span>;</span><br><span class="line">		tr[tr[x].s[<span class="number">1</span>]].flag ^= <span class="number">1</span>;</span><br><span class="line">		tr[x].flag = <span class="number">0</span>;<span class="comment">//æ¸…é™¤æ ‡è®°</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="comment">//å·¦æ—‹å³æ—‹ï¼ˆåˆå¹¶äº†ï¼‰</span></span><br><span class="line">	<span class="keyword">int</span> y = tr[x].p, z = tr[y].p;</span><br><span class="line">	<span class="keyword">int</span> k = tr[y].s[<span class="number">1</span>] == x;<span class="comment">//xæ˜¯yçš„s[k]</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  å£è¯€ï¼šï¼ˆå¯¹äºxï¼‰</span></span><br><span class="line"><span class="comment">  åå„¿å­ä»£æ›¿è‡ªå·±å˜æˆçˆ¶äº²æ­£å„¿å­</span></span><br><span class="line"><span class="comment">  çˆ¶äº²å˜æˆè‡ªå·±çš„åå„¿å­</span></span><br><span class="line"><span class="comment">  ä»£æ›¿çˆ¶äº²æˆä¸ºçˆ·çˆ·çš„ï¼ˆä¸åŸæ¥ç›¸åŒï¼‰å„¿å­</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="comment">//æ›´æ–°çˆ¶å­å…³ç³»</span></span><br><span class="line">	tr[y].s[k] = tr[x].s[k^<span class="number">1</span>];</span><br><span class="line">	tr[tr[x].s[k^<span class="number">1</span>]].p = y;</span><br><span class="line">  </span><br><span class="line">	tr[x].s[k^<span class="number">1</span>] = y;</span><br><span class="line">	tr[y].p = x;</span><br><span class="line">  </span><br><span class="line">	tr[z].s[y==tr[z].s[<span class="number">1</span>]] = x;</span><br><span class="line">	tr[x].p = z;</span><br><span class="line">	<span class="built_in">pushup</span>(x),<span class="built_in">pushup</span>(y);<span class="comment">//çˆ¶å­å…³ç³»æ”¹å˜ï¼Œæ›´æ–°ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> k)</span></span>&#123;<span class="comment">//æŠŠxä¸æ–­å·¦æ—‹æˆ–å³æ—‹åˆ°kï¼Œå¹¶ä¿æŒå¹³è¡¡</span></span><br><span class="line">  <span class="comment">//ä¸€èˆ¬è®¾ç½®0ï¼Œn+1ä¸ºå·¦å³å“¨å…µ</span></span><br><span class="line">	<span class="keyword">while</span>(tr[x].p != k)&#123;<span class="comment">//æ²¡æœ‰åˆ°è¾¾</span></span><br><span class="line">		<span class="keyword">int</span> y = tr[x].p, z = tr[y].p;</span><br><span class="line">		<span class="keyword">if</span>(z!=k)&#123;<span class="comment">//çˆ·çˆ·å¦‚æœå°±æ˜¯kï¼Œåªéœ€è¦å•æ—‹</span></span><br><span class="line">			<span class="keyword">if</span>((tr[y].s[<span class="number">1</span>]==x) ^ (tr[z].s[<span class="number">1</span>]==y)) <span class="built_in">rotate</span>(x);<span class="comment">//ç›´çº¿å‹</span></span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">rotate</span>(y);<span class="comment">//ä¹‹å­—å‹</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">rotate</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(!k) root = x;<span class="comment">//k==0è¯´æ˜æ­¤æ—¶xæ˜¯æ ¹ï¼Œæ›´æ–°root</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> v)</span></span>&#123;<span class="comment">//biuldè¦é€’å½’ï¼Œå¯ä»¥ä¸€ä¸ªä¸€ä¸ªæ’å…¥å»ºç«‹</span></span><br><span class="line">	<span class="keyword">int</span> u = root, p = <span class="number">0</span>;<span class="comment">//ä»æ ¹èŠ‚ç‚¹å¼€å§‹å¾€ä¸‹æŸ¥æ‰¾</span></span><br><span class="line">	<span class="keyword">while</span>(u) p = u, u = tr[u].s[v&gt;tr[u].v];<span class="comment">//vå¤§åœ¨å³å­æ ‘</span></span><br><span class="line">	u = ++idx;<span class="comment">//æ–°å»ºèŠ‚ç‚¹çš„ç¼–å·</span></span><br><span class="line">	<span class="keyword">if</span>(p) tr[p].s[v&gt;tr[p].v] = u;<span class="comment">//å¦‚æœpä¸æ˜¯å“¨å…µï¼Œè¯´æ˜uä¸æ˜¯æ ¹é‚£å®ƒçˆ¶äº²èŠ‚ç‚¹æ˜¯p</span></span><br><span class="line">	tr[u].<span class="built_in">init</span>(v,p);<span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">	<span class="built_in">splay</span>(u,<span class="number">0</span>);<span class="comment">//æŠŠuä¼¸å±•åˆ°æ ¹ï¼Œä¿è¯å¹³è¡¡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_k</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;<span class="comment">//æ‰¾åˆ°ä¸­åºéå†ç¬¬kä¸ªç‚¹</span></span><br><span class="line">	<span class="keyword">int</span> u = root;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">pushdown</span>(u);<span class="comment">//æ ‡è®°ä¸‹ä¼ </span></span><br><span class="line">    <span class="comment">//ç”±å­æ ‘å¤§å°é€’å½’å·¦å„¿å­æˆ–å³å„¿å­</span></span><br><span class="line">		<span class="keyword">if</span>(tr[tr[u].s[<span class="number">0</span>]].size&gt;=k) u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(tr[tr[u].s[<span class="number">0</span>]].size+<span class="number">1</span>==k) <span class="keyword">return</span> u;</span><br><span class="line">		<span class="keyword">else</span> k-=tr[tr[u].s[<span class="number">0</span>]].size+<span class="number">1</span>,u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;<span class="comment">//ä¸­åºéå†</span></span><br><span class="line">	<span class="built_in">pushdown</span>(u);</span><br><span class="line">	<span class="keyword">if</span>(tr[u].s[<span class="number">0</span>]) <span class="built_in">output</span>(tr[u].s[<span class="number">0</span>]);</span><br><span class="line">	<span class="keyword">if</span>(tr[u].v&gt;=<span class="number">1</span>&amp;&amp;tr[u].v&lt;=n) <span class="built_in">wtb</span>(tr[u].v);<span class="comment">//æ’é™¤å“¨å…µ</span></span><br><span class="line">	<span class="keyword">if</span>(tr[u].s[<span class="number">1</span>]) <span class="built_in">output</span>(tr[u].s[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="ä¸‰åˆ†"><a href="#ä¸‰åˆ†" class="headerlink" title="ä¸‰åˆ†"></a>ä¸‰åˆ†</h1><h3 id="1-æ™®é€šä¸‰åˆ†"><a href="#1-æ™®é€šä¸‰åˆ†" class="headerlink" title="1. æ™®é€šä¸‰åˆ†"></a>1. æ™®é€šä¸‰åˆ†</h3><p>æŠŠåŒºé—´ä¸‰ç­‰åˆ†ï¼Œéœ€è¦ä¸¤ä¸ªç‚¹m1ï¼Œm2ï¼Œçœ‹å“ªä¸ªå‡½æ•°å€¼æ›´æ¥è¿‘æå€¼ç‚¹ï¼Œä¿ç•™å®ƒæ›´é è¿‘çš„ç«¯ç‚¹ï¼Œå¦ä¸€ä¸ªç«¯ç‚¹å˜æˆm1ï¼Œm2å…¶ä¸­çš„ä¸€ä¸ªï¼Œå¦‚å›¾</p>
<p><img src="https://pic2.zhimg.com/80/v2-4a6039459e5d9afc346ab74a3dab9e21_1440w.jpg" alt="1"></p>
<p>m2æ¯”m1æ›´é è¿‘æå€¼ç‚¹ï¼Œæ‰€ä»¥rä¸å˜ï¼Œl = m1</p>
<p><strong>ä¸èƒ½å¤„ç†å­˜åœ¨å‡½æ•°å€¼ç›¸ç­‰çš„å•å³°å‡½æ•°ï¼Œå¿…é¡»ä¸¥æ ¼å•è°ƒ</strong></p>
<p>å¤šå³°å‡½æ•°æ±‚æå€¼ç”¨æ¨¡æ‹Ÿé€€ç«</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">double</span> l = <span class="number">0</span>,r = <span class="number">10000</span>;</span><br><span class="line"><span class="keyword">while</span>(r-l&gt;=<span class="number">0.01</span>)&#123;<span class="comment">//ç²¾åº¦é—®é¢˜</span></span><br><span class="line">    <span class="keyword">double</span> m1 = l + (r-l)/<span class="number">3.0</span>,m2 = r - (r-l)/<span class="number">3.0</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">f</span>(m1)&lt;<span class="built_in">f</span>(m2))<span class="comment">//æå¤§å€¼</span></span><br><span class="line">        l = m1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r = m2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-ä¸‰åˆ†å¥—ä¸‰åˆ†"><a href="#2-ä¸‰åˆ†å¥—ä¸‰åˆ†" class="headerlink" title="2.ä¸‰åˆ†å¥—ä¸‰åˆ†"></a>2.ä¸‰åˆ†å¥—ä¸‰åˆ†</h3><p>ä¸‰åˆ†å¥—ä¸‰åˆ†ä¸ä¸‰åˆ†ç±»ä¼¼ï¼Œæ¯ä¸ªä¸‰åˆ†å¯¹åº”çš„éƒ½æ˜¯ä¸€ä¸ªå˜é‡ï¼Œåœ¨ä¸‰åˆ†ç¬¬ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œå†ä¸‰åˆ†ç¬¬äºŒä¸ªå˜é‡ï¼Œä¸äºŒåˆ†å¥—äºŒåˆ†ç±»ä¼¼ã€‚å½“ç„¶ï¼Œæ¯ä¸ªå˜é‡ä¸ç­”æ¡ˆä¹‹é—´çš„å…³ç³»æ˜¯ä¸€ä¸ªå•å³°å‡½æ•°ï¼Œå¦‚æœæ˜¯å•è°ƒçš„æ¢æˆäºŒåˆ†å³å¯ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(r-l&gt;=<span class="number">0.01</span>)&#123;<span class="comment">//ä¸‰åˆ†y</span></span><br><span class="line">        <span class="keyword">double</span> m1 = l + (r-l)/<span class="number">3.0</span>,m2 = r - (r-l)/<span class="number">3.0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">f</span>(m1)&lt;<span class="built_in">f</span>(m2))<span class="comment">//æå¤§å€¼</span></span><br><span class="line">            l = m1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = m2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(r-l&gt;=<span class="number">0.01</span>)&#123;<span class="comment">//ä¸‰åˆ†x</span></span><br><span class="line">    <span class="keyword">double</span> m1 = l + (r-l)/<span class="number">3.0</span>,m2 = r - (r-l)/<span class="number">3.0</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">find</span>(m1)&lt;<span class="built_in">find</span>(m2))</span><br><span class="line">        l = m1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r = m2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="è®¡ç®—å‡ ä½•"><a href="#è®¡ç®—å‡ ä½•" class="headerlink" title="è®¡ç®—å‡ ä½•"></a>è®¡ç®—å‡ ä½•</h1><h4 id="1-å¸¸ç”¨åŸºç¡€å‡½æ•°"><a href="#1-å¸¸ç”¨åŸºç¡€å‡½æ•°" class="headerlink" title="1.å¸¸ç”¨åŸºç¡€å‡½æ•°"></a>1.å¸¸ç”¨åŸºç¡€å‡½æ•°</h4><h5 id="ç¬¦å·å‡½æ•°"><a href="#ç¬¦å·å‡½æ•°" class="headerlink" title="ç¬¦å·å‡½æ•°"></a>ç¬¦å·å‡½æ•°</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">fabs</span>(x) &lt; eps) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> (x&lt;<span class="number">0</span>) ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="è§’åº¦å¼§åº¦è½¬åŒ–"><a href="#è§’åº¦å¼§åº¦è½¬åŒ–" class="headerlink" title="è§’åº¦å¼§åº¦è½¬åŒ–"></a>è§’åº¦å¼§åº¦è½¬åŒ–</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">R_to_D</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="comment">//å¼§åº¦è½¬è§’åº¦</span></span><br><span class="line">	<span class="keyword">return</span> x * <span class="number">180</span> / PI;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">D_to_R</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="comment">//è§’åº¦è½¬å¼§åº¦</span></span><br><span class="line">    <span class="keyword">return</span> x / <span class="number">180</span> * PI;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="å¼§é•¿è®¡ç®—"><a href="#å¼§é•¿è®¡ç®—" class="headerlink" title="å¼§é•¿è®¡ç®—"></a>å¼§é•¿è®¡ç®—</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Arc_len</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> R)</span> </span>&#123; <span class="comment">//å¼§åº¦ç®—å¼§é•¿</span></span><br><span class="line">	<span class="keyword">return</span> x * R; <span class="comment">//Ræ˜¯åŠå¾„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Arc_len</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> R)</span> </span>&#123; <span class="comment">//è§’åº¦ç®—å¼§é•¿</span></span><br><span class="line">	<span class="keyword">return</span> x / <span class="number">180</span> * PI * R;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-å¸¸ç”¨çš„ç±»"><a href="#2-å¸¸ç”¨çš„ç±»" class="headerlink" title="2.å¸¸ç”¨çš„ç±»"></a>2.å¸¸ç”¨çš„ç±»</h4><h5 id="ç‚¹ç±»"><a href="#ç‚¹ç±»" class="headerlink" title="ç‚¹ç±»"></a>ç‚¹ç±»</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x,y;</span><br><span class="line">    <span class="built_in">Point</span>()&#123;&#125;</span><br><span class="line">    <span class="built_in">Point</span>(<span class="keyword">double</span> _x,<span class="keyword">double</span> _y)&#123;x = _x,y = _y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;<span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>,&amp;x,&amp;y);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%.2f %.2f\n&quot;</span>,x,y);&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (Point b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> <span class="built_in">sgn</span>(x-b.x) == <span class="number">0</span> &amp;&amp; <span class="built_in">sgn</span>(y-b.y) == <span class="number">0</span>;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Point b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> <span class="built_in">sgn</span>(x-b.x) == <span class="number">0</span> ? <span class="built_in">sgn</span>(y-b.y)&lt;<span class="number">0</span> : x&lt;b.x;&#125;<span class="comment">//å’ŒPIIçš„é»˜è®¤ä¸€æ ·</span></span><br><span class="line">    Point <span class="keyword">operator</span> -(<span class="keyword">const</span> Point &amp;b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> <span class="built_in">Point</span>(x-b.x,y-b.y);&#125;</span><br><span class="line">    Point <span class="keyword">operator</span> + (<span class="keyword">const</span> Point &amp;b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> <span class="built_in">Point</span>(x+b.x,y+b.y);&#125;</span><br><span class="line">    Point <span class="keyword">operator</span> * (<span class="keyword">const</span> <span class="keyword">double</span> &amp;k)<span class="keyword">const</span>&#123;<span class="keyword">return</span> <span class="built_in">Point</span>(x*k,y*k);&#125; </span><br><span class="line">    Point <span class="keyword">operator</span> / (<span class="keyword">const</span> <span class="keyword">double</span> &amp;k)<span class="keyword">const</span>&#123;<span class="keyword">return</span> <span class="built_in">Point</span>(x/k,y/k);&#125; </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‰ç§¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span> ^ (<span class="keyword">const</span> Point &amp;b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> x*b.y-y*b.x;&#125;    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹ç§¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span> * (<span class="keyword">const</span> Point &amp;b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> x*b.x+y*b.y;&#125;    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›åˆ°åŸç‚¹çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">hypot</span>(x,y);&#125;                                </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›é•¿åº¦å¹³æ–¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len2</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x*x+y*y;&#125;                                  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›ä¸¤ç‚¹é—´è·ç¦»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">distance</span><span class="params">(Point p)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">hypot</span>(x-p.x,y-p.y);&#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¡ç®—è¯¥ç‚¹çœ‹a,bç‚¹çš„è§’åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">rad</span><span class="params">(Point a,Point b)</span></span>&#123;Point p = *<span class="keyword">this</span>;<span class="keyword">return</span> <span class="built_in">fabs</span>(<span class="built_in">atan2</span>(<span class="built_in">fabs</span>((a-p)^(b-p)),(a-p)*(b-p)));&#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒ–ä¸ºé•¿åº¦ä¸ºrçš„å‘é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Point <span class="title">trunc</span><span class="params">(<span class="keyword">double</span> r)</span></span>&#123;  </span><br><span class="line">        <span class="keyword">double</span> l = <span class="built_in">len</span>();</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">sgn</span>(l)) <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">//åŸæ¥é•¿åº¦ä¸º0</span></span><br><span class="line">        r /= l;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Point</span>(x*r,y*r);    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€†æ—¶é’ˆè½¬90åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Point <span class="title">rotleft</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Point</span>(-y,x);&#125;                             </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¡ºæ—¶é’ˆè½¬90åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Point <span class="title">rotright</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Point</span>(y,-x);&#125;                            </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»•pç‚¹é€†æ—¶é’ˆè½¬angle</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Point <span class="title">rotate</span><span class="params">(Point p,<span class="keyword">double</span> angle)</span></span>&#123;                              </span><br><span class="line">        Point v = (*<span class="keyword">this</span>)-p;</span><br><span class="line">        <span class="keyword">double</span> c = <span class="built_in">cos</span>(angle),s = <span class="built_in">sin</span>(angle);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Point</span>(p.x+v.x*c-v.y*s,p.y+v.x*s+v.y*c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="çº¿ç±»"><a href="#çº¿ç±»" class="headerlink" title="çº¿ç±»"></a>çº¿ç±»</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span>&#123;</span></span><br><span class="line">    Point s,e;</span><br><span class="line">    <span class="built_in">Line</span>()&#123;&#125;</span><br><span class="line">    <span class="built_in">Line</span>(Point _s,Point _e)&#123;s = _s;e = _e;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (Line v)&#123;<span class="built_in"><span class="keyword">return</span></span> (s == v.s) &amp;&amp; (e == v.e);&#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸€ä¸ªç‚¹å’Œå€¾æ–œè§’angleç¡®å®šç›´çº¿ï¼Œ0&lt;=angle&lt;=pi</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">Line</span>(Point p,<span class="keyword">double</span> angle)&#123;                                     </span><br><span class="line">        s = p;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(angle-pi/<span class="number">2</span>) == <span class="number">0</span>)&#123;e = (s+<span class="built_in">Point</span>(<span class="number">0</span>,<span class="number">1</span>));&#125;<span class="comment">//ç‰¹åˆ¤å‚ç›´xè½´</span></span><br><span class="line">        <span class="keyword">else</span>&#123;e = (s+<span class="built_in">Point</span>(<span class="number">1</span>,<span class="built_in">tan</span>(angle)));&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ax+by+c=0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">Line</span>(<span class="keyword">double</span> a,<span class="keyword">double</span> b,<span class="keyword">double</span> c)&#123;                               </span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(a) == <span class="number">0</span>)&#123;s = <span class="built_in">Point</span>(<span class="number">0</span>,-c/b);e=<span class="built_in">Point</span>(<span class="number">1</span>,-c/b);&#125;<span class="comment">//ç‰¹åˆ¤å‚ç›´xè½´</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sgn</span>(b) == <span class="number">0</span>)&#123;s = <span class="built_in">Point</span>(-c/a,<span class="number">0</span>);e = <span class="built_in">Point</span>(-c/a,<span class="number">1</span>);&#125;<span class="comment">//ç‰¹åˆ¤å‚ç›´yè½´</span></span><br><span class="line">        <span class="keyword">else</span>&#123;s = <span class="built_in">Point</span>(<span class="number">0</span>,-c/b);e = <span class="built_in">Point</span>(<span class="number">1</span>,(-c-a)/b);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;s.<span class="built_in">input</span>();e.<span class="built_in">input</span>();&#125;<span class="comment">//è°ƒç”¨äº†ç‚¹ç±»çš„input                             </span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">adjust</span><span class="params">()</span></span>&#123;<span class="keyword">if</span>(e &lt; s) <span class="built_in">swap</span>(s,e);&#125;<span class="comment">//èµ·ç‚¹æ€»æ˜¯åœ¨å·¦ä¸‹æ–¹</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ±‚çº¿æ®µé•¿åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">length</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> s.<span class="built_in">distance</span>(e);&#125;                          </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›ç›´çº¿å€¾æ–œè§’0&lt;=angle&lt;=pi</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">angle</span><span class="params">()</span></span>&#123;                                                 </span><br><span class="line">        <span class="keyword">double</span> k = <span class="built_in">atan2</span>(e.y-s.y,e.x-s.x);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(k)&lt;<span class="number">0</span>) k+=pi;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(k-pi)==<span class="number">0</span>) k-= pi;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹å’Œç›´çº¿çš„å…³ç³»</span></span><br><span class="line"><span class="comment">     * 1åœ¨å·¦ä¾§</span></span><br><span class="line"><span class="comment">     * 2åœ¨å³ä¾§</span></span><br><span class="line"><span class="comment">     * 3åœ¨ç›´çº¿ä¸Š</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pointonseg</span><span class="params">(Point p)</span></span>&#123;                                          </span><br><span class="line">        <span class="keyword">int</span> c = <span class="built_in">sgn</span>((p-s)^(e-s));</span><br><span class="line">        <span class="keyword">if</span>(c &lt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹åœ¨çº¿æ®µä¸Šçš„åˆ¤æ–­</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span>  <span class="title">pointonseg</span><span class="params">(Point p)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sgn</span>((p-s)^(e-s)) == <span class="number">0</span> &amp;&amp; <span class="built_in">sgn</span>((p-s)*(e-s)) &lt;= <span class="number">0</span>;&#125;   </span><br><span class="line">    <span class="comment">/**	</span></span><br><span class="line"><span class="comment">     * ä¸¤å‘é‡å¹³è¡Œï¼ˆå¯¹åº”ç›´çº¿å¹³è¡Œæˆ–é‡åˆï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">parallel</span><span class="params">(Line v)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sgn</span>((e-s)^(v.e-v.s)) == <span class="number">0</span>;&#125;        </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸¤çº¿æ®µç›¸äº¤åˆ¤æ–­</span></span><br><span class="line"><span class="comment">     * 2è§„èŒƒç›¸äº¤</span></span><br><span class="line"><span class="comment">     * 1éè§„èŒƒç›¸äº¤  </span></span><br><span class="line"><span class="comment">     * 0ä¸ç›¸äº¤</span></span><br><span class="line"><span class="comment">     * ç›¸äº¤æœ‰å¾ˆå¤šç§ï¼Œè¿™é‡ŒæŒ‡çš„â€œç›¸äº¤â€æ˜¯æŒ‡ä¸¤æ¡çº¿æ®µæ°å¥½æœ‰å”¯ä¸€ä¸€ä¸ªä¸æ˜¯ç«¯ç‚¹çš„å…¬å…±ç‚¹ï¼Œæˆ‘ä»¬ç§°ä¸ºâ€œè§„èŒƒç›¸äº¤â€ã€‚å³å¦‚æœä¸€æ¡çº¿æ®µçš„ä¸€ä¸ªç«¯ç‚¹æ°åœ¨å¦ä¸€çº¿æ®µä¸Šï¼Œåˆ™ä¸è§†ä¸ºç›¸äº¤ï¼›å¦‚æœä¸¤æ¡çº¿æ®µéƒ¨åˆ†é‡åˆï¼Œä¹Ÿä¸è§†ä¸ºç›¸äº¤ï¼Œï¼ˆè¿™äº›æƒ…å†µæˆ‘ä»¬ç§°ä¸ºâ€œéè§„èŒƒç›¸äº¤â€ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">segcrosseg</span><span class="params">(Line v)</span></span>&#123;                                         </span><br><span class="line">        <span class="keyword">int</span> d1 = <span class="built_in">sgn</span>((e-s)^(v.s-s));</span><br><span class="line">        <span class="keyword">int</span> d2 = <span class="built_in">sgn</span>((e-s)^(v.e-s));</span><br><span class="line">        <span class="keyword">int</span> d3 = <span class="built_in">sgn</span>((v.e-v.s)^(s-v.s));</span><br><span class="line">        <span class="keyword">int</span> d4 = <span class="built_in">sgn</span>((v.e-v.s)^(e-v.s));</span><br><span class="line">        <span class="keyword">if</span>((d1^d2) == <span class="number">-2</span> &amp;&amp; (d3^d4) == <span class="number">-2</span>)<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> (d1 == <span class="number">0</span> &amp;&amp; <span class="built_in">sgn</span>((v.s-s)*(v.s-e)) &lt;= <span class="number">0</span>) || </span><br><span class="line">               (d2 == <span class="number">0</span> &amp;&amp; <span class="built_in">sgn</span>((v.e-s)*(v.e-e)) &lt;= <span class="number">0</span>) ||</span><br><span class="line">               (d3 == <span class="number">0</span> &amp;&amp; <span class="built_in">sgn</span>((s-v.s)*(s-v.e)) &lt;= <span class="number">0</span>) ||</span><br><span class="line">               (d4 == <span class="number">0</span> &amp;&amp; <span class="built_in">sgn</span>((e-v.s)*(e-v.e)) &lt;= <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›´çº¿å’Œçº¿æ®µç›¸äº¤åˆ¤æ–­</span></span><br><span class="line"><span class="comment">     * 2è§„èŒƒç›¸äº¤</span></span><br><span class="line"><span class="comment">     * 1éè§„èŒƒç›¸äº¤</span></span><br><span class="line"><span class="comment">     * 0ä¸ç›¸äº¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">linecrossseg</span><span class="params">(Line v)</span></span>&#123;                                       </span><br><span class="line">        <span class="keyword">int</span> d1 = <span class="built_in">sgn</span>((e-s)^(v.s-s));</span><br><span class="line">        <span class="keyword">int</span> d2 = <span class="built_in">sgn</span>((e-s)^(v.e-s));</span><br><span class="line">        <span class="keyword">if</span>((d1^d2) == <span class="number">-2</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> (d1 == <span class="number">0</span> || d2 == <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸¤ç›´çº¿å…³ç³»</span></span><br><span class="line"><span class="comment">     * 0å¹³è¡Œ</span></span><br><span class="line"><span class="comment">     * 1é‡åˆ</span></span><br><span class="line"><span class="comment">     * 2ç›¸äº¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">linecrossline</span><span class="params">(Line v)</span></span>&#123;                                      </span><br><span class="line">        <span class="keyword">if</span>((*<span class="keyword">this</span>).<span class="built_in">parallel</span>(v)) <span class="keyword">return</span> v.<span class="built_in">pointonseg</span>(s) == <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ±‚ä¸¤ç›´çº¿ç„¦ç‚¹ï¼Œè¦ä¿è¯ä¸¤ç›´çº¿ä¸å¹³è¡Œæˆ–é‡åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Point <span class="title">crosspoint</span><span class="params">(Line v)</span></span>&#123;                                       </span><br><span class="line">        <span class="keyword">double</span> a1 = (v.e-v.s)^(s-v.s);</span><br><span class="line">        <span class="keyword">double</span> a2 = (v.e-v.s)^(e-v.s);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Point</span>((s.x*a2-e.x*a1)/(a2-a1),(s.y*a2-e.y*a1)/(a2-a1));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹åˆ°ç›´çº¿çš„è·ç¦»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dispointtoline</span><span class="params">(Point p)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">fabs</span>((p-s)^(e-s))/<span class="built_in">length</span>();&#125;  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹åˆ°çº¿æ®µçš„è·ç¦»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dispointtoseg</span><span class="params">(Point p)</span></span>&#123;                                  </span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>((p-s)*(e-s)) &lt; <span class="number">0</span> || <span class="built_in">sgn</span>((p-e)*(s-e)) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">min</span>(p.<span class="built_in">distance</span>(s),p.<span class="built_in">distance</span>(e));</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dispointtoline</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çº¿æ®µåˆ°çº¿æ®µçš„è·ç¦»ï¼Œå‰ææ˜¯ä¸¤çº¿æ®µä¸ç›¸äº¤ï¼Œç›¸äº¤è·ç¦»ä¸º0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dissegtoseg</span><span class="params">(Line v)</span></span>&#123;                                     </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(<span class="built_in">min</span>(<span class="built_in">dispointtoseg</span>(v.s),<span class="built_in">dispointtoseg</span>(v.e)),<span class="built_in">min</span>(v.<span class="built_in">dispointtoseg</span>(s),v.<span class="built_in">dispointtoseg</span>(e)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›ç‚¹påœ¨ç›´çº¿ä¸Šçš„æŠ•å½±</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Point <span class="title">lineprog</span><span class="params">(Point p)</span></span>&#123;<span class="keyword">return</span> s+(((e-s)*((e-s)*(p-s)))/((e-s).<span class="built_in">len2</span>()));&#125;   </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›ç‚¹på…³äºç›´çº¿çš„å¯¹ç§°ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Point <span class="title">symmetypoint</span><span class="params">(Point p)</span></span>&#123;Point q = <span class="built_in">lineprog</span>(p);<span class="keyword">return</span> <span class="built_in">Point</span>(<span class="number">2</span>*q.x-p.x,<span class="number">2</span>*q.y-p.y);&#125;   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="åœ†ç±»"><a href="#åœ†ç±»" class="headerlink" title="åœ†ç±»"></a>åœ†ç±»</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span>  <span class="title">circle</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point p;</span><br><span class="line">    <span class="keyword">double</span> r;</span><br><span class="line">    <span class="built_in">circle</span>()&#123;&#125;</span><br><span class="line">    <span class="built_in">circle</span>(Point _p,<span class="keyword">double</span> _r)&#123;p = _p;r = _r;&#125;</span><br><span class="line">    <span class="built_in">circle</span>(<span class="keyword">double</span> x,<span class="keyword">double</span> y,<span class="keyword">double</span> _r)&#123;p = <span class="built_in">Point</span>(x,y);r = _r;&#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‰è§’å½¢å¤–æ¥åœ†ï¼Œéœ€è¦Pointçš„+/rotate()ä»¥åŠlineçš„crosspoint()ã€‚åˆ©ç”¨ä¸¤è¾¹ä¸­å‚çº¿å¾—åœ†å¿ƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">circle</span>(Point a,Point b,Point c)&#123;                                 </span><br><span class="line">        Line u = <span class="built_in">Line</span>((a+b)/<span class="number">2</span>,((a+b)/<span class="number">2</span>)+((b-a).<span class="built_in">rotleft</span>()));</span><br><span class="line">        Line v = <span class="built_in">Line</span>((b+c)/<span class="number">2</span>,((b+c)/<span class="number">2</span>)+((c-b).<span class="built_in">rotleft</span>()));</span><br><span class="line">        p = u.<span class="built_in">crosspoint</span>(v);</span><br><span class="line">        r = p.<span class="built_in">distance</span>(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‰è§’å½¢å†…åˆ‡åœ†,å‚æ•°bool tæ— ä½œç”¨ï¼Œåªæ˜¯ä¸å¤–æ¥åœ†åŒºåˆ«  </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">circle</span>(Point a,Point b,Point c,<span class="keyword">bool</span> t)&#123;                          </span><br><span class="line">        Line u,v;</span><br><span class="line">        <span class="keyword">double</span> m = <span class="built_in">atan2</span>(b.y-a.y,b.x-a.x),n = <span class="built_in">atan2</span>(c.y-a.y,c.x-a.x);</span><br><span class="line">        u.s = a,v.s = b;</span><br><span class="line">        u.e = u.s+<span class="built_in">Point</span>(<span class="built_in">cos</span>((n+m)/<span class="number">2</span>),<span class="built_in">sin</span>((n+m)/<span class="number">2</span>));</span><br><span class="line">        m = <span class="built_in">atan2</span>(a.y-b.y,a.x-b.x),n = <span class="built_in">atan2</span>(c.y-b.y,c.x-b.x);</span><br><span class="line">        v.e = v.s+<span class="built_in">Point</span>(<span class="built_in">cos</span>((n+m)/<span class="number">2</span>),<span class="built_in">sin</span>((n+m)/<span class="number">2</span>));</span><br><span class="line">        p = u.<span class="built_in">crosspoint</span>(v);</span><br><span class="line">        r = <span class="built_in">Line</span>(a,b).<span class="built_in">dispointtoseg</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;p.<span class="built_in">input</span>();<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;r);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%.2lf %.2lf %.2lf\n&quot;</span>,p.x,p.y,r);&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (circle v)<span class="keyword">const</span>&#123;<span class="built_in"><span class="keyword">return</span></span> (p==v.p) &amp;&amp; <span class="built_in">sgn</span>(r-v.r) == <span class="number">0</span>;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (circle v)<span class="keyword">const</span>&#123;<span class="keyword">return</span> ((p&lt;v.p) || ((p==v.p) &amp;&amp; <span class="built_in">sgn</span>(r-v.r) &lt; <span class="number">0</span>));&#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›é¢ç§¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> pi*r*r;&#125;                                </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å‘¨é•¿</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">circumference</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="number">2</span>*pi*r;&#125;                      </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹å’Œåœ†çš„å…³ç³»ï¼Œ0åœ†å¤–ï¼Œ1åœ†ä¸Šï¼Œ2åœ†å†…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relation</span><span class="params">(Point b)</span></span>&#123;                                           </span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> dst = b.<span class="built_in">distance</span>(p);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(dst-r) &lt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sgn</span>(dst-r) == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çº¿æ®µå’Œåœ†çš„å…³ç³»ï¼Œæ¯”è¾ƒçš„æ˜¯åœ†å¿ƒåˆ°çº¿æ®µçš„è·ç¦»å’ŒåŠå¾„çš„å…³ç³»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationseg</span><span class="params">(Line v)</span></span>&#123;                                          </span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> dst = v.<span class="built_in">dispointtoseg</span>(p);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(dst-r) &lt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sgn</span>(dst-r) == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›´çº¿å’Œåœ†çš„å…³ç³»ï¼Œæ¯”è¾ƒçš„æ˜¯åœ†å¿ƒåˆ°çº¿æ®µçš„è·ç¦»å’ŒåŠå¾„çš„å…³ç³»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationline</span><span class="params">(Line v)</span></span>&#123;                                         </span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> dst = v.<span class="built_in">dispointtoline</span>(p);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(dst-r) &lt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sgn</span>(dst-r) == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸¤åœ†å…³ç³»</span></span><br><span class="line"><span class="comment">     * 5ç›¸ç¦»</span></span><br><span class="line"><span class="comment">     * 4å¤–åˆ‡</span></span><br><span class="line"><span class="comment">     * 3ç›¸äº¤</span></span><br><span class="line"><span class="comment">     * 2å†…åˆ‡</span></span><br><span class="line"><span class="comment">     * 1å†…å«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationcircle</span><span class="params">(circle v)</span></span>&#123;                                   </span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> d = p.<span class="built_in">distance</span>(v.p);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(d-r-v.r) &gt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(d-r-v.r) == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">double</span> l = <span class="built_in">fabs</span>(r-v.r);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(d-r-v.r)&lt;<span class="number">0</span> &amp;&amp; <span class="built_in">sgn</span>(d-l)&gt;<span class="number">0</span>)<span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(d-l) == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(d-l) &lt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *æ±‚ä¸¤åœ†äº¤ç‚¹</span></span><br><span class="line"><span class="comment">    *0æ˜¯æ— äº¤ç‚¹</span></span><br><span class="line"><span class="comment">    *1æ˜¯ä¸€ä¸ªäº¤ç‚¹</span></span><br><span class="line"><span class="comment">    *2æ˜¯ä¸¤ä¸ª</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pointcrosscircle</span><span class="params">(circle v,Point &amp;p1,Point &amp;p2)</span></span>&#123;              </span><br><span class="line">        <span class="keyword">int</span> rel = <span class="built_in">relationcircle</span>(v);</span><br><span class="line">        <span class="keyword">if</span>(rel == <span class="number">1</span> || rel == <span class="number">5</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">double</span> d = p.<span class="built_in">distance</span>(v.p);</span><br><span class="line">        <span class="keyword">double</span> l = (d*d+r*r-v.r*v.r)/(<span class="number">2</span>*d);</span><br><span class="line">        <span class="keyword">double</span> h = <span class="built_in">sqrt</span>(r*r-l*l);</span><br><span class="line">        Point tmp = p + (v.p-p).<span class="built_in">trunc</span>(l);</span><br><span class="line">        p1 = tmp + ((v.p-p).<span class="built_in">rotleft</span>().<span class="built_in">trunc</span>(h));</span><br><span class="line">        p2 = tmp + ((v.p-p).<span class="built_in">rotright</span>().<span class="built_in">trunc</span>(h));</span><br><span class="line">        <span class="keyword">if</span>(rel == <span class="number">2</span> || rel == <span class="number">4</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>å­—ç¬¦ä¸²åŒ¹é…è¿›é˜¶</title>
    <url>/2021/11/15/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D%E8%BF%9B%E9%98%B6/</url>
    <content><![CDATA[<h3 id="FFT"><a href="#FFT" class="headerlink" title="FFT"></a>FFT</h3><p><strong>Aä½æ¨¡å¼ä¸²ï¼Œé•¿åº¦ä¸ºnï¼›Bä¸ºæ–‡æœ¬ä¸²ï¼Œé•¿åº¦ä¸ºmã€‚</strong></p>
<p> 1.æ²¡æœ‰é€šé…ç¬¦çš„</p>
<ul>
<li>é¦–å…ˆå¼•å…¥ä¸€ä¸ªåŒ¹é…å‡½æ•°$C(x,y) = A(x) - B(y)$,å½“C(x,y) = 0ï¼Œæˆ‘ä»¬è®¤ä¸ºAçš„ç¬¬xå­—ç¬¦å’ŒBçš„ç¬¬yä¸ªå­—ç¬¦ç›¸ç­‰ã€‚</li>
<li>å†å°†ä¸€ä¸ªå­—ç¬¦åŒ¹é…æ‰©å±•åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li>
<li>é‚£ä¹ˆï¼Œå®Œå…¨åŒ¹é…å‡½æ•°$P(x) =\displaystyle \sum^{m-1}_{i=0} C(i,x-m+i+1)$ ,è‹¥P(x) = 0ï¼Œåˆ™Bä»¥xç»“å°¾çš„è¿ç»­mä½å­ä¸²å’ŒAå®Œå…¨åŒ¹é…ã€‚</li>
<li>ä¸Šé¢çš„å®Œå…¨åŒ¹é…å‡½æ•°å­˜åœ¨ä¸€äº›é”™è¯¯<ul>
<li>æŠŠæ±‚å’Œå‡½æ•°æ‹†å¼€ä¼šå‘ç°å°±æ˜¯åŒ¹é…çš„ä¸¤ä¸ªä¸²çš„æ¯ä¸ªå­—ç¬¦åˆ†åˆ«ç›¸åŠ ï¼Œç„¶åï¼›ä¸¤ä¸ªå’Œç›¸å‡ã€‚é‚£ä¹ˆåªè¦å­—ç¬¦çš„ç±»å‹ï¼Œä¸ªæ•°å¯¹åº”ç›¸åŒå°±è¢«åˆ¤å®šç›¸åŒï¼Œå¿½ç•¥äº†æ¯ä¸ªå­—ç¬¦çš„å¯¹åº”å…³ç³»ã€‚</li>
<li>äº§ç”Ÿé”™è¯¯çš„åŸå› æ˜¯æ¯ä¸ªå­—ç¬¦çš„åŒ¹é…å‡½æ•°æœ‰æ­£æœ‰è´Ÿï¼Œæ±‚å’Œå¯èƒ½ç›¸äº’æŠµæ¶ˆä¸º0ã€‚</li>
<li>è§£å†³æ–¹æ³•å°±æ˜¯æŠŠåŒ¹é…å‡½æ•°$C(x,y)$å¹³æ–¹ï¼Œå› ä¸ºè‹¥å¹²ä¸ªå¹³æ–¹æ•°ç›¸åŠ =0åªèƒ½æ˜¯æ¯ä¸€é¡¹éƒ½ä¸º0ï¼Œå’Œæˆ‘ä»¬å®Œå…¨åŒ¹é…æ—¶æ¯ä¸ªä½ç½®çš„$C(x,y)=0$æ—¶ç­‰ä»·çš„ã€‚</li>
<li><strong>ç­‰ä»·è½¬åŒ–â€”â€”</strong>  <strong>æˆ‘ä»¬æŠŠAåè½¬å˜æˆSï¼Œé‚£ä¹ˆA(i) = S(m-i-1)ã€‚å› ä¸ºè¿™æ ·å­åŒ¹é…å‡½æ•°çš„xï¼Œyç›¸åŠ æ€»æ˜¯ç­‰äºä¸€ä¸ªå¸¸æ•°ã€‚ï¼ˆè¿™å¾ˆé‡è¦ï¼‰</strong></li>
</ul>
</li>
<li>æ­£ç¡®çš„å®Œå…¨åŒ¹é…å‡½æ•°ä¸º$P(x) =\displaystyle \sum^{m-1}_{i=0} (S[m-i-1] - B[x-m+i+1])^2$</li>
<li>å°†å‡½æ•°æš´åŠ›å±•å¼€ä¸º$P(x) =\displaystyle \sum^{m-1}_{i=0} ({S[m-i-1]}^2 + {B[x-m+i+1]}^2 - 2  S[m-i-1]  B[x-m+i+1])$</li>
<li>å†å±•å¼€ä¸ºä¸‰éƒ¨åˆ†<ol>
<li>$\displaystyle \sum^{m-1}_{i=0} {S[m-i-1]}^2$  æ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸ªå®šå€¼è®°ä½œTï¼Œæˆ‘ä»¬å¯ä»¥$O(m)$æš´åŠ›é¢„å¤„ç†</li>
<li>$\displaystyle \sum^{m-1}_{i=0}{B[x-m+i+1]}^2$ è¿™æ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºmçš„åŒºé—´å’Œï¼Œæˆ‘ä»¬é€šè¿‡é¢„å¤„ç†å‰ç¼€å’Œæ•°ç»„f ( x )ï¼Œç„¶å$O(1)$å¾—åˆ°</li>
<li>$\displaystyle -2\sum^{m-1}_{i=0}S[m-i-1]  B[x-m+i+1]$ é€šè¿‡ä¸Šé¢æˆ‘ä»¬æŠŠAç”¨ä»–çš„åè½¬Sæ›¿æ¢åï¼Œæˆ‘ä»¬å‘ç°(m-i-1)+(x-m+i+1) æ’ç­‰äºxã€‚é‚£ä¹ˆå…¬å¼ä¸º$\displaystyle -2\sum_{i+i=x}S[i]  B[j]$ã€‚<ul>
<li>å¦$\displaystyle g(x) = \sum_{i+i=x}S[i]  B[j]$ ï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸ªå¤šé¡¹å¼ä¹˜æ³•ï¼Œå¯ä»¥é€šè¿‡FFTæ±‚å‡ºæ‰€æœ‰å€¼</li>
</ul>
</li>
</ol>
</li>
<li>$P(x) = T + f(x) -  f(x-m) -2g(x)$ ï¼Œæ¯ä¸ªå‡½æ•°éƒ½å¯ä»¥é€šè¿‡ä¸Šè¿°æ±‚å‡ºï¼Œå†$O(n)$æ±‚å‡ºæ‰€æœ‰P(x)</li>
</ul>
<ol>
<li><h5 id="æœ‰é€šé…ç¬¦çš„"><a href="#æœ‰é€šé…ç¬¦çš„" class="headerlink" title="æœ‰é€šé…ç¬¦çš„"></a>æœ‰é€šé…ç¬¦çš„</h5></li>
</ol>
<ul>
<li><p>è°ƒæ•´åŒ¹é…å‡½æ•°â€”â€”å’Œä¸Šè¿°æ²¡æœ‰é€šé…ç¬¦çš„ç›¸åŒï¼Œä½†æ˜¯æˆ‘ä»¬è¦å»æ‰é€šé…ç¬¦ä½ç½®çš„è´¡çŒ®ã€‚</p>
</li>
<li><p><strong>å°†åŸå­—ç¬¦ä¸²æ˜¯é€šé…ç¬¦çš„å€¼è®¾ä¸º0ï¼Œå†ä¿®æ”¹å®Œå…¨åŒ¹é…åŒ¹é…å‡½æ•°ä¸º$P(x) =\displaystyle \sum^{m-1}_{i=0} (S[m-i-1] - B[x-m+i+1])^2S[m-i-1]B[x-m+i+1]$</strong></p>
<p><strong>å…¶ä¸­ä¸€ä¸ªä¸ºé€šé…ç¬¦å°±ä¼šä¹˜ä¸Š0ï¼Œæœ€åè´¡çŒ®ä¸º0</strong></p>
</li>
<li><p><strong>æš´åŠ›å±•å¼€-&gt;</strong>$P(x) =\displaystyle \sum^{m-1}_{i=0} ({S[m-i-1]}^3B[x-m+i+1] + {B[x-m+i+1]}^3S[m-i-1] - 2  (S[m-i-1]  B[x-m+i+1])^2)$</p>
<p>å³$P(x) =\displaystyle \sum_{i+j=x} {S[i]}^3B[j] + \sum_{i+j=x}{B[j]}^3S[i] - 2  \sum_{i+j=x}(S[i]  B[j])^2$</p>
</li>
<li><p>6æ¬¡FFTå³å¯æ±‚çš„,å†ä¸€æ¬¡é€†FFTå›å»å³å¯</p>
</li>
</ul>
<h4 id="FFTæ¿å­"><a href="#FFTæ¿å­" class="headerlink" title="FFTæ¿å­"></a><strong>FFTæ¿å­</strong></h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¤æ•°ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Complex <span class="keyword">operator</span>+ (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + t.x, y + t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span>- (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span>* (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * t.x - y * t.y, x * t.y + y * t.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;a[N], b[N];<span class="comment">//åŸæ¥çš„å¤šé¡¹å¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rev[N], bit, tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(Complex a[], <span class="keyword">int</span> inv)</span><span class="comment">//1:ç³»æ•°è¡¨ç¤ºæ³•-&gt;ç‚¹è¡¨ç¤ºæ³•ï¼›-1:ç‚¹è¡¨ç¤ºæ³•-&gt;ç³»æ•°è¡¨ç¤ºæ³•</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i ++ )</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])<span class="comment">//å¦åˆ™å°±ä¼šäº¤æ¢ä¸¤æ¬¡æ¢å›åŸæ¥</span></span><br><span class="line">            <span class="built_in">swap</span>(a[i], a[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> w1 = <span class="built_in">Complex</span>(&#123;<span class="built_in">cos</span>(PI / mid), inv * <span class="built_in">sin</span>(PI / mid)&#125;);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i += mid * <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> wk = <span class="built_in">Complex</span>(&#123;<span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; mid; j ++, wk = wk * w1)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">auto</span> x = a[i + j], y = wk * a[i + j + mid];</span><br><span class="line">                a[i + j] = x + y, a[i + j + mid] = x - y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(inv==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) a[i].x/=tot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="FFTåŒ¹é…æ¿å­ï¼ˆå¸¦é€šé…ç¬¦ï¼‰"><a href="#FFTåŒ¹é…æ¿å­ï¼ˆå¸¦é€šé…ç¬¦ï¼‰" class="headerlink" title="FFTåŒ¹é…æ¿å­ï¼ˆå¸¦é€šé…ç¬¦ï¼‰"></a><strong>FFTåŒ¹é…æ¿å­ï¼ˆå¸¦é€šé…ç¬¦ï¼‰</strong></h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> rev[maxn], tot, bit;</span><br><span class="line"><span class="keyword">double</span> a[maxn], b[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT_MATCH</span><span class="params">(string s1, string s2, <span class="keyword">int</span> m, <span class="keyword">int</span> n)</span></span>&#123;<span class="comment">//s1æ¨¡å¼ä¸²ï¼ˆçŸ­ï¼‰ï¼Œs2æ–‡æœ¬ä¸²ï¼ˆé•¿ï¼‰</span></span><br><span class="line">    <span class="built_in">reverse</span>(<span class="built_in">all</span>(s1));</span><br><span class="line">    <span class="comment">//åº”é¿å…æŸä¸ªå­—ç¬¦çš„å€¼ä¸º0ï¼Œé€‰å–å­—ç¬¦é›†ä¸­ä¸å­˜åœ¨çš„å­—ç¬¦å‡å»å³å¯</span></span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,m) a[i] = s1[i]!=<span class="string">&#x27;*&#x27;</span> ? (s1[i]-<span class="string">&#x27;a&#x27;</span>) : <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,n) b[i] = s2[i]!=<span class="string">&#x27;*&#x27;</span> ? (s2[i]-<span class="string">&#x27;a&#x27;</span>) : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;bit) &lt; n+m+<span class="number">1</span>) bit++;</span><br><span class="line">	tot = <span class="number">1</span>&lt;&lt; bit; </span><br><span class="line">	<span class="comment">// debug(tot);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i ++ )</span><br><span class="line">        rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) A[i].x = a[i]*a[i];</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) B[i].x = b[i]*b[i];</span><br><span class="line">    <span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">    Complex t;</span><br><span class="line">    t.x = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) P[i] = P[i]-A[i]*B[i]*t;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¾ªç¯åˆ°tot-1æ˜¯å› ä¸ºä¸Šé¢å·ç§¯åä¼šæœ‰ç³»æ•°å¤§äºnï¼Œmçš„é¡¹ï¼ˆä¸Šé¢ç¬¬ä¸€æ¬¡å¯ä»¥çŸ¥é“nï¼Œmï¼‰</span></span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) A[i].x = a[i]*a[i]*a[i],A[i].y=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) B[i].x = b[i],B[i].y=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) P[i] = P[i]+A[i]*B[i];</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) A[i].x = a[i],A[i].y=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) B[i].x = b[i]*b[i]*b[i],B[i].y=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) P[i] = P[i]+A[i]*B[i];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">FFT</span>(P,<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i,m,n)&#123; </span><br><span class="line">    	<span class="keyword">if</span>(<span class="built_in">fabs</span>(P[i].x) &lt;= <span class="number">1e-7</span>)&#123;</span><br><span class="line">    		cout &lt;&lt; i-m &lt;&lt;endl;<span class="comment">//åŒ¹é…åˆ°çš„å¼€å§‹ä½ç½®ï¼Œiæ˜¯ç»“æŸä½ç½®</span></span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n,m;<span class="comment">//å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		n--,m--;<span class="comment">//æœ€é«˜ä½æŒ‡æ•°</span></span><br><span class="line">		string s1,s2;</span><br><span class="line">		cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">		<span class="built_in">FFT_MATCH</span>(s2,s1,m,n);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<h4 id="FFTåŒ¹é…æ¿å­ï¼ˆä¸å¸¦é€šé…ç¬¦ï¼‰"><a href="#FFTåŒ¹é…æ¿å­ï¼ˆä¸å¸¦é€šé…ç¬¦ï¼‰" class="headerlink" title="FFTåŒ¹é…æ¿å­ï¼ˆä¸å¸¦é€šé…ç¬¦ï¼‰"></a><strong>FFTåŒ¹é…æ¿å­ï¼ˆä¸å¸¦é€šé…ç¬¦ï¼‰</strong></h4><p>ç†è®ºä¸Šå¸¦é€šé…ç¬¦ç‰ˆæœ¬å¯ä»¥å¤„ç†æ²¡æœ‰é€šé…ç¬¦çš„</p>
<p>ä½†æ˜¯ç”±äºè¿›è¡Œäº†6æ¬¡FFTï¼Œå¸¸æ•°æ›´å¤§ï¼Œæ™®é€šç‰ˆåªéœ€è¦2æ¬¡ã€‚</p>
<p>ä½†æ˜¯ä¸å¸¦é€šé…ç¬¦çš„é—®é¢˜å°±æ˜¯å­—ç¬¦ä¸²åŒ¹é…çš„æ¨¡ç‰ˆé¢˜ï¼ŒKMPæœ‰æ›´å¥½çš„çº¿æ€§å¤æ‚åº¦</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">double</span>  sum[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT_MATCH</span><span class="params">(string s1, string s2, <span class="keyword">int</span> m, <span class="keyword">int</span> n)</span></span>&#123;<span class="comment">//s1æ¨¡å¼ä¸²ï¼ˆçŸ­ï¼‰ï¼Œs2æ–‡æœ¬ä¸²ï¼ˆé•¿ï¼‰</span></span><br><span class="line">    <span class="built_in">reverse</span>(<span class="built_in">all</span>(s1));</span><br><span class="line">    <span class="comment">//åº”é¿å…æŸä¸ªå­—ç¬¦çš„å€¼ä¸º0ï¼Œé€‰å–å­—ç¬¦é›†ä¸­ä¸å­˜åœ¨çš„å­—ç¬¦å‡å»å³å¯</span></span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,m) A[i].x = s1[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,n) B[i].x = s2[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬ä¸€éƒ¨åˆ†</span></span><br><span class="line">    <span class="keyword">double</span> T = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,m) T+=A[i].x*A[i].x;<span class="comment">//è®¡ç®—å®šå€¼T</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; T &lt;&lt;endl;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç¬¬äºŒéƒ¨åˆ†</span></span><br><span class="line">    sum[<span class="number">0</span>] = B[<span class="number">0</span>].x*B[<span class="number">0</span>].x;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">1</span>,n) </span><br><span class="line">    	sum[i] = sum[i<span class="number">-1</span>] + B[i].x*B[i].x;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬ä¸‰éƒ¨åˆ†</span></span><br><span class="line">    <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;bit) &lt; n+m+<span class="number">1</span>) bit++;</span><br><span class="line">	tot = <span class="number">1</span>&lt;&lt; bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i ++ )</span><br><span class="line">        rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) C[i] = A[i]*B[i];</span><br><span class="line">    <span class="built_in">FFT</span>(C,<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="built_in">rep</span>(i,m,n)&#123; </span><br><span class="line">        <span class="keyword">double</span> temp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(i==m) temp = T + sum[i] - <span class="number">2</span>*C[i].x;</span><br><span class="line">        <span class="keyword">else</span> temp = T + sum[i] - sum[i-m<span class="number">-1</span>] <span class="number">-2</span>*C[i].x;</span><br><span class="line"></span><br><span class="line">    	<span class="keyword">if</span>(<span class="built_in">fabs</span>(temp) &lt;= <span class="number">1e-7</span>)&#123;</span><br><span class="line">    		cout &lt;&lt; i-m &lt;&lt;endl;<span class="comment">//åŒ¹é…åˆ°çš„å¼€å§‹ä½ç½®ï¼Œiæ˜¯ç»“æŸä½ç½®</span></span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n,m;<span class="comment">//å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		n--,m--;<span class="comment">//æœ€é«˜ä½æŒ‡æ•°</span></span><br><span class="line">		string s1,s2;</span><br><span class="line">		cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">		<span class="built_in">FFT_MATCH</span>(s2,s1,m,n);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<h4 id="FFTæ¨¡ç³ŠåŒ¹é…ï¼ˆkå¤±é…åŒ¹é…ï¼‰"><a href="#FFTæ¨¡ç³ŠåŒ¹é…ï¼ˆkå¤±é…åŒ¹é…ï¼‰" class="headerlink" title="FFTæ¨¡ç³ŠåŒ¹é…ï¼ˆkå¤±é…åŒ¹é…ï¼‰"></a>FFTæ¨¡ç³ŠåŒ¹é…ï¼ˆkå¤±é…åŒ¹é…ï¼‰</h4><p>ä¸€èˆ¬è¿™ç§é—®é¢˜èƒ½ç”¨FFTè§£å†³é€šå¸¸æ»¡è¶³å­—ç¬¦é›†è¾ƒå°</p>
<ul>
<li><p>æšä¸¾å­—ç¬¦é›†ä¸­æ¯ç§å­—ç¬¦c[k]</p>
</li>
<li><p>æ„å»ºä¸¤ä¸ªå¤æ•°æ•°ç»„</p>
<p>A[i].x = (s1[i]==c[k])â€”â€”B[i].x = (s2[i]\==c[k])</p>
</li>
<li><p>å¯¹è¿™ä¸¤ä¸ªæ•°ç»„è¿›è¡Œæ— é€šé…ç¬¦çš„åŒ¹é…</p>
</li>
<li><p>å½“ä¸”ä»…å½“å¯¹åº”ä½ç½®ç›¸ç­‰å¹¶ç­‰äºc[k]ä¼šæœ‰è´¡çŒ®1</p>
</li>
<li><p>å¯¹äºå­—ç¬¦é›†æ¯ä¸ªå­—ç¬¦è¿›è¡Œå¦‚ä¸Šæ“ä½œï¼Œå°†è´¡çŒ®ç´¯åŠ åˆ°å¯¹åº”ä½ç½®d[i]ä¸­</p>
</li>
<li><p>d[i]ä»£è¡¨äº†ä»¥iç»“å°¾çš„ä½ç½®åŒ¹é…ä¸ªæ•°ä¸ºd[i]ä¸ª</p>
</li>
<li><p>d[i]&gt;=åŒ¹é…ä¸²é•¿åº¦-å¯å¤±é…ä¸ªæ•°åˆ™â€”â€”&gt;å½“å‰ä½ç½®åŒ¹é…æˆåŠŸ</p>
</li>
</ul>
<hr>
<p><a href="https://www.luogu.com.cn/problem/P3763">P3763 [TJOI2017]DNA</a> FFT</p>
<p><strong>é¢˜æ„ï¼š</strong>åœ¨Sä¸­åŒ¹é…Pçš„ä¸ªæ•°ï¼ˆå…è®¸3å¤„ä¸ä¸€æ ·ï¼‰</p>
<p><strong>æ¨¡æ¿é¢˜</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="comment">// #define PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>); </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rev[maxn], tot, bit;</span><br><span class="line"><span class="keyword">double</span> a[maxn], b[maxn];</span><br><span class="line"><span class="comment">//å¤æ•°ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Complex <span class="keyword">operator</span>+ (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + t.x, y + t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span>- (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span>* (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * t.x - y * t.y, x * t.y + y * t.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;A[maxn], B[maxn], C[maxn];<span class="comment">//åŸæ¥çš„å¤šé¡¹å¼</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(Complex aa[], <span class="keyword">int</span> inv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i ++ )</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(aa[i], aa[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> w1 = <span class="built_in">Complex</span>(&#123;<span class="built_in">cos</span>(PI / mid), inv * <span class="built_in">sin</span>(PI / mid)&#125;);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i += mid * <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> wk = <span class="built_in">Complex</span>(&#123;<span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; mid; j ++, wk = wk * w1)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">auto</span> x = aa[i + j], y = wk * aa[i + j + mid];</span><br><span class="line">                aa[i + j] = x + y, aa[i + j + mid] = x - y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(inv==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) aa[i].x/=tot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> cc[<span class="number">4</span>]=&#123;<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;G&#x27;</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		<span class="built_in">mem</span>(d,<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">int</span> n,m;<span class="comment">//å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">		string s1,s2;</span><br><span class="line">		cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">		m = s2.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">		n = s1.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">		<span class="built_in">reverse</span>(<span class="built_in">all</span>(s2));</span><br><span class="line">		<span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;bit)&lt;n+m+<span class="number">1</span>) bit++;</span><br><span class="line">		tot = <span class="number">1</span>&lt;&lt;bit;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i ++ )</span><br><span class="line">        rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="number">3</span>)&#123;</span><br><span class="line">			<span class="built_in">mem</span>(A,<span class="number">0</span>);</span><br><span class="line">			<span class="built_in">mem</span>(B,<span class="number">0</span>);</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,n) A[j].x = (s1[j]==cc[i])? <span class="number">1</span>: <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,m) B[j].x = (s2[j]==cc[i])? <span class="number">1</span>: <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">			<span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,tot<span class="number">-1</span>) A[j] = A[j]*B[j];</span><br><span class="line">			<span class="built_in">FFT</span>(A,<span class="number">-1</span>);</span><br><span class="line">			<span class="built_in">rep</span>(j,m,n) d[j] += (<span class="keyword">int</span>)(A[j].x+<span class="number">0.5</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		ll ans = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,m,n)&#123;</span><br><span class="line">			<span class="keyword">if</span>(d[i]&gt;=m<span class="number">-2</span>) ans++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">wtl</span>(ans);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://acm.dingbacode.com/showproblem.php?pid=6975">2021æ­ç”µå¤šæ ¡ç¬¬ä¸‰åœº1003</a></p>
<p><strong>æ€è·¯ï¼š</strong>å’ŒåŸºå› åºåˆ—ç±»ä¼¼ï¼Œä¸è¿‡åŠ å…¥äº†é€šé…ç¬¦ã€‚å¯¹äºé€šé…ç¬¦çš„è´¡çŒ®æˆ‘ä»¬è¦æ‹¿å‡ºæ¥å•ç‹¬è®¡ç®—ã€‚ç”±äºæ–‡æœ¬ä¸²å’Œæ¨¡å¼ä¸²éƒ½åŒ…å«é€šé…ç¬¦ï¼Œéœ€è¦ç”¨åˆ°ä¸€äº›å°å°çš„å®¹æ–¥åŸç†ã€‚</p>
<ul>
<li>æ•°å­—éƒ¨åˆ†è´¡çŒ®å’Œä¸Šé¢˜ç›¸åŒã€‚</li>
<li>é€šé…ç¬¦è´¡çŒ® = Aä¸­é€šé…ç¬¦è´¡çŒ®  +  Bä¸­é€šé…ç¬¦è´¡çŒ®  -  ABä¸­åŒæ—¶æ˜¯é€šé…ç¬¦è´¡çŒ®</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*******************************</span></span><br><span class="line"><span class="comment">| Author:  pigstar</span></span><br><span class="line"><span class="comment">| Problem: Forgiving Matching</span></span><br><span class="line"><span class="comment">| Contest: HDOJ</span></span><br><span class="line"><span class="comment">| URL:     https://acm.dingbacode.com/showproblem.php?pid=6975</span></span><br><span class="line"><span class="comment">| When:    2021-10-16 00:46:51</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Memory:  524 MB</span></span><br><span class="line"><span class="comment">| Time:    12000 ms</span></span><br><span class="line"><span class="comment">*******************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rev[maxn], tot, bit;</span><br><span class="line"><span class="keyword">double</span> a[maxn], b[maxn];</span><br><span class="line"><span class="comment">//å¤æ•°ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    <span class="built_in">Complex</span>(<span class="keyword">double</span> _r=<span class="number">0</span>,<span class="keyword">double</span> _i=<span class="number">0</span>)&#123;x=_r,y=_i;&#125;</span><br><span class="line">    Complex <span class="keyword">operator</span>+ (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + t.x, y + t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span>- (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span>* (<span class="keyword">const</span> Complex&amp; t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * t.x - y * t.y, x * t.y + y * t.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;A[maxn], B[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(Complex aa[], <span class="keyword">int</span> inv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i ++ )</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(aa[i], aa[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> w1 = <span class="built_in">Complex</span>(&#123;<span class="built_in">cos</span>(PI / mid), inv * <span class="built_in">sin</span>(PI / mid)&#125;);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i += mid * <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> wk = <span class="built_in">Complex</span>(&#123;<span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; mid; j ++, wk = wk * w1)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">auto</span> x = aa[i + j], y = wk * aa[i + j + mid];</span><br><span class="line">                aa[i + j] = x + y, aa[i + j + mid] = x - y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(inv==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">rep</span>(i,<span class="number">0</span>,tot<span class="number">-1</span>) aa[i].x/=tot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn];<span class="comment">//è´¡çŒ®--åŒ¹é…äº†çš„ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">int</span> ans[maxn];<span class="comment">//å¤±é…iåŒ¹é…æˆåŠŸçš„ä¸ªæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> n,m;<span class="comment">//å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		string s1,s2;</span><br><span class="line">		cin&gt;&gt;s1&gt;&gt;s2;</span><br><span class="line">		<span class="built_in">mem</span>(d,<span class="number">0</span>);<span class="built_in">mem</span>(ans,<span class="number">0</span>);</span><br><span class="line">		<span class="built_in">reverse</span>(<span class="built_in">all</span>(s2));</span><br><span class="line">		<span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;bit)&lt;n+m<span class="number">-1</span>) bit++;</span><br><span class="line">		tot = <span class="number">1</span>&lt;&lt;bit;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i ++ )</span><br><span class="line">        rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//åªè®¡ç®—æ•°å­—çš„åŒ¹é…ä¸ªæ•°</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">char</span> i = <span class="string">&#x27;0&#x27;</span>; i &lt;= <span class="string">&#x27;9&#x27;</span>; i++)&#123;</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,tot)&#123;</span><br><span class="line">				A[j].x = A[j].y = B[j].x = B[j].y = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,n<span class="number">-1</span>) A[j].x = (s1[j]==i);</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,m<span class="number">-1</span>) B[j].x = (s2[j]==i);</span><br><span class="line">			<span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">			<span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">0</span>,tot<span class="number">-1</span>) A[j] = A[j]*B[j];</span><br><span class="line">			<span class="built_in">FFT</span>(A,<span class="number">-1</span>);</span><br><span class="line">			<span class="built_in">rep</span>(j,m<span class="number">-1</span>,n<span class="number">-1</span>)&#123; </span><br><span class="line">				d[j] += (<span class="keyword">int</span>)(A[j].x+<span class="number">0.5</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="comment">//S1ä¸­æ˜Ÿå·å»åŒ¹é…S2</span></span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,tot)&#123;</span><br><span class="line">			A[j].x = A[j].y = B[j].x = B[j].y = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,m<span class="number">-1</span>) B[j].x = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,n<span class="number">-1</span>) A[j].x = (s1[j]==<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">		<span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,tot<span class="number">-1</span>) A[j] = A[j]*B[j];</span><br><span class="line">		<span class="built_in">FFT</span>(A,<span class="number">-1</span>);</span><br><span class="line">		<span class="built_in">rep</span>(j,m<span class="number">-1</span>,n<span class="number">-1</span>) d[j] += (<span class="keyword">int</span>)(A[j].x+<span class="number">0.5</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">//S2æ˜Ÿå·å»åŒ¹é…S1</span></span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,tot)&#123;</span><br><span class="line">			A[j].x = A[j].y = B[j].x = B[j].y = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,n<span class="number">-1</span>) A[j].x = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,m<span class="number">-1</span>) B[j].x = (s2[j]==<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">		<span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,tot<span class="number">-1</span>) A[j] = A[j]*B[j];</span><br><span class="line">		<span class="built_in">FFT</span>(A,<span class="number">-1</span>);</span><br><span class="line">		<span class="built_in">rep</span>(j,m<span class="number">-1</span>,n<span class="number">-1</span>) d[j] += (<span class="keyword">int</span>)(A[j].x+<span class="number">0.5</span>);</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="comment">//å‡å»S1ï¼ŒS2åŒæ—¶æ˜¯æ˜Ÿå·çš„åŒ¹é…æƒ…å†µ</span></span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,tot)&#123;</span><br><span class="line">			A[j].x = A[j].y = B[j].x = B[j].y = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,n<span class="number">-1</span>) A[j].x = (s1[j]==<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,m<span class="number">-1</span>) B[j].x = (s2[j]==<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">		<span class="built_in">FFT</span>(A,<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">FFT</span>(B,<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,tot<span class="number">-1</span>) A[j] = A[j]*B[j];</span><br><span class="line">		<span class="built_in">FFT</span>(A,<span class="number">-1</span>);</span><br><span class="line">		<span class="built_in">rep</span>(j,m<span class="number">-1</span>,n<span class="number">-1</span>) d[j] -= (<span class="keyword">int</span>)(A[j].x+<span class="number">0.5</span>);</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="comment">//æœ‰æˆåŠŸåŒ¹é…ä¸ªæ•°è½¬åŒ–ä¸ºå¤±é…ä¸ªæ•°</span></span><br><span class="line">		<span class="built_in">rep</span>(i,m<span class="number">-1</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">			ans[m-d[i]]++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//è¾“å‡ºå‰ç¼€å’Œ</span></span><br><span class="line">		ll now = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">			now+=ans[i];</span><br><span class="line">			<span class="built_in">wtl</span>(now);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><h4 id="å“ˆå¸Œkå¤±é…åŒ¹é…é—®é¢˜"><a href="#å“ˆå¸Œkå¤±é…åŒ¹é…é—®é¢˜" class="headerlink" title="å“ˆå¸Œkå¤±é…åŒ¹é…é—®é¢˜"></a>å“ˆå¸Œkå¤±é…åŒ¹é…é—®é¢˜</h4><h5 id="P3763-TJOI2017-DNA-Hash-äºŒåˆ†"><a href="#P3763-TJOI2017-DNA-Hash-äºŒåˆ†" class="headerlink" title="P3763 [TJOI2017]DNA        Hash + äºŒåˆ†"></a><strong><a href="https://www.luogu.com.cn/problem/P3763">P3763 [TJOI2017]DNA</a>        Hash + äºŒåˆ†</strong></h5><p><strong>é¢˜æ„ï¼š</strong>åœ¨Sä¸­åŒ¹é…Pçš„ä¸ªæ•°ï¼ˆå…è®¸3å¤„ä¸ä¸€æ ·ï¼‰</p>
<p><strong>æ€è·¯ï¼š</strong>æšä¸¾P (len=n) åœ¨S (len = m) çš„èµ·ç‚¹ï¼ˆ$O(n)$ï¼‰æ¯ä¸€æ¬¡éƒ½äºŒåˆ†ä»å½“å‰èµ·ç‚¹å¼€å§‹ä¸‹ä¸€å¤„ä¸åŒ¹é…çš„åœ°æ–¹åœ¨å“ªï¼ˆ$O(k \times log_{2}m$ï¼‰ï¼ˆhs1[lâ€¦mid] != hs2[lâ€¦.mid] è¯´æ˜ä¸åŒ¹é…çš„ç‚¹åœ¨å‰é¢â€”-&gt;r = mid-1å¦åˆ™l = mid+1ï¼‰</p>
<p><strong>æ€»å¤æ‚åº¦ï¼š</strong>$O(nklog_{2}m)$</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"></span><br><span class="line">ull hs[maxn][<span class="number">2</span>],P[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function">ull <span class="title">cal</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id)</span></span>&#123;<span class="comment">//æ±‚å­—ä¸²å“ˆå¸Œå€¼</span></span><br><span class="line">    <span class="keyword">return</span> hs[r][id] - hs[l<span class="number">-1</span>][id] * P[r-l+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lcp</span><span class="params">(<span class="keyword">int</span> l1, <span class="keyword">int</span> l2)</span></span>&#123;<span class="comment">//l1 Så¼€å§‹ä½ç½®ï¼›l2 På¼€å§‹ä½ç½®</span></span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = M - l2+<span class="number">1</span>;<span class="comment">//äºŒåˆ†çš„æ˜¯å¾€åç›¸åŒçš„é•¿åº¦ï¼Œæœ€å¤šåˆ°Mï¼Œæ‰€ä»¥ræ˜¯M-l2+1</span></span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">cal</span>(l1,l1+mid<span class="number">-1</span>,<span class="number">0</span>) == <span class="built_in">cal</span>(l2,l2+mid<span class="number">-1</span>,<span class="number">1</span>)) l = mid+<span class="number">1</span>;<span class="comment">//midå¯è¡Œ</span></span><br><span class="line">        <span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        string S[<span class="number">2</span>];</span><br><span class="line">        cin &gt;&gt; S[<span class="number">0</span>] &gt;&gt; S[<span class="number">1</span>];</span><br><span class="line">        S[<span class="number">0</span>] = <span class="string">&#x27; &#x27;</span> + S[<span class="number">0</span>];</span><br><span class="line">        S[<span class="number">1</span>] = <span class="string">&#x27; &#x27;</span> + S[<span class="number">1</span>];</span><br><span class="line">        N = S[<span class="number">0</span>].<span class="built_in">size</span>()<span class="number">-1</span>, M = S[<span class="number">1</span>].<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        P[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i,<span class="number">1</span>,N) P[i] = P[i<span class="number">-1</span>]*<span class="number">2333</span>;</span><br><span class="line">        <span class="comment">//è®¡ç®—å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼å‰ç¼€</span></span><br><span class="line">        <span class="built_in">rep</span>(i,<span class="number">1</span>,N) </span><br><span class="line">            hs[i][<span class="number">0</span>] = hs[i<span class="number">-1</span>][<span class="number">0</span>]*<span class="number">2333</span> + S[<span class="number">0</span>][i];</span><br><span class="line">        <span class="built_in">rep</span>(i,<span class="number">1</span>,M) </span><br><span class="line">            hs[i][<span class="number">1</span>] = hs[i<span class="number">-1</span>][<span class="number">1</span>]*<span class="number">2333</span> + S[<span class="number">1</span>][i];</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i+M<span class="number">-1</span>&gt;N) <span class="keyword">break</span>;<span class="comment">//ä»iå¼€å§‹å¾€åé•¿åº¦ä¸æ»¡è¶³M</span></span><br><span class="line">            <span class="keyword">int</span> p1 = <span class="number">1</span>, p2 = <span class="number">1</span>;<span class="comment">//å¼€å§‹ä½ç½®éƒ½æ˜¯1</span></span><br><span class="line">            <span class="built_in">rep</span>(j,<span class="number">1</span>,<span class="number">4</span>)&#123;<span class="comment">//å…è®¸3æ¬¡ä¸åŒï¼Œé‚£ä¹ˆæ‰¾åˆ°ç¬¬å››ä¸ªä¸åŒçš„ç‚¹</span></span><br><span class="line">                <span class="keyword">int</span> x = <span class="built_in">lcp</span>(i+p1<span class="number">-1</span>,p2);<span class="comment">//ç›¸åŒçš„é•¿åº¦</span></span><br><span class="line">                <span class="comment">//æ›´æ–°ä½ç½®</span></span><br><span class="line">                p1+=x;</span><br><span class="line">                p2+=x;</span><br><span class="line">                <span class="keyword">if</span>(j!=<span class="number">4</span>) p1++,p2++;<span class="comment">//è·³è¿‡é”™è¯¯çš„ä½ç½®ï¼Œæœ€åä¸€ä¸ªä¸èƒ½è·³</span></span><br><span class="line">                <span class="keyword">if</span>(p2&gt;M)&#123;<span class="comment">//æ»¡è¶³äº†</span></span><br><span class="line">                    ans++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">wtl</span>(ans);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
]]></content>
  </entry>
  <entry>
    <title>æ•°ä½DP</title>
    <url>/2021/11/17/%E6%95%B0%E4%BD%8DDP/</url>
    <content><![CDATA[<h1 id="æ•°ä½DP"><a href="#æ•°ä½DP" class="headerlink" title="æ•°ä½DP"></a>æ•°ä½DP</h1><h3 id="ã€ä»‹ç»ã€‘"><a href="#ã€ä»‹ç»ã€‘" class="headerlink" title="ã€ä»‹ç»ã€‘"></a>ã€ä»‹ç»ã€‘</h3><p>æ˜¾ç„¶ï¼Œæ˜¯ä¸€ç§DPã€‚</p>
<p>å†æ˜¾ç„¶ï¼Œæ˜¯ä¸€ç§å…³äºæ¯ä¸€ä½æ•°å­—ä¹‹é—´å…³ç³»ï¼ˆæ€§è´¨ï¼‰çš„DP</p>
<hr>
<h3 id="ã€é¢˜ç›®ç‰¹å¾ã€‘"><a href="#ã€é¢˜ç›®ç‰¹å¾ã€‘" class="headerlink" title="ã€é¢˜ç›®ç‰¹å¾ã€‘"></a>ã€é¢˜ç›®ç‰¹å¾ã€‘</h3><p><strong>é¢˜ç›®æè¿°</strong>ä¸€èˆ¬æ˜¯æ±‚ã€Lï¼ŒRã€‘èŒƒå›´å†…æ»¡è¶³å„ä½æ•°å­—é—´å­˜åœ¨æŸç§è§„å¾‹çš„æ•°æœ‰å‡ ä¸ª</p>
<p>æ•°ä½DPçš„é¢˜ç›®<strong>æ•°æ®èŒƒå›´</strong>å¾€å¾€å¾ˆå¤§ï¼ŒåŠ¨ä¸åŠ¨å°±æ˜¯1e18ï¼Œä½†æ˜¯ç”±äºæ˜¯æ•°ä½DPåªè·Ÿä½æ•°æœ‰å…³ï¼Œæ‰€ä»¥ä¹Ÿå°±18ä½ã€‚</p>
<hr>
<h3 id="ã€ç®—æ³•è®¾è®¡ã€‘"><a href="#ã€ç®—æ³•è®¾è®¡ã€‘" class="headerlink" title="ã€ç®—æ³•è®¾è®¡ã€‘"></a>ã€ç®—æ³•è®¾è®¡ã€‘</h3><p>ä½¿ç”¨<strong>è®°å¿†åŒ–æœç´¢</strong>è¿›è¡ŒDPå› ä¸ºä¼šå‡ºç°é‡å¤å‡ºç°çš„çŠ¶æ€ï¼Œä½¿ç”¨è®°å¿†åŒ–æœç´¢å¯ä»¥å‡å°‘é‡å¤çš„æœç´¢ï¼Œå‡å°‘å¤æ‚åº¦ã€‚</p>
<h4 id="ä¸€-è®°å¿†åŒ–æœç´¢çš„è¿‡ç¨‹"><a href="#ä¸€-è®°å¿†åŒ–æœç´¢çš„è¿‡ç¨‹" class="headerlink" title="ä¸€.è®°å¿†åŒ–æœç´¢çš„è¿‡ç¨‹"></a>ä¸€.è®°å¿†åŒ–æœç´¢çš„è¿‡ç¨‹</h4><p>â€‹        ä»èµ·ç‚¹å‘ä¸‹æœç´¢ï¼Œæœç´¢çš„é€”ä¸­ç´¯åŠ æ¯ä¸€ä½çš„ç­”æ¡ˆï¼Œæœ€ååœ¨èµ·ç‚¹å¾—åˆ°ç­”æ¡ˆã€‚</p>
<h4 id="äºŒ-åŒºé—´è½¬åŒ–ä¸º-0-X"><a href="#äºŒ-åŒºé—´è½¬åŒ–ä¸º-0-X" class="headerlink" title="äºŒ. åŒºé—´è½¬åŒ–ä¸º[0,X]"></a>äºŒ. åŒºé—´è½¬åŒ–ä¸º[0,X]</h4><p>â€‹    å¯¹äº[L,R]çš„åŒºé—´é—®é¢˜ï¼Œä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æ ¹æ®å‰ç¼€å’Œç›¸å‡è½¬åŒ–ä¸º[0,R] - [0,L-1]çš„é—®é¢˜ã€‚</p>
<h4 id="ä¸‰-dfsçš„å‚æ•°"><a href="#ä¸‰-dfsçš„å‚æ•°" class="headerlink" title="ä¸‰.dfsçš„å‚æ•°"></a>ä¸‰.dfsçš„å‚æ•°</h4><p><strong>pos</strong>, å½“å‰æ‰¾åˆ°äº†ç¬¬å‡ ä½<br><strong>limit</strong>ï¼Œå› ä¸ºé—®é¢˜å·²ç»è½¬åŒ–ä¸ºäº†å°äºXçš„æ‰€æœ‰æ­£æ•´æ•°ä¸­ç¬¦åˆæ¡ä»¶çš„ä¸ªæ•°ï¼Œæˆ‘ä»¬ä»é«˜ä½æšä¸¾ï¼Œä¸€æ—¦å½“å‰ä½å°äºXï¼Œé‚£ä¹ˆåé¢æ•°å­—å¯ä»¥éšä¾¿é€‰ã€‚limitå°±æ˜¯åˆ¤æ–­å½“å‰ä½æ˜¯å¦å¯ä»¥ä»»æ„é€‰ã€‚</p>
<blockquote>
<p><strong>é€’å½’ä¸­limitçš„ä¼ é€’</strong></p>
<p>1.å½“å‰æ²¡æœ‰é™åˆ¶limit=0ï¼Œé‚£ä¹ˆæ˜¾ç„¶åé¢åº”è¯¥éƒ½æ²¡é™åˆ¶ï¼Œæ˜¯0</p>
<p>2.å½“å‰æœ‰é™åˆ¶limit=1ï¼›</p>
<p>â€‹    1.å¦‚æœå½“å‰ä½é€‰çš„æ•°å°äºXå¯¹åº”ä½æ•°å­—ï¼Œé‚£ä¹ˆåé¢åº”è¯¥æ˜¯æ²¡é™åˆ¶0</p>
<p>â€‹    2.å¦‚æœå½“å‰ä½é€‰çš„æ•°æ°å¥½ç­‰äºXå¯¹åº”ä½æ•°å­—ï¼Œè¿™ä¸ªåˆ†æ”¯ç›¸å½“äºæ˜¯ç´§è´´ç€Xçš„æ¯ä¸€ä½ï¼ˆå‰é¢æšä¸¾åˆ°çš„ä½é€‰çš„å’ŒXä¸€æ ·ï¼‰ï¼Œé‚£ä¹ˆåé¢è¿˜è¦é™åˆ¶æ•°å­—å¤§å°ï¼Œlimitä¸º1</p>
<p><strong>ç»¼ä¸Šï¼šæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºlimitçš„è½¬ç§»æ–¹ç¨‹  limit = limit&amp;&amp;j==X[i]</strong> (X[i]æ˜¯å½“å‰ä½èƒ½æšä¸¾å¾—æœ€å¤§å€¼, jæ˜¯å½“å‰æ­£åœ¨æšä¸¾å¾—æ•°)</p>
</blockquote>
<p>  3.<strong>preï¼Œ</strong>æœ‰äº›é¢˜ç›®çš„æ€§è´¨æ˜¯å’Œå‰å‡ ä½æ•°å­—æœ‰å…³ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥åŠ ä¸Špre1â€¦pre2</p>
<p>  4.<strong>zeroï¼Œ</strong>åˆ¤æ–­æ˜¯å¦æœ‰å‰å¯¼0ï¼Œæ¯”å¦‚æ‰€æœ‰ä½ç›¸åŒçš„æ•°åŒ…æ‹¬000333ï¼ˆå®è´¨æ˜¯333ï¼‰å‰é¢éƒ½æ˜¯0çš„è¯å–1ï¼Œå¦åˆ™å–0</p>
<blockquote>
<p><strong>é€’å½’ä¸­zeroå‰å¯¼é›¶çš„ä¼ é€’</strong></p>
<p>1.å‰ä¸€ä½æ˜¯å‰å¯¼0</p>
<p>â€‹    1.å½“å‰ä½æ˜¯0ï¼Œé‚£ä¹ˆåé¢è¿˜æ˜¯zeroè¿˜æ˜¯1</p>
<p>â€‹    2.å½“å‰ä½ä¸æ˜¯0ï¼Œé‚£ä¹ˆåé¢zero=0</p>
<p>2.å‰ä¸€ä½ä¸æ˜¯å‰å¯¼0ï¼Œé‚£ä¹ˆä¸ç®¡å½“å‰ä½æ˜¯ä¸æ˜¯0ï¼Œåé¢zeroéƒ½æ˜¯1</p>
<p><strong>ç»¼ä¸Šï¼šæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºzeroçš„è½¬ç§»æ–¹ç¨‹  zero = zero&amp;&amp;(!j)</strong> (X[i]æ˜¯å½“å‰ä½èƒ½æšä¸¾å¾—æœ€å¤§å€¼, jæ˜¯å½“å‰æ­£åœ¨æšä¸¾å¾—æ•°)</p>
</blockquote>
<h4 id="å››-è®°å¿†åŒ–æœç´¢çš„è®°å¿†åŒ–"><a href="#å››-è®°å¿†åŒ–æœç´¢çš„è®°å¿†åŒ–" class="headerlink" title="å››.è®°å¿†åŒ–æœç´¢çš„è®°å¿†åŒ–"></a>å››.è®°å¿†åŒ–æœç´¢çš„è®°å¿†åŒ–</h4><p>â€‹    æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªdpæ•°ç»„æ¥è®°å½•å·²ç»ç¡®è®¤çš„çŠ¶æ€çš„å€¼ï¼Œä¸‹æ ‡ç”¨æ¥è¡¨ç¤ºçŠ¶æ€ï¼Œç­‰åˆ°åé¢æœåˆ°ç›¸åŒçŠ¶æ€æ—¶ä¸ç”¨é€’å½’åˆ°æœ€åº•å±‚ç›´æ¥å¯ä»¥æ‹¿æ¥å¤ç”¨ã€‚</p>
<h4 id="äº”-æ¨¡æ¿"><a href="#äº”-æ¨¡æ¿" class="headerlink" title="äº”.æ¨¡æ¿"></a>äº”.æ¨¡æ¿</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> pre,<span class="keyword">int</span> st,â€¦â€¦,<span class="keyword">int</span> lead,<span class="keyword">int</span> limit)</span><span class="comment">//è®°å¿†åŒ–æœç´¢</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pos&gt;len) <span class="keyword">return</span> st;<span class="comment">//å‰ªæ</span></span><br><span class="line">    <span class="keyword">if</span>((dp[pos][pre][st]â€¦â€¦[â€¦â€¦]!=<span class="number">-1</span>&amp;&amp;(!limit)&amp;&amp;(!lead))) <span class="keyword">return</span> dp[pos][pre][st]â€¦â€¦[â€¦â€¦];<span class="comment">//ç›¸åŒçŠ¶æ€ï¼Œä¹Ÿå¯ä»¥å§limitå’Œleadä¹Ÿæ”¾å…¥dpæ•°ç»„ä¸­ï¼ˆå¤šå¼€ä¸¤ä¸ªç»´åº¦ï¼‰</span></span><br><span class="line">    ll ret=<span class="number">0</span>;<span class="comment">//æš‚æ—¶è®°å½•å½“å‰æ–¹æ¡ˆæ•°</span></span><br><span class="line">    <span class="keyword">int</span> res=limit?a[len-pos+<span class="number">1</span>]:<span class="number">9</span>;<span class="comment">//reså½“å‰ä½èƒ½å–åˆ°çš„æœ€å¤§å€¼ï¼Œlimitçš„ä½œç”¨</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=res;i++)<span class="comment">//æœç´¢æ¯ä¸ªå¯å–çš„æ•°</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//æœ‰å‰å¯¼0å¹¶ä¸”å½“å‰ä½ä¹Ÿæ˜¯å‰å¯¼0</span></span><br><span class="line">        <span class="keyword">if</span>((!i)&amp;&amp;lead) ret+=<span class="built_in">dfs</span>(â€¦â€¦,â€¦â€¦,â€¦â€¦,i==res&amp;&amp;limit);</span><br><span class="line">        <span class="comment">//æœ‰å‰å¯¼0ä½†å½“å‰ä½ä¸æ˜¯å‰å¯¼0ï¼Œå½“å‰ä½å°±æ˜¯æœ€é«˜ä½</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(i&amp;&amp;lead) ret+=<span class="built_in">dfs</span>(â€¦â€¦,â€¦â€¦,â€¦â€¦,i==res&amp;&amp;limit); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(æ ¹æ®é¢˜æ„è€Œå®šçš„åˆ¤æ–­) ret+=<span class="built_in">dfs</span>(â€¦â€¦,â€¦â€¦,â€¦â€¦,i==res&amp;&amp;limit);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!limit&amp;&amp;!lead) dp[pos][pre][st]â€¦â€¦[â€¦â€¦]=ret;<span class="comment">//æ²¡å‰å¯¼é›¶ï¼Œåé¢æ— é™åˆ¶ï¼Œå½“å‰çŠ¶æ€æ–¹æ¡ˆæ•°è®°å½•</span></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">part</span><span class="params">(ll x)</span><span class="comment">//æŠŠæ•°æŒ‰ä½æ‹†åˆ†</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    len=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x) a[++len]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">-1</span>,<span class="keyword">sizeof</span> dp);<span class="comment">//åˆå§‹åŒ–-1ï¼ˆå› ä¸ºæœ‰å¯èƒ½æŸäº›æƒ…å†µä¸‹çš„æ–¹æ¡ˆæ•°æ˜¯0ï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dfs</span>(â€¦â€¦,â€¦â€¦,â€¦â€¦,â€¦â€¦);<span class="comment">//è¿›å…¥è®°æœ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;l,&amp;r);</span><br><span class="line">        <span class="keyword">if</span>(l) <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,<span class="built_in">part</span>(r)-<span class="built_in">part</span>(l<span class="number">-1</span>));<span class="comment">//[l,r](l!=0)</span></span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,<span class="built_in">part</span>(r)-<span class="built_in">part</span>(l));<span class="comment">//ä»0å¼€å§‹è¦ç‰¹åˆ¤</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€‹    </p>
<h3 id="ã€ä¾‹é¢˜ã€‘"><a href="#ã€ä¾‹é¢˜ã€‘" class="headerlink" title="ã€ä¾‹é¢˜ã€‘"></a>ã€ä¾‹é¢˜ã€‘</h3><ul>
<li><h4 id="45å±Šicpcä¸Šæµ·Sum-of-Log"><a href="#45å±Šicpcä¸Šæµ·Sum-of-Log" class="headerlink" title="45å±Šicpcä¸Šæµ·Sum of Log"></a><a href="https://ac.nowcoder.com/acm/contest/21785/C">45å±Šicpcä¸Šæµ·Sum of Log</a></h4></li>
</ul>
<p>ä¸€èˆ¬çš„æ•°ä½DPå¥—è·¯é¢˜éƒ½æ˜¯ä¸€ä¸ªæ•°æ»¡è¶³ä»€ä¹ˆæ€§è´¨ï¼Œè€Œè¿™é¢˜æ˜¯ä¸¤ä¸ªæ•°æ»¡è¶³ä¸€ä¸ªæ€§è´¨å°±æ˜¯ä¸èµ·æ¥æ˜¯0ã€‚é‚£ä¹ˆæˆ‘ä»¬ç±»æ¯”ä¸€ä¸‹ï¼ŒåŸæ¥é™åˆ¶å•ä¸ªæ•°åé¢å–å€¼çš„limitç°åœ¨è¦æœ‰ä¸¤ä¸ªï¼Œè€Œå½“å‰æœç´¢çš„ä½ç½®å› ä¸ºä¸¤ä¸ªæ•°ä½ç½®æ€»æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥åªéœ€è¦ä¸€ä¸ªã€‚å› ä¸ºä¸¤ä¸ªæ•°&amp;èµ·æ¥ç­‰äº0ï¼Œé‚£ä¹ˆä»–ä»¬ç›¸åŠ æ˜¯ä¸è¿›ä½çš„ï¼Œåˆå–äº†logï¼Œç­”æ¡ˆå°±æ˜¯æœ€é«˜ä½çš„ä½ç½®åŠ 1ï¼Œæ‰€ä»¥æ¯ä¸€ä½çš„è´¡çŒ®å°±æ˜¯è¿™ä½æ˜¯æœ€é«˜ä½çš„æ•°é‡ä¹˜ä»¥è¿™ä½çš„ä½ç½®+1.</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M,K;</span><br><span class="line"><span class="keyword">int</span> num1[<span class="number">33</span>],num2[<span class="number">33</span>],dp[<span class="number">33</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line"><span class="keyword">int</span> bit[<span class="number">33</span>];</span><br><span class="line"><span class="keyword">int</span> L, R, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> limit1, <span class="keyword">int</span> limit2, <span class="keyword">int</span> zero)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(now == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//æšä¸¾å®Œäº†</span></span><br><span class="line">	<span class="keyword">int</span> &amp;x = dp[now][limit1][limit2];</span><br><span class="line">	<span class="keyword">if</span>(~x) <span class="keyword">return</span> x;<span class="comment">//å·²ç»æœè¿‡äº†</span></span><br><span class="line">	<span class="keyword">if</span> ((!limit1)&amp;&amp;(!limit2)&amp;&amp;!zero) <span class="keyword">return</span> x = bit[now+<span class="number">1</span>];<span class="comment">//æ²¡æœ‰é™åˆ¶ï¼Œåé¢å°±æ˜¯å…¨éƒ¨çš„ç»„åˆ</span></span><br><span class="line">	<span class="keyword">int</span> end1 = limit1?num1[now]:<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> end2 = limit2?num2[now]:<span class="number">1</span>;</span><br><span class="line">	x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> temp = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,end1)&#123;</span><br><span class="line">		<span class="built_in">rep</span>(j,<span class="number">0</span>,end2)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i&amp;j) <span class="keyword">continue</span>;<span class="comment">//ä¸ç¬¦åˆ&amp;=0</span></span><br><span class="line">			<span class="keyword">if</span>(zero&amp;&amp;(i|j))&#123;</span><br><span class="line">				temp = <span class="built_in">dfs</span>(now<span class="number">-1</span>,limit1&amp;&amp;(i==end1),limit2&amp;&amp;(j==end2),<span class="number">0</span>);</span><br><span class="line">				x = (x+temp)%mod;<span class="comment">//ä¸ºä¸Šä¸€å±‚ç´¯åŠ </span></span><br><span class="line">				cnt = (cnt+temp)%mod;<span class="comment">//å½“å‰ä½æ˜¯æœ€é«˜ä½</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				x = (x+<span class="built_in">dfs</span>(now<span class="number">-1</span>,limit1&amp;&amp;(i==end1),limit2&amp;&amp;(j==end2),zero&amp;&amp;(!(i|j))))%mod;<span class="comment">//ä¸ºä¸Šä¸€å±‚ç´¯åŠ </span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	ans=(ans+cnt*(now+<span class="number">1</span>))%mod;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">part</span><span class="params">(<span class="keyword">int</span> X, <span class="keyword">int</span> Y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> len = <span class="number">-1</span>;<span class="comment">//æ•°å­—æ”¾åœ¨ã€0ï¼Œlenã€‘ä¸­</span></span><br><span class="line">	<span class="keyword">while</span>(X || Y) &#123;</span><br><span class="line">		num1[++len] = X%<span class="number">2</span>, X/=<span class="number">2</span>;</span><br><span class="line">		num2[len] = Y%<span class="number">2</span>, Y/=<span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	ans = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">mem</span>(dp,<span class="number">-1</span>);</span><br><span class="line">	<span class="built_in">dfs</span>(len,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">wtl</span>(ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; L &gt;&gt; R;</span><br><span class="line">	<span class="built_in">part</span>(L,R);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	bit[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,<span class="number">32</span>) bit[i] = bit[i<span class="number">-1</span>]*<span class="number">3</span>%mod;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li><h4 id="2020Hong-Kong-J-Junior-Mathematician"><a href="#2020Hong-Kong-J-Junior-Mathematician" class="headerlink" title="2020Hong Kong   J. Junior Mathematician"></a><a href="https://codeforces.com/gym/102452/problem/J">2020Hong Kong   J. Junior Mathematician</a></h4></li>
</ul>
<p>è¿™é¢˜ä¸ä¸Šé¢˜ä¸åŒï¼Œåªæœ‰ä¸€ä¸ªæ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‰ç¼€å’Œç›¸å‡æ¥æ±‚ï¼Œä½†æ˜¯æ•°å­—å¤ªå¤§æœ‰5000ä½ï¼Œéœ€è¦ç”¨åˆ°å­—ç¬¦ä¸²æ¥å­˜å‚¨ï¼Œå¯¹å­—ç¬¦ä¸²æ±‚å‡ä¸€æ¶‰åŠåˆ°å€Ÿä½ï¼Œå¯èƒ½æœ‰äº›éº»çƒ¦ï¼ˆå…¶å®ä¹Ÿå¹¶ä¸éº»çƒ¦ï¼‰ã€‚è¿™é‡Œæä¾›å¦ä¸€ç§æ€è·¯ï¼Œå°±æ˜¯åˆ¤æ–­Lè¿™ä¸ªæ•°æ˜¯å¦æ»¡è¶³å³å¯ã€‚</p>
<p><strong>å‚æ•°åˆ†æï¼š</strong></p>
<ol>
<li>æ»¡è¶³fï¼ˆxï¼‰= xï¼ˆmod Mï¼‰ æˆ‘ä»¬å¯ä»¥æ„é€ gï¼ˆxï¼‰= fï¼ˆxï¼‰- xï¼Œé‚£ä¹ˆæ¡ä»¶å˜æˆgï¼ˆxï¼‰= 0 ï¼ˆmod Mï¼‰</li>
<li>è®¡ç®—fï¼ˆxï¼‰æ—¶ï¼Œä¸ºäº†é¿å…é‡å¤è®¡ç®—è´¡çŒ®ï¼Œè§„å®šå½“å‰æ•°å­—åªä¼šè·Ÿå‰é¢çš„æ•°å­—äº§ç”Ÿè´¡çŒ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è®°å½•æ¯ä¸€ä½æ•°å­—çš„å‰ç¼€å’Œpreï¼Œç„¶åå½“å‰æ•°å­—çš„è´¡çŒ®å°±æ˜¯j * pre</li>
</ol>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M,K;</span><br><span class="line"><span class="keyword">int</span> bit[<span class="number">5009</span>],A[<span class="number">5009</span>],dp[<span class="number">5009</span>][<span class="number">61</span>][<span class="number">61</span>][<span class="number">2</span>],id,st[<span class="number">5009</span>][<span class="number">61</span>][<span class="number">61</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">char</span> R[<span class="number">5009</span>],L[<span class="number">5009</span>];</span><br><span class="line"><span class="keyword">int</span> f;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> pre,<span class="keyword">int</span> fx, <span class="keyword">int</span> limit)</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(now==(N+<span class="number">1</span>))&#123;</span><br><span class="line">		f = (fx==<span class="number">0</span>);<span class="comment">//åˆ¤æ–­Xæ˜¯å¦å¯è¡Œ</span></span><br><span class="line">		<span class="keyword">return</span> f;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (st[now][pre][fx][limit]==id) <span class="keyword">return</span> dp[now][pre][fx][limit];<span class="comment">//è¿™æ ·å¯ä»¥ä¸ç”¨åˆå§‹åŒ–dpæ•°ç»„ï¼Œç­‰äºå½“å‰idè¯´æ˜æ˜¯æœ¬ç»„æ•°æ®ï¼Œä¸åŒç»„çš„æ¨¡æ•°æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥åŒä¸€ä¸ªçŠ¶æ€çš„å€¼å¯èƒ½ä¸åŒ</span></span><br><span class="line">	st[now][pre][fx][limit] = id;</span><br><span class="line">	<span class="keyword">int</span> lim = limit?A[now]:<span class="number">9</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,lim)&#123;</span><br><span class="line">		<span class="keyword">int</span> dif = <span class="built_in">mo</span>((fx+i*pre-i*bit[N-now]),M);</span><br><span class="line">		ans = ans+<span class="built_in">dfs</span>(now+<span class="number">1</span>,(pre+i)%M,dif,limit&amp;&amp;(i==A[now]));</span><br><span class="line">	&#125;</span><br><span class="line">	ans = (ans+mod)%mod;</span><br><span class="line">	dp[now][pre][fx][limit] = ans;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">part</span><span class="params">(<span class="keyword">char</span> X[])</span></span>&#123;</span><br><span class="line">	<span class="comment">//printf(&quot;!---%s\n&quot;,X+1);</span></span><br><span class="line">	++id;<span class="comment">//æ ‡è®°æµ‹è¯•æ•°æ®ç»„åˆ«</span></span><br><span class="line">	N = <span class="built_in">strlen</span>(X+<span class="number">1</span>);	</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) A[i] = X[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s %s %d&quot;</span>,L+<span class="number">1</span>,R+<span class="number">1</span>,&amp;M);</span><br><span class="line">	N = <span class="built_in">strlen</span>(R+<span class="number">1</span>);</span><br><span class="line">    bit[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">		bit[i] = bit[i<span class="number">-1</span>]*<span class="number">10</span>%M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="built_in">part</span>(R);</span><br><span class="line">	f = <span class="number">0</span>;</span><br><span class="line">	ans-=<span class="built_in">part</span>(L);</span><br><span class="line">	<span class="comment">//debug(f);</span></span><br><span class="line">	ans+=f;<span class="comment">//fæ˜¯åˆ¤æ–­Læ˜¯å¦æœ‰æ•ˆï¼Œæœ‰æ•ˆçš„è¯å°±ä¸º1ï¼ˆå‰ç¼€å’Œç›¸å‡æ—¶å¤šå‡äº†1åŠ å›æ¥ï¼‰</span></span><br><span class="line">	<span class="built_in">wtl</span>(<span class="built_in">mo</span>(ans,mod));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>æ ‘å½¢DP</title>
    <url>/2021/10/08/%E6%A0%91%E5%BD%A2DP/</url>
    <content><![CDATA[<h3 id="P1352-æ²¡æœ‰ä¸Šå¸çš„èˆä¼š"><a href="#P1352-æ²¡æœ‰ä¸Šå¸çš„èˆä¼š" class="headerlink" title="P1352 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š"></a><a href="https://www.luogu.com.cn/problem/P1352">P1352 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š</a></h3><p><strong>é¢˜æ„ï¼š</strong>æ±‚é€‰æ‹©çš„ç‚¹çš„æƒå€¼å’Œæœ€å¤§ã€‚é™åˆ¶æ¡ä»¶ï¼šè‹¥çˆ¶èŠ‚ç‚¹è¢«é€‰ï¼Œå­èŠ‚ç‚¹ä¸èƒ½è¢«é€‰</p>
<p>çŠ¶æ€æœºæ¨¡å‹ï¼Œä¸è¿‡ä¸èƒ½ç”¨å¾ªç¯æšä¸¾é¡ºåºï¼Œç”¨æ ‘ä¸Šdfsé€’å½’çš„æ–¹å¼è¿›è¡Œæšä¸¾ã€‚</p>
<p>ä»£ç </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*******************************</span></span><br><span class="line"><span class="comment">| Author:  pigstar</span></span><br><span class="line"><span class="comment">| Problem: P1352 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š</span></span><br><span class="line"><span class="comment">| Contest: Luogu</span></span><br><span class="line"><span class="comment">| URL:     https://www.luogu.com.cn/problem/P1352</span></span><br><span class="line"><span class="comment">| When:    2021-10-08 09:33:54</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Memory:  128 MB</span></span><br><span class="line"><span class="comment">| Time:    1000 ms</span></span><br><span class="line"><span class="comment">*******************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn],vis[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	vis[u] = <span class="number">1</span>;<span class="comment">//æœç´¢è¿‡äº†</span></span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,(<span class="built_in">sz</span>(G[u])<span class="number">-1</span>))&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i];</span><br><span class="line">		<span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(to);</span><br><span class="line">		dp[u][<span class="number">0</span>]+=<span class="built_in">max</span>(dp[to][<span class="number">0</span>],dp[to][<span class="number">1</span>]);<span class="comment">//å½“å‰èŠ‚ç‚¹ä¸å»ï¼Œä¸‹å±å¯ä»¥å»ä¹Ÿå¯ä»¥ä¸å»</span></span><br><span class="line">		dp[u][<span class="number">1</span>]+=dp[to][<span class="number">0</span>];<span class="comment">//å½“å‰èŠ‚ç‚¹å»ï¼Œä¸‹å±ä¸èƒ½å»</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		cin&gt;&gt; N;</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; dp[i][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N<span class="number">-1</span>)&#123;</span><br><span class="line">			<span class="keyword">int</span> L, K;</span><br><span class="line">			cin &gt;&gt; L &gt;&gt; K;</span><br><span class="line">			st[L] = <span class="number">1</span>;<span class="comment">//æ ‡è®°ä¸æ˜¯æ ¹èŠ‚ç‚¹</span></span><br><span class="line">			G[K].<span class="built_in">pb</span>(L);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!st[i])&#123;<span class="comment">//ä»æ ¹èŠ‚ç‚¹å¼€å§‹dfs</span></span><br><span class="line">				<span class="built_in">dfs</span>(i);</span><br><span class="line">				cout &lt;&lt; <span class="built_in">max</span>(dp[i][<span class="number">1</span>],dp[i][<span class="number">0</span>]);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Computer"><a href="#Computer" class="headerlink" title="Computer"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2196">Computer</a></h3><p><strong>é¢˜æ„ï¼š</strong>æ±‚æ¯ä¸ªç‚¹ä¸å…¶ä»–ä»»æ„ä¸€ç‚¹çš„æœ€è¿œè·ç¦»</p>
<p>ç»™çš„æ˜¯ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸”åªæœ‰ä¸€ä¸ªçˆ¶äº²ã€‚ä¸”æœ¬é¢˜èŠ‚ç‚¹1æ˜¯æ ¹èŠ‚ç‚¹ã€‚</p>
<p>å¯¹äºä¸€ä¸ªèŠ‚ç‚¹ä»–çš„æœ€è¿œè·ç¦»æœ‰ä¸¤ç§</p>
<ul>
<li><strong>å‘ä¸‹ï¼š</strong>ä»¥å½“å‰èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘çš„æ·±åº¦ï¼ˆç”±dfs1å¯å¾—åˆ°ï¼‰</li>
<li><strong>å‘ä¸Šï¼š</strong>çˆ¶èŠ‚ç‚¹çš„æœ€è¿œè·ç¦»å†åŠ ä¸Šå½“å‰èŠ‚ç‚¹åˆ°çˆ¶èŠ‚ç‚¹çš„è·ç¦»</li>
</ul>
<p>ç„¶åè¿™ä¸¤ç§å–æœ€å¤§å€¼</p>
<p>ä»£ç </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*******************************</span></span><br><span class="line"><span class="comment">| Author:  pigstar</span></span><br><span class="line"><span class="comment">| Problem: Computer</span></span><br><span class="line"><span class="comment">| Contest: HDOJ</span></span><br><span class="line"><span class="comment">| URL:     http://acm.hdu.edu.cn/showproblem.php?pid=2196</span></span><br><span class="line"><span class="comment">| When:    2021-10-08 10:04:01</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Memory:  32 MB</span></span><br><span class="line"><span class="comment">| Time:    1000 ms</span></span><br><span class="line"><span class="comment">*******************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">// #define int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e4</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> id[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn][<span class="number">3</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to,v;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt; G[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">sz</span>(G[u]); i ++ )&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i].to, v = G[u][i].v;</span><br><span class="line">		<span class="keyword">if</span>(to==fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs1</span>(to,u);<span class="comment">//å…ˆé€’å½’åˆ°å­èŠ‚ç‚¹ï¼Œç”±å„¿å­ä¿¡æ¯å¾—åˆ°çˆ¶äº²èŠ‚ç‚¹ä¿¡æ¯</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">chkmx</span>(dp[u][<span class="number">0</span>],dp[to][<span class="number">0</span>]+v))&#123;</span><br><span class="line">			id[u]= to;<span class="comment">//è®°å½•æœ€é•¿è·¯å¾„çš„æ–¹å‘</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">sz</span>(G[u]); i ++ )&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i].to, v = G[u][i].v;</span><br><span class="line">		<span class="keyword">if</span>(to==fa||to==id[u]) <span class="keyword">continue</span>;<span class="comment">//å»æ‰æœ€é•¿è·ç¦»å°±æ˜¯æ¬¡é•¿è·ç¦»äº†</span></span><br><span class="line">		<span class="built_in">chkmx</span>(dp[u][<span class="number">1</span>],dp[to][<span class="number">0</span>]+v);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">sz</span>(G[u]); i ++ )&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i].to, v = G[u][i].v;</span><br><span class="line">		<span class="keyword">if</span>(to==fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(to==id[u])&#123;<span class="comment">//å½“å‰æ˜¯æœ€é•¿è·¯å¾„ï¼Œä¸èƒ½é‡å¤èµ°æ‰€ä»¥åªèƒ½æ¬¡é•¿è·ç¦»</span></span><br><span class="line">			dp[to][<span class="number">2</span>] = <span class="built_in">max</span>(dp[u][<span class="number">2</span>],dp[u][<span class="number">1</span>])+v;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			dp[to][<span class="number">2</span>] = <span class="built_in">max</span>(dp[u][<span class="number">2</span>],dp[u][<span class="number">0</span>])+v;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">dfs2</span>(to,u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;N))&#123;</span><br><span class="line">    <span class="comment">//å¤šç»„æµ‹è¯•æ•°æ®ï¼Œåˆå§‹åŒ–</span></span><br><span class="line">		<span class="built_in">mem</span>(dp,<span class="number">0</span>);</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N) &#123;</span><br><span class="line">			id[i] = <span class="number">1</span>;</span><br><span class="line">			G[i].<span class="built_in">clear</span>();</span><br><span class="line">		&#125;</span><br><span class="line">    <span class="comment">//å»ºå›¾</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++)&#123;</span><br><span class="line">			<span class="keyword">int</span> a,b;</span><br><span class="line">			cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">			G[i].<span class="built_in">pb</span>(&#123;a,b&#125;);</span><br><span class="line">			G[a].<span class="built_in">pb</span>(&#123;i,b&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">    </span><br><span class="line">		<span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">-1</span>);<span class="comment">//æ±‚å‡ºå‘ä¸‹çš„æœ€é•¿è·ç¦»dp[][0]å’Œæ¬¡é•¿è·ç¦»dp[][1]</span></span><br><span class="line">		<span class="built_in">dfs2</span>(<span class="number">1</span>,<span class="number">-1</span>);<span class="comment">//æ±‚å‡ºå‘ä¸Šçš„æœ€é•¿è·ç¦»</span></span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;</span><br><span class="line">			<span class="built_in">wtl</span>(<span class="built_in">max</span>(dp[i][<span class="number">0</span>],dp[i][<span class="number">2</span>]));<span class="comment">//å‘ä¸‹å’Œå‘ä¸Šå–Max</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Strategic-game"><a href="#Strategic-game" class="headerlink" title="Strategic game"></a><a href="http://poj.org/problem?id=1463">Strategic game</a></h3><p><strong>é¢˜æ„ï¼š</strong>ç»™ä½ ä¸€å¹…å›¾ï¼Œè¦æ±‚æ¯æ¡è¾¹è‡³å°‘ä¸€ä¸ªç«¯ç‚¹ä¸º1ï¼Œæ±‚æ‰€æœ‰ç«¯ç‚¹æƒå€¼å’Œæœ€å°å€¼ã€‚</p>
<p>ä¹Ÿæ˜¯çŠ¶æ€æœºåŠ ä¸Šdfsçš„é€’å½’é¡ºåºã€‚</p>
<ul>
<li>å¦‚æœå½“å‰èŠ‚ç‚¹ä¸º1ï¼Œç›¸é‚»èŠ‚ç‚¹å¯ä»¥ä¸º0ï¼Œ1ï¼Œç´¯åŠ å…¶ä¸­çš„æœ€å°å€¼ã€‚ï¼ˆåˆ«å¿˜äº†åŠ ä¸Šå½“å‰èŠ‚ç‚¹æœ¬èº«çš„1ï¼‰</li>
<li>å¦‚æœå½“å‰èŠ‚ç‚¹ä¸º0ï¼Œç›¸é‚»èŠ‚ç‚¹å¿…é¡»ä¸º1ï¼Œç´¯åŠ å³å¯ã€‚</li>
</ul>
<p>ä»æ ¹èŠ‚ç‚¹å¼€å§‹å…ˆé€’å½’åœ¨DPè®¡ç®—ï¼Œè¿™æ ·æœ€åç­”æ¡ˆåœ¨æ ¹èŠ‚ç‚¹çš„dpæ•°ç»„ä¸­ã€‚</p>
<p>ä»£ç </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*******************************</span></span><br><span class="line"><span class="comment">| Author:  pigstar</span></span><br><span class="line"><span class="comment">| Problem: Strategic game</span></span><br><span class="line"><span class="comment">| Contest: POJ - Southeastern Europe 2000</span></span><br><span class="line"><span class="comment">| URL:     http://poj.org/problem?id=1463</span></span><br><span class="line"><span class="comment">| When:    2021-10-08 14:39:50</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Memory:  10 MB</span></span><br><span class="line"><span class="comment">| Time:    2000 ms</span></span><br><span class="line"><span class="comment">*******************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">// #define int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e4</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> dp[maxn][<span class="number">2</span>],B[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	dp[u][<span class="number">1</span>] = <span class="number">1</span>;<span class="comment">//å½“å‰èŠ‚ç‚¹æœ¬èº«çš„æƒå€¼</span></span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="built_in">sz</span>(G[u])<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i];</span><br><span class="line">		<span class="keyword">if</span>(to==fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(to,u);<span class="comment">//å…ˆé€’å½’å†è®¡ç®—</span></span><br><span class="line">		dp[u][<span class="number">1</span>] += <span class="built_in">min</span>(dp[to][<span class="number">1</span>],dp[to][<span class="number">0</span>]);<span class="comment">//å½“å‰ä¸º1</span></span><br><span class="line">		dp[u][<span class="number">0</span>]+=dp[to][<span class="number">1</span>];<span class="comment">//å½“å‰ä¸º0</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;N))&#123;</span><br><span class="line">    <span class="built_in">mem</span>(dp,<span class="number">0</span>);</span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">0</span>,N) G[i].<span class="built_in">clear</span>();<span class="comment">//åˆå§‹åŒ–ï¼Œå¦åˆ™MLE</span></span><br><span class="line">		<span class="built_in">rep</span>(i,<span class="number">1</span>,N)&#123;<span class="comment">//å»ºå›¾</span></span><br><span class="line">			<span class="keyword">int</span> a,k,b;</span><br><span class="line">			cin &gt;&gt; a;</span><br><span class="line">			<span class="built_in">getchar</span>();</span><br><span class="line">			<span class="built_in">getchar</span>();</span><br><span class="line">			cin &gt;&gt; k;</span><br><span class="line">			<span class="built_in">getchar</span>();</span><br><span class="line">			<span class="built_in">rep</span>(j,<span class="number">1</span>,k)&#123;</span><br><span class="line">				cin &gt;&gt; b;</span><br><span class="line">				G[a].<span class="built_in">pb</span>(b);</span><br><span class="line">				G[b].<span class="built_in">pb</span>(a);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">		<span class="built_in">wtl</span>(<span class="built_in">min</span>(dp[<span class="number">1</span>][<span class="number">0</span>],dp[<span class="number">1</span>][<span class="number">1</span>]));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<h3 id="FAR-FarmCraft"><a href="#FAR-FarmCraft" class="headerlink" title="FAR-FarmCraft"></a><a href="https://www.luogu.com.cn/problem/P3574">FAR-FarmCraft</a></h3><p>ä»£ç </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*******************************</span></span><br><span class="line"><span class="comment">| Author:  pigstar</span></span><br><span class="line"><span class="comment">| Problem: P3574 [POI2014]FAR-FarmCraft</span></span><br><span class="line"><span class="comment">| Contest: Luogu</span></span><br><span class="line"><span class="comment">| URL:     https://www.luogu.com.cn/problem/P3574</span></span><br><span class="line"><span class="comment">| When:    2021-10-08 17:52:39</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Memory:  125 MB</span></span><br><span class="line"><span class="comment">| Time:    1000 ms</span></span><br><span class="line"><span class="comment">*******************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF_L 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cout&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> readI(l,r,A) for(int pig=l;pig<span class="meta-string">&lt;=r;pig++)	iocin &gt;</span>&gt; A[pig]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(ll x)</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmx</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmn</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,N,M;</span><br><span class="line"><span class="keyword">int</span> A[maxn],siz[maxn];<span class="comment">//éå†å®Œå­æ ‘çš„æ—¶é—´ï¼Œæ¯æ¡è¾¹æ˜¯1</span></span><br><span class="line"><span class="keyword">int</span> st[maxn];</span><br><span class="line">vi G[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn];<span class="comment">//ä»¥iä¸ºæ ¹çš„å­æ ‘æ‰€æœ‰å±…æ°‘å®‰è£…å®Œç”µè„‘çš„æ—¶é—´</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sa = siz[a], sb = siz[b];</span><br><span class="line">	a = dp[a], b = dp[b];</span><br><span class="line">	<span class="keyword">return</span> sa-a&lt;sb-b;<span class="comment">//éœ€è¦ç­‰å¾…çš„æ—¶é—´ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(u!=<span class="number">1</span>) dp[u] = A[u];</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="built_in">sz</span>(G[u])<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i];</span><br><span class="line">		<span class="keyword">if</span>(to==fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(to,u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(<span class="built_in">all</span>(G[u]),cmp);<span class="comment">//è´ªå¿ƒæ’åº</span></span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,<span class="built_in">sz</span>(G[u])<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="keyword">int</span> to = G[u][i];</span><br><span class="line">		<span class="keyword">if</span>(to==fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">chkmx</span>(dp[u],dp[to]+siz[u]+<span class="number">1</span>);<span class="comment">//å½“å‰å­æ ‘å®Œæˆæ—¶é—´æ˜¯æ‰€æœ‰å„¿å­å­æ ‘å®Œæˆæ—¶é—´çš„æœ€å¤§å€¼ï¼Œ+1æ˜¯å½“å‰èŠ‚ç‚¹å»å„¿å­çš„æ—¶é—´ï¼Œå›æ¥è¦†ç›–åœ¨äº†ç­‰å¾…æ—¶é—´å†…</span></span><br><span class="line">		siz[u] += siz[to]+<span class="number">2</span>;<span class="comment">//æ¯æ¬¡å›åˆ°çˆ¶äº²èŠ‚ç‚¹å¢åŠ çš„æ—¶é—´éƒ½æ˜¯å„¿å­éå†å®Œæ—¶é—´åŠ 2</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; N;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,N) cin &gt;&gt; A[i];</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">2</span>,N)&#123;</span><br><span class="line">		<span class="keyword">int</span> a, b;</span><br><span class="line">		cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">		G[a].<span class="built_in">pb</span>(b);</span><br><span class="line">		G[b].<span class="built_in">pb</span>(a);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">wtl</span>(<span class="built_in">max</span>(dp[<span class="number">1</span>],siz[<span class="number">1</span>]+A[<span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<hr>
<p><strong>æœªå®Œå¾…ç»­â€¦</strong></p>
]]></content>
  </entry>
  <entry>
    <title>ç¬¬ä¹å±Šâ€œå›¾çµæ¯â€NEUQ-ACMç¨‹åºè®¾è®¡ç«èµ›ä¸ªäººèµ›  Ké‡‘ç‰Œå¨å¸ˆ</title>
    <url>/2022/01/18/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E2%80%9C%E5%9B%BE%E7%81%B5%E6%9D%AF%E2%80%9DNEUQ-ACM%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B%E4%B8%AA%E4%BA%BA%E8%B5%9B%20%20K%E9%87%91%E7%89%8C%E5%8E%A8%E5%B8%88/</url>
    <content><![CDATA[<p><strong>é¢˜ç›®æè¿°</strong><br>Phenixä½œä¸ºé£Ÿå ‚çš„é‡‘ç‰Œå¨å¸ˆï¼Œæ¯å¤©çš„å·¥ä½œæ˜¯ä¸ºåŒå­¦ä»¬å‡†å¤‡é¥­èœï¼ŒPhenixåšå‡ºçš„æ¯ä¸€ç§èœéƒ½æœ‰ä¸€ä¸ªè¾£åº¦å€¼ï¼ŒèŒƒå›´æ˜¯[1,n][1,n]ã€‚ä½œä¸ºå¨å¸ˆï¼ŒPhenixæå‰äº†è§£äº†mä½åŒå­¦çš„è¾£åº¦æ¥å—èŒƒå›´ï¼Œç¬¬iä½åŒå­¦çš„è¾£åº¦æ¥å—èŒƒå›´è¢«æè¿°ä¸º$$$[l_i,r_i]$$$ï¼Œè¡¨ç¤ºè¯¥åŒå­¦å¯ä»¥æ¥å—è¾£åº¦å€¼ä½äºè¿™ä¸ªåŒºé—´çš„èœã€‚ç”±äºä¼—å£éš¾è°ƒï¼Œæ¯å¤©Phenixä¼šé€‰å‡ºéƒ¨åˆ†åŒå­¦ï¼Œåšå‡ºèƒ½è®©è¿™éƒ¨åˆ†åŒå­¦éƒ½æ¥å—çš„è¾£åº¦çš„èœã€‚Phenixä½œä¸ºé‡‘ç‰Œå¨å¸ˆå¯¹æ¯å¤©å·¥ä½œçš„æ»¡æ„ç¨‹åº¦å®šä¹‰ä¸ºé€‰å‡ºçš„åŒå­¦çš„äººæ•°kkå’Œèƒ½è®©è¿™éƒ¨åˆ†åŒå­¦éƒ½æ¥å—çš„èœçš„ç§ç±»æ•°xxï¼ˆè¿™é‡Œç†è§£ä¸ºä¸€ç§è¾£åº¦å¯¹åº”ä¸€ç§èœï¼‰ä¸¤è€…ä¸­çš„æœ€å°å€¼ï¼Œå³min(k,x)ã€‚(1&lt;=n,m&lt;=300000)ã€‚</p>
<p>ç°åœ¨ä½ éœ€è¦æƒ³åŠæ³•è®©Phenixçš„æ»¡æ„ç¨‹åº¦æœ€å¤§ã€‚</p>
<p><strong>è¾“å…¥æè¿°:</strong><br>ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°n,mï¼Œè¡¨ç¤ºèœçš„è¾£åº¦æœ€å¤§å€¼å’ŒåŒå­¦çš„äººæ•°(1&lt;=n,m&lt;=300000)ã€‚</p>
<p>æ¥ä¸‹æ¥mè¡Œ,æ¯è¡Œä¸¤ä¸ªæ•´æ•°$$$[l_i,r_i]$$$ä¾æ¬¡è¡¨ç¤ºç¬¬iä¸ªåŒå­¦çš„è¾£åº¦æ¥å—èŒƒå›´(1&lt;=$$$[l_i,r_i]$$$&lt;=n)</p>
<p><strong>è¾“å‡ºæè¿°:</strong><br>ä¸€è¡Œï¼Œè¡¨ç¤ºæ»¡æ„åº¦çš„æœ€å¤§å€¼ã€‚</p>
<p><strong>æ€è·¯ï¼š</strong><br>äºŒåˆ†min(k,x)<br>checkï¼šå¦‚æœæ‰€æœ‰åŒå­¦ä¸­æœ‰å¤§äºç­‰äºmidäººå…±åŒè¦†ç›–çš„åŒºé—´å¤§äºç­‰äºmidåˆ™return 1ï¼›å¦åˆ™return 0ã€‚</p>
<p><strong>ä»£ç </strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IOS ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,b) memset(a,b,sizeof a)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lcm(a,b) a/gcd(a,b)*b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(a) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Adebug(a,i) cerr&lt;&lt;#a&lt;&lt;<span class="meta-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="meta-string">&quot;]=&quot;</span>&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = (a); i &lt;= (b); i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = (a); i &gt;= (b); i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vi vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vpii vector<span class="meta-string">&lt;PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rvs(s) reverse(s.begin(),s.end())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(s) s.begin(),s.end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(s) (int)(s.size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lb(s) ((s) &amp; (-s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk(s, t) make_pair(s, t)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CN puts(<span class="meta-string">&quot;NO&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CY puts(<span class="meta-string">&quot;YES&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wt</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtl</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">wtb</span><span class="params">(string x)</span></span>&#123;cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmax</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &lt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">ckmin</span><span class="params">(T &amp;x, T y)</span></span>&#123;<span class="keyword">return</span> x &gt; y ? x = y, <span class="literal">true</span> : <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span> (k)&#123;<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (ll)res * a % p;a = (ll)a * a % p;k &gt;&gt;= <span class="number">1</span>;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">int</span> res = <span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res *= a;b&gt;&gt;=<span class="number">1</span>;a*=a;&#125;<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mo</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> x = ((x%p)+p)%p;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> fact[maxn], infact[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">jie_init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">1</span>,n) fact[i] = fact[i<span class="number">-1</span>] * i % mod;	</span><br><span class="line">	infact[n] = <span class="built_in">qmi</span>(fact[n],mod<span class="number">-2</span>,mod);</span><br><span class="line">	<span class="built_in">per</span>(i,n<span class="number">-1</span>,<span class="number">0</span>) infact[i] = infact[i+<span class="number">1</span>] * (i+<span class="number">1</span>) % mod;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;<span class="keyword">return</span> fact[n] * infact[m] % mod * infact[n-m] % mod;&#125;</span><br><span class="line"><span class="keyword">int</span> T = <span class="number">1</span>,N,M,K;</span><br><span class="line"><span class="keyword">int</span> A[maxn],B[maxn],dp[maxn],f[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	vector&lt;PII&gt; stu;</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="built_in">min</span>(N,M);</span><br><span class="line">	<span class="keyword">while</span> (M--) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r;</span><br><span class="line">		 cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">		 stu.<span class="built_in">pb</span>(<span class="built_in">mk</span>(l,r));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	function&lt;<span class="built_in"><span class="keyword">int</span></span>(<span class="keyword">int</span>)&gt; check = [&amp;](<span class="keyword">int</span> x)&#123;</span><br><span class="line">		<span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">		<span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">st</span><span class="params">(N+<span class="number">7</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stu.<span class="built_in">size</span>(); i ++) &#123;</span><br><span class="line">			<span class="keyword">int</span> len = stu[i].second - stu[i].first + <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (len &gt;= x) &#123;</span><br><span class="line">				k ++;</span><br><span class="line">				st[stu[i].fi+x<span class="number">-1</span>] ++;</span><br><span class="line">				st[stu[i].se+<span class="number">1</span>] --;</span><br><span class="line">				<span class="comment">/*</span></span><br><span class="line"><span class="comment">				ç”¨å·®åˆ†å¯¹åŒºé—´åŠ 1</span></span><br><span class="line"><span class="comment">				åŠ äº†ä¸€è¯´æ˜è¿™ä¸ªä½ç½®å¾€å‰xä¸ªéƒ½è¢«å½“å‰åŒå­¦è¦†ç›–äº†</span></span><br><span class="line"><span class="comment">				*/</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">			st[i] += st[i<span class="number">-1</span>];</span><br><span class="line">			<span class="keyword">if</span> (st[i] &gt;= x) <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//è¯´æ˜å½“å‰ä½ç½®å¾€å‰xä¸ªè¢«å¤§äºç­‰äºxä¸ªåŒå­¦è¦†ç›–</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">		<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">check</span>(mid)) ans = mid,l = mid + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span> r = mid;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IOS</span><br><span class="line">	<span class="comment">// cin &gt;&gt; T;</span></span><br><span class="line">	<span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span><span class="number">-0</span>); <span class="comment">//&lt;3</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
]]></content>
  </entry>
  <entry>
    <title>é«˜æ–¯æ¶ˆå…ƒ</title>
    <url>/2021/11/15/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/</url>
    <content><![CDATA[<h1 id="é«˜æ–¯æ¶ˆå…ƒ"><a href="#é«˜æ–¯æ¶ˆå…ƒ" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒ"></a>é«˜æ–¯æ¶ˆå…ƒ</h1><blockquote>
<p>é»˜è®¤å¤§å®¶éƒ½å­¦è¿‡çº¿ä»£äº†</p>
</blockquote>
<h3 id="ç®—æ³•æ€æƒ³ï¼š"><a href="#ç®—æ³•æ€æƒ³ï¼š" class="headerlink" title="ç®—æ³•æ€æƒ³ï¼š"></a><strong>ç®—æ³•æ€æƒ³</strong>ï¼š</h3><ol>
<li><p>å°±æ˜¯æ±‚è§£çŸ©é˜µçš„è¿‡ç¨‹ã€‚æŠŠçŸ©é˜µè½¬åŒ–æˆä¸€ä¸ªä¸Šä¸‰è§’æˆ–è€…ä¸‹ä¸‰è§’çš„å½¢å¼ï¼Œé‚£ä¹ˆåªéœ€è¦æŠŠå¯¹è§’çº¿ä¸Šçš„å…ƒç´ ç›¸ä¹˜å°±å¯ä»¥ $O(n)$ å¾—åˆ°çŸ©é˜µçš„å€¼ã€‚</p>
</li>
<li><p>å¦‚ä½•æŠŠçŸ©é˜µè½¬åŒ–æˆä¸Šä¸‰è§’æˆ–ä¸‹ä¸‰è§’å‘¢ï¼Œçº¿æ€§ä»£æ•°å‘Šè¯‰æˆ‘ä»¬æŠŠç¬¬iè¡Œçš„æ¯ä¸ªå…ƒç´ åŠ ä¸Šç¬¬jè¡Œå¯¹åº”çš„æ¯ä¸ªå…ƒç´ çš„kå€ï¼ŒåŸçŸ©é˜µå¤§å°ä¸å˜ã€‚ï¼ˆåŒç†å¯ä»¥æ¶ˆé™¤åˆ—ï¼‰</p>
</li>
<li><p>åˆ¤æ–­è§£çš„æƒ…å†µï¼š</p>
<p>a) å¦‚æœå‡ºç°æŸä¸€è¡Œï¼Œç³»æ•°çŸ©é˜µå…¨ä¸º0ï¼Œå¢å¹¿çŸ©é˜µä¸å…¨ä¸º0ï¼Œåˆ™æ— è§£ï¼ˆå³å‡ºç°[0 0 0 0 0 b]ï¼Œå…¶ä¸­bä¸ç­‰äº0çš„æƒ…å†µï¼‰ï¼ˆè½¬åŒ–ä¸ºæ–¹ç¨‹å°±æ˜¯è¯´ $0 \times x_1 + â€¦+0 \times x_n = b(b \neq 0)$ ,æ˜¾ç„¶è¿™ä¸å¯èƒ½ï¼‰ï¼›</p>
<p>b) å¦‚æœæ˜¯ä¸¥æ ¼ä¸Šä¸‰è§’ï¼Œåˆ™è¡¨æ˜æœ‰å”¯ä¸€è§£ï¼›</p>
<p>â€‹    å½¢å¦‚ä¸‹å›¾ï¼Œä»¥å¯¹è§’çº¿ä¸ºçº¿ï¼Œå·¦ä¸‹è§’å…¨ä¸º0æˆ–å³ä¸Šè§’</p>
<p>â€‹    <img src="https://tse1-mm.cn.bing.net/th/id/R-C.d85ea5d58289c8b027ec7dd7dbb8ec26?rik=CmoIe2fedyOvCQ&amp;riu=http%3a%2f%2fc.biancheng.net%2fuploads%2fallimg%2f190426%2f1KJR1D-5.gif&amp;ehk=VYbXtHCtR86m65HblKk1JWB5G5OO%2bnEn8uOO1nsW7AM%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0&amp;sres=1&amp;sresct=1" alt="ä¸Šä¸‰è§’ä¸‹ä¸‰è§’çŸ©é˜µ"></p>
</li>
</ol>
<p>   â€‹    c) å¦‚æœå¢å¹¿çŸ©é˜µæœ‰k (k &gt; 0)è¡Œå…¨ä¸º0ï¼ˆå…¨ä¸º0æŒ‡bä¹Ÿç­‰äº0ï¼‰ï¼Œé‚£ä¹ˆè¡¨æ˜æœ‰kä¸ªå˜é‡å¯ä»¥ä»»    æ„å–å€¼ï¼Œè¿™å‡ ä¸ªå˜é‡å³è‡ªç”±å˜é‡ï¼›å¯¹äºè¿™ç§æƒ…å†µï¼Œä¸€èˆ¬è§£çš„èŒƒå›´æ˜¯ç»™å®šçš„ï¼Œä»¤è§£çš„å–å€¼    æœ‰Tä¸ªï¼Œè‡ªç”±å˜é‡æœ‰Vä¸ªï¼Œé‚£ä¹ˆè§£çš„ä¸ªæ•°å°±æ˜¯ TVã€‚</p>
<h3 id="ACWINGçš„åŸºç¡€æ¨¡æ¿é¢˜ï¼ˆé˜²æ­¢æ²¡ä¹°åŸºç¡€è¯¾çš„çœ‹ä¸äº†ï¼Œé¢˜ç›®ä¹ŸåŠ ä¸Šäº†ï¼‰"><a href="#ACWINGçš„åŸºç¡€æ¨¡æ¿é¢˜ï¼ˆé˜²æ­¢æ²¡ä¹°åŸºç¡€è¯¾çš„çœ‹ä¸äº†ï¼Œé¢˜ç›®ä¹ŸåŠ ä¸Šäº†ï¼‰" class="headerlink" title="ACWINGçš„åŸºç¡€æ¨¡æ¿é¢˜ï¼ˆé˜²æ­¢æ²¡ä¹°åŸºç¡€è¯¾çš„çœ‹ä¸äº†ï¼Œé¢˜ç›®ä¹ŸåŠ ä¸Šäº†ï¼‰"></a><strong>ACWINGçš„åŸºç¡€æ¨¡æ¿é¢˜ï¼ˆé˜²æ­¢æ²¡ä¹°åŸºç¡€è¯¾çš„çœ‹ä¸äº†ï¼Œé¢˜ç›®ä¹ŸåŠ ä¸Šäº†ï¼‰</strong></h3><ul>
<li><p><a href="https://www.acwing.com/problem/content/885/">883. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„ - AcWingé¢˜åº“</a></p>
<ul>
<li><p>é¢˜ç›®ï¼š</p>
<p><img src="https://s6.jpg.cm/2021/11/15/Iit3LE.png" alt="Iit3LE.png"></p>
</li>
<li><p>ä»£ç +æ¿å­</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">double</span> a[N][N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c, r;</span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">0</span>, r = <span class="number">0</span>; c &lt; n; c ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> t = r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c]) &gt; <span class="built_in">fabs</span>(a[t][c]))</span><br><span class="line">                t = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[t][c]) &lt; eps) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = c; i &lt; n + <span class="number">1</span>; i ++ ) <span class="built_in">swap</span>(a[t][i], a[r][i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= c; i -- ) a[r][i] /= a[r][c];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = r + <span class="number">1</span>; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c]) &gt; eps)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &gt;= c; j -- )</span><br><span class="line">                    a[i][j] -= a[r][j] * a[i][c];</span><br><span class="line"></span><br><span class="line">        r ++ ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (r &lt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][n]) &gt; eps)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- )</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; j ++ )</span><br><span class="line">            a[i][n] -= a[j][n] * a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n + <span class="number">1</span>; j ++ )</span><br><span class="line">            cin &gt;&gt; a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> t = <span class="built_in">gauss</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ ) <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, a[i][n]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Infinite group solutions&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><a href="https://www.acwing.com/problem/content/886/">884. é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„ - AcWingé¢˜åº“</a></p>
<ul>
<li><p>é¢˜ç›®ï¼š<img src="https://s6.jpg.cm/2021/11/15/IitCbQ.png" alt="IitCbQ.png"></p>
</li>
<li><p>æ¿å­+ä»£ç </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">  <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">int</span> n;</span><br><span class="line">  <span class="keyword">int</span> a[N][N];</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> c, r;</span><br><span class="line">      <span class="keyword">for</span> (c = <span class="number">0</span>, r = <span class="number">0</span>; c &lt; n; c ++ )</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">int</span> t = r;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt; n; i ++ )</span><br><span class="line">              <span class="keyword">if</span> (a[i][c])</span><br><span class="line">                  t = i;</span><br><span class="line">  </span><br><span class="line">          <span class="keyword">if</span> (!a[t][c]) <span class="keyword">continue</span>;</span><br><span class="line">  </span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = c; i &lt;= n; i ++ ) <span class="built_in">swap</span>(a[r][i], a[t][i]);</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = r + <span class="number">1</span>; i &lt; n; i ++ )</span><br><span class="line">              <span class="keyword">if</span> (a[i][c])</span><br><span class="line">                  <span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &gt;= c; j -- )</span><br><span class="line">                      a[i][j] ^= a[r][j];</span><br><span class="line">  </span><br><span class="line">          r ++ ;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">if</span> (r &lt; n)</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt; n; i ++ )</span><br><span class="line">              <span class="keyword">if</span> (a[i][n])</span><br><span class="line">                  <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- )</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; j ++ )</span><br><span class="line">              a[i][n] ^= a[i][j] * a[j][n];</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      cin &gt;&gt; n;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n + <span class="number">1</span>; j ++ )</span><br><span class="line">              cin &gt;&gt; a[i][j];</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">int</span> t = <span class="built_in">gauss</span>();</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">if</span> (t == <span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ ) cout &lt;&lt; a[i][n] &lt;&lt; endl;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Multiple sets of solutions&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>);</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="é¢˜å‹åˆ†ç±»"><a href="#é¢˜å‹åˆ†ç±»" class="headerlink" title="é¢˜å‹åˆ†ç±»"></a>é¢˜å‹åˆ†ç±»</h3><ul>
<li><p>æµ®ç‚¹æ•°æ¶ˆå…ƒ</p>
<p>ç³»æ•°çŸ©é˜µä¸ºæ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼Œæ¶ˆå…ƒçš„æ—¶å€™ä¹˜ä¸Šçš„ç³»æ•°ä¸ºæµ®ç‚¹æ•°ï¼Œä¸€èˆ¬ç”¨äºæ±‚è§£æµ®ç‚¹æ•°è§£</p>
</li>
<li><p>æ•´æ•°æ¶ˆå…ƒ</p>
<p>ç³»æ•°çŸ©é˜µå…¨ä¸ºæ•´æ•°ï¼Œæ¶ˆå…ƒçš„æ—¶å€™ä¹˜ä¸Šçš„ç³»æ•°å‡ä¸ºæ•´æ•°ï¼Œæ•´ä¸ªæ¶ˆå…ƒè¿‡ç¨‹ä¸å‡ºç°æµ®ç‚¹æ•°ã€‚ç”±äºä¹˜æ³•å¾ˆå®¹æ˜“æº¢å‡ºï¼Œä¸€èˆ¬å¾ˆå°‘ç”¨ã€‚ï¼ˆçœŸè¿«ä¸å¾—å·²å°±ä¸ŠJavaï¼ŒPythonï¼‰</p>
</li>
<li><p>æ¨¡çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆå¾ˆæœ‰ç”¨ï¼‰</p>
<p>ç³»æ•°çŸ©é˜µå…¨ä¸ºæ•´æ•°ï¼Œæ¶ˆå…ƒçš„æ—¶å€™ä¹˜ä¸Šçš„ç³»æ•°å‡ä¸ºæ•´æ•°ï¼Œæ¯æ¬¡è¿ç®—éƒ½æ¨¡ä¸Šä¸€ä¸ªæ•°Pï¼Œæ•´ä¸ªæ¶ˆå…ƒè¿‡ç¨‹ä¸å‡ºç°é™¤æ³•ã€‚ï¼ˆ<strong>å› ä¸ºé«˜æ–¯æ¶ˆå…ƒçš„è¿‡ç¨‹å’Œæœ€åçš„è®¡ç®—éƒ½æ˜¯åªæœ‰+-Ã—ï¼Œå¯¹å–æ¨¡åçš„ç»“æœéƒ½æ²¡å½±å“ï¼Œè¿™æ ·ç®—å‡ºæ¥çš„ç»“æœå’ŒåŸæ¥ç­”æ¡ˆå–æ¨¡åæ˜¯ä¸€æ ·çš„</strong>ï¼‰</p>
<ul>
<li>æœ‰çš„æ˜¯ç»™å®šè§£çš„èŒƒå›´æ±‚è§£çš„æ•°é‡ï¼Œä¾‹å¦‚ï¼šPKU 1830ã€HDU 3364</li>
<li>æœ‰çš„æ˜¯æ±‚ä¸€ä¸ªè§£ï¼Œä¾‹å¦‚PKU 2065ã€HDU 3571</li>
<li>æœ‰çš„æ˜¯æ±‚è§£çš„å­˜åœ¨æ€§ï¼Œä¾‹å¦‚PKU1288ã€PKU 3185ã€‚</li>
<li>æœ‰çš„æ˜¯å·²çŸ¥è§£å¾—ç»å¯¹å€¼æ±‚æ­£è´Ÿï¼Œä¾‹å¦‚2021icpcæµå—J</li>
</ul>
</li>
</ul>
]]></content>
  </entry>
</search>
